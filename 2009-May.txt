From vafa at mail.berlios.de  Sat May 30 05:20:36 2009
From: vafa at mail.berlios.de (vafa at mail.berlios.de)
Date: Sat, 30 May 2009 05:20:36 +0200
Subject: [Xepersian-development] r33 - /
Message-ID: <200905300320.n4U3KaFP018977@sheep.berlios.de>

Author: vafa
Date: 2009-05-30 05:20:31 +0200 (Sat, 30 May 2009)
New Revision: 33

Removed:
   branches/
   tags/
   trunk/
Log:
delete old fashion files



From vafa at mail.berlios.de  Sat May 30 05:37:09 2009
From: vafa at mail.berlios.de (vafa at mail.berlios.de)
Date: Sat, 30 May 2009 05:37:09 +0200
Subject: [Xepersian-development] r34 - / trunk trunk/img trunk/img/weather
Message-ID: <200905300337.n4U3b96P019772@sheep.berlios.de>

Author: vafa
Date: 2009-05-30 05:36:52 +0200 (Sat, 30 May 2009)
New Revision: 34

Added:
   trunk/
   trunk/img/
   trunk/img/ireland.jpg
   trunk/img/weather/
   trunk/img/weather/clouds.jpg
   trunk/img/weather/rain.jpg
   trunk/img/weather/sun.jpg
   trunk/logo.pdf
   trunk/parsidigits.tec
   trunk/persian.xdy
   trunk/txt2maths.tec
   trunk/xepersian.dtx
Log:
recommit xepersian package: xepersian is all rewritten again from scratch based on the new version of bidi package fount at http://developer.berlios.de/projects/bidi/. Note that roman (uppercase and lowercase) is changed to latin (for lowercase) and Latin (for uppercase) and \Footnote is changed to \LTRfootnote because of the clash the bad naming caused with the manyfoot package. The user is expected to get the new version of the bidi package in order to be able to run his documents with the new version of the xepersian package. I do not provide all files like before, all you have to do is to run xelatex on bidi.dtx and xepersian.dtx and then move the files to their appropriate places

Added: trunk/img/ireland.jpg
===================================================================
(Binary files differ)


Property changes on: trunk/img/ireland.jpg
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:mime-type
   + application/octet-stream

Added: trunk/img/weather/clouds.jpg
===================================================================
(Binary files differ)


Property changes on: trunk/img/weather/clouds.jpg
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:mime-type
   + application/octet-stream

Added: trunk/img/weather/rain.jpg
===================================================================
(Binary files differ)


Property changes on: trunk/img/weather/rain.jpg
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:mime-type
   + application/octet-stream

Added: trunk/img/weather/sun.jpg
===================================================================
(Binary files differ)


Property changes on: trunk/img/weather/sun.jpg
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:mime-type
   + application/octet-stream

Added: trunk/logo.pdf
===================================================================
(Binary files differ)


Property changes on: trunk/logo.pdf
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:mime-type
   + application/octet-stream

Added: trunk/parsidigits.tec
===================================================================
(Binary files differ)


Property changes on: trunk/parsidigits.tec
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:mime-type
   + application/octet-stream

Added: trunk/persian.xdy
===================================================================
--- trunk/persian.xdy	2009-05-30 03:20:31 UTC (rev 33)
+++ trunk/persian.xdy	2009-05-30 03:36:52 UTC (rev 34)
@@ -0,0 +1,118 @@
+;; $Id: makeidx.xdy,v 1.1 1997/02/07 14:17:31 kehr Exp $
+;;
+;; This file implements the Output Style Specifiers for plain
+;; makeindex (see manpage of makeindex 2.x) in conjuction with
+;; TeX/LaTeX.
+;;
+;; The Input Style Specifiers of makeindex cannot de defined in a
+;; `xindy' style file. Use an appropriate version of the program
+;; `tex2xindy' which should be included with this distribution.
+;;
+;; Since `xindy' uses a different specification language than
+;; makeindex and some of the command-line options of makeindex are now
+;; only available as style-file commands, this file can only serve as
+;; a template that produces the default-markup of makeindex. However,
+;; it may be used as a starting point for further modification and
+;; specialization.
+;;
+;; The following values are taken from the source of the makeindex
+;; distribution (see file scanst.h and the manpage) for further
+;; details.
+;;
+
+;; Define all attributes appearing in your document. Your attributes
+;; are all encapsulators you use in your \index commands following the
+;; vertical bar sign `|'. For example `foo' is the attribute in the
+;; command \index{...|foo}. Here you specify the set of attributes
+;; that appear in your document, the order in which they appear in the
+;; index and which one superdes the other.
+;;
+;; Example: a) (define-attibutes (("default") ("bf") ("it")))
+;;          b) (define-attibutes (("bf" "default")))
+;;
+;; The initial command is (change it accordingly):
+
+(define-attributes ("default"))
+
+;; The description of the location-classes.
+;; Add more location classes as needed.
+
+(define-location-class "arabic-page-numbers" ("arabic-numbers"))
+(define-location-class "roman-page-numbers"  ("roman-numbers-lowercase"))
+(define-location-class "Roman-page-numbers"  ("roman-numbers-uppercase"))
+(define-location-class "alpha-page-numbers"  ("alpha"))
+(define-location-class "Alpha-page-numbers"  ("ALPHA"))
+
+;; The most frequently used cross reference class "see". Add more, if
+;; necessary.
+
+(define-crossref-class "see")
+(markup-crossref-list :open "\see{" :close "}{}" :class "see")
+
+;; In makeindex: page_precedence <string>  "rnaRA"
+;; List all location classes appearing in your document.
+
+(define-location-class-order ("roman-page-numbers"
+			      "arabic-page-numbers"
+			      "alpha-page-numbers"
+			      "Roman-page-numbers"
+			      "Alpha-page-numbers"
+			      "see"))
+
+
+;; preamble <string>        "\\begin{theindex}\n"
+;; postamble <string>       "\n\n\\end{theindex}\n"
+
+(markup-index :open  "\begin{theindex}~n"
+	      :close "~n~n\end{theindex}~n"
+	      :tree)
+
+;; These specifiers are not directly supported via a command-line
+;; switch as in makeindex. Add the appropriate markup-commands into
+;; the preamble.
+
+;; setpage_prefix <string>  "~n  \setcounter{page}{"
+;; setpage_suffix <string>  "}~n"
+
+;; group_skip <string>      "~n~n  \indexspace~n"
+
+(markup-letter-group-list :sep "~n~n  \indexspace~n")
+
+;; The indexentries (item_<..> specifiers)
+
+(markup-indexentry :open "~n  \item "           :depth 0)
+(markup-indexentry :open "~n    \subitem "      :depth 1)
+(markup-indexentry :open "~n      \subsubitem " :depth 2)
+
+;; Location-references
+
+;; delim_0 <string>         ", "
+;; delim_1 <string>         ", "
+;; delim_2 <string>         ", "
+
+(markup-locclass-list :open ", " :sep ", ")
+
+;; delim_n <string>         ", "
+
+(markup-locref-list   :sep ", ")
+
+;; delim_r <string>         "--"
+
+(markup-range :sep "--")
+
+;; Here follow all letter-groups. The short-cut notation is used here.
+
+(define-letter-groups
+    ("??" "??" "??" "??" "??" "??" "??" "??" "??" "??" "??" "??" "??" "??"
+     "??" "??" "??" "??" "??" "??" "??" "??" "??" "??" "??" "??" "??" "??" "??" "??" "??" "??" "??"))
+
+;;
+;; The sort-rules map all letters to their lowercase counterpart.
+;;
+
+
+;; End
+
+;; Local Variables:
+;; mode: lisp
+;; End:


Property changes on: trunk/persian.xdy
___________________________________________________________________
Name: svn:executable
   + *

Added: trunk/txt2maths.tec
===================================================================
(Binary files differ)


Property changes on: trunk/txt2maths.tec
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/xepersian.dtx
===================================================================
--- trunk/xepersian.dtx	2009-05-30 03:20:31 UTC (rev 33)
+++ trunk/xepersian.dtx	2009-05-30 03:36:52 UTC (rev 34)
@@ -0,0 +1,9223 @@
+% \iffalse 
+%<*internal>
+\iffalse
+%</internal>
+%<*readme>
+_________________
+The XePersian package
+v1.0.1
+
+XePersian is a package written for XeLaTeX that allows users to typeset
+Persian easily. The current version is 1.0.1 and it will be developed to
+ meet the needs of Persian typesetting properly.
+
+The XePersian package is independent of any operating system, meaning it 
+will work on all operating systems.
+
+There are some  excellent fonts made by IRMUG (Iranian Mac User Group) which you can download
+from http://wiki.irmug.org/index.php/X_Series_2#Download_fonts and
+http://wiki.irmug.org/index.php/XWZar
+
+
+This version fixes all known bugs and adds heaps of new things.
+
+______________
+Vafa Khalighi
+vafa at users.berlios.de
+
+Copyright 2008-2009
+Distributed under the LaTeX Project Public License
+%</readme>
+%<*internal>
+\fi
+%
+%</internal>
+%
+%<*internal>
+\begingroup
+%</internal>
+%<*batchfile>
+\input docstrip.tex
+\keepsilent
+\preamble
+
+  __________________________________
+  Copyright ?? 2008-2009 Vafa Khalighi
+
+  License information appended.
+
+
+\endpreamble
+\postamble
+
+Copyright ?? 2008-2009      by Vafa Khalighi     <vafa at users.berlios.de>
+
+Distributable under the LaTeX Project Public License,
+version 1.3c or higher (your choice). The latest version of
+this license is at: http://www.latex-project.org/lppl.txt
+
+This work is "maintained" (as per LPPL maintenance status) 
+by Vafa Khalighi.
+
+
+                             
+
+\endpostamble
+\askforoverwritefalse
+\generate{\file{xepersian.sty}{\from{xepersian.dtx}{xepersian.sty}}}
+\generate{\file{algorithmic-xepersian.def}{\from{xepersian.dtx}{algorithmic-xepersian.def}}}
+\generate{\file{algorithm-xepersian.def}{\from{xepersian.dtx}{algorithm-xepersian.def}}}
+\generate{\file{amsart-xepersian.def}{\from{xepersian.dtx}{amsart-xepersian.def}}}
+\generate{\file{amsbook-xepersian.def}{\from{xepersian.dtx}{amsbook-xepersian.def}}}
+\generate{\file{article-xepersian.def}{\from{xepersian.dtx}{article-xepersian.def}}}
+\generate{\file{beamer-xepersian.def}{\from{xepersian.dtx}{beamer-xepersian.def}}}
+\generate{\file{bookest-xepersian.def}{\from{xepersian.dtx}{bookest-xepersian.def}}}
+\generate{\file{book-xepersian.def}{\from{xepersian.dtx}{book-xepersian.def}}}
+\generate{\file{localise-xepersian.def}{\from{xepersian.dtx}{localise-xepersian.def}}}
+\generate{\file{commands-ltx.def}{\from{xepersian.dtx}{commands-ltx.def}}}
+\generate{\file{commands-xepersian.def}{\from{xepersian.dtx}{commands-xepersian.def}}}
+\generate{\file{enumerate-xepersian.def}{\from{xepersian.dtx}{enumerate-xepersian.def}}}
+\generate{\file{environments-ltx.def}{\from{xepersian.dtx}{environments-ltx.def}}}
+\generate{\file{environments-xepersian.def}{\from{xepersian.dtx}{environments-xepersian.def}}}
+\generate{\file{extbook-xepersian.def}{\from{xepersian.dtx}{extbook-xepersian.def}}}
+\generate{\file{kashida-xepersian.def}{\from{xepersian.dtx}{kashida-xepersian.def}}}
+\generate{\file{listings-xepersian.def}{\from{xepersian.dtx}{listings-xepersian.def}}}
+\generate{\file{misccommandsenvironments-ltx.def}{\from{xepersian.dtx}{misccommandsenvironments-ltx.def}}}
+\generate{\file{refrep-xepersian.def}{\from{xepersian.dtx}{refrep-xepersian.def}}}
+\generate{\file{report-xepersian.def}{\from{xepersian.dtx}{report-xepersian.def}}}
+\generate{\file{xepersian-magazine.cls}{\from{xepersian.dtx}{xepersian-magazine.cls}}}
+\generate{\file{xepersian-mathsdigitspec.sty}{\from{xepersian.dtx}{xepersian-mathsdigitspec.sty}}}
+\generate{\file{xepersian-multiplechoice.sty}{\from{xepersian.dtx}{xepersian-multiplechoice.sty}}}
+\generate{\file{xepersian-persiancal.sty}{\from{xepersian.dtx}{xepersian-persiancal.sty}}}
+\generate{\file{xepersian-thesis.cls}{\from{xepersian.dtx}{xepersian-thesis.cls}}}
+\generate{\file{xepersian-thesis-xepersian.def}{\from{xepersian.dtx}{xepersian-thesis-xepersian.def}}}
+\generate{\file{acm-fa.bst}{\from{xepersian.dtx}{acm-fa.bst}}}
+\generate{\file{ieeetr-fa.bst}{\from{xepersian.dtx}{ieeetr-fa.bst}}}
+\generate{\file{plain-fa.bst}{\from{xepersian.dtx}{plain-fa.bst}}}
+\generate{\file{unsrt-fa.bst}{\from{xepersian.dtx}{unsrt-fa.bst}}}
+%</batchfile>
+%<batchfile>\endbatchfile
+%<*internal>
+\generate{\file{xepersian.ins}{\from{xepersian.dtx}{batchfile}}}
+\nopreamble\nopostamble
+\generate{\file{README.txt}{\from{xepersian.dtx}{readme}}}
+\generate{\file{parsidigits.map}{\from{xepersian.dtx}{parsidigits.map}}}
+\generate{\file{txt2maths.map}{\from{xepersian.dtx}{txt2maths.map}}}
+\generate{\file{ftxe-0.1.py}{\from{xepersian.dtx}{ftxe-0.1.py}}}
+\generate{\file{thesis-sample.tex}{\from{xepersian.dtx}{thesis-sample.tex}}}
+\generate{\file{magazine-sample.tex}{\from{xepersian.dtx}{magazine-sample.tex}}}
+\generate{\file{test-correction.tex}{\from{xepersian.dtx}{test-correction.tex}}}
+\generate{\file{test-empty-form.tex}{\from{xepersian.dtx}{test-empty-form.tex}}}
+\generate{\file{test-question-only.tex}{\from{xepersian.dtx}{test-question-only.tex}}}
+\generate{\file{test-solution-form.tex}{\from{xepersian.dtx}{test-solution-form.tex}}}
+\generate{\file{acm-fa-output.tex}{\from{xepersian.dtx}{acm-fa-output.tex}}}
+\generate{\file{bibtex-example.tex}{\from{xepersian.dtx}{bibtex-example.tex}}}
+\generate{\file{ieeetr-fa-output.tex}{\from{xepersian.dtx}{ieeetr-fa-output.tex}}}
+\generate{\file{MyReferences.bib}{\from{xepersian.dtx}{MyReferences.bib}}}
+\generate{\file{plain-fa-output.tex}{\from{xepersian.dtx}{plain-fa-output.tex}}}
+\endgroup
+%</internal>
+%
+%<*driver>
+\documentclass{ltxdoc}
+\usepackage[dvipdfm,
+    bookmarks=true,
+    colorlinks=true,
+    linkcolor=myblue,
+    urlcolor=myblue,
+    citecolor=myblue,
+    hyperindex=false,
+    hyperfootnotes=false,
+    pdftitle={The bidi package},
+    pdfauthor={Vafa Khalighi <vafa at users.berlios.de>},
+    pdfsubject={An interface for typesetting bidirectional texts with XeLaTeX},
+    pdfkeywords={XeTeX, XeLaTeX, Right-to-Left, Bidi, Persian, Hebrew, Arabic}
+    ]{hyperref}
+\usepackage{multicol}
+\usepackage{xltxtra}
+\usepackage{fancyvrb}
+\usepackage{xcolor}
+\definecolor{myred}{rgb}{0.65,0.04,0.07}
+\fvset{formatcom=\color{myred}}
+\DefineShortVerb{\|}
+\def\theCodelineNo{\textcolor{myred}{\sffamily\tiny\arabic{CodelineNo}}}
+\usepackage{fontspec}
+\setmainfont[Mapping=tex-text]{Brioso Pro}
+\setmonofont[Scale=0.8]{Arial}
+\setsansfont[Scale=0.8]{DejaVu Sans}
+\makeatletter
+\setlength\columnseprule{0.8pt}
+\renewcommand\tableofcontents{\relax
+  \begin{multicols}{2}[\section*{\contentsname}]\small
+    \@starttoc{toc}\relax
+  \end{multicols}}
+\makeatother
+\EnableCrossrefs
+\CodelineIndex
+\RecordChanges
+\OnlyDescription
+
+\begin{document}
+  \DocInput{xepersian.dtx}
+\end{document}
+%</driver>
+%
+%
+% \fi
+%
+% \GetFileInfo{bidi.sty}
+% \makeatletter
+%
+%\title{The \textsf{XePersian} Package}
+%\author{Vafa Khalighi\\
+%\footnotesize\texttt{<vafa at users.berlios.de>}}
+%
+% \maketitle
+% \StopEventually{}
+% \section{Implementation}
+% \part{xepersian.sty}
+%\iffalse
+%<*xepersian.sty>
+% \fi
+%
+%
+%    \begin{macrocode}
+\NeedsTeXFormat{LaTeX2e}
+\def\xepersianversion{v1.0.1}
+\def\xepersianrevision{revision 33}
+\def\xepersiandate{2009/06/01}
+\ProvidesPackage{xepersian}[\xepersiandate\space \xepersianversion\space <\xepersianrevision>
+	Persian typesetting in XeLaTeX]
+\AtBeginDocument{\special{pdf: docinfo <<
+	/Creator (X???Persian v\xepersianversion\space <\xepersianrevision> Copyright ?? 2008-2009 Vafa Khalighi)
+         >>}}
+\RequirePackage[RTLdocument]{bidi}
+\RequirePackage{fontspec}
+\RequirePackage{xepersian-persiancal}
+\RequirePackage{xepersian-mathsdigitspec}
+\gdef\@latex at error#1#2{%
+   \GenericError{%
+      \space\space\space\@spaces\@spaces\@spaces
+   }{%
+      XePersian Error: #1%
+   }{%
+      Please first produce a similar file without using XePersian package and then compile it with xelatex, if you got the same error, then please study the Persian translation of 'The not so Short Introduction to LaTeX' by MEHDI OMIDALI, otherwise please report the error with a minimal tex file which shows the error to  the Author of XePersian.%
+   }{#2}%
+}
+\gdef\@latexbug{%
+  \@latex at error{This may be a XePersian bug}{Please inform the Author of XePersian}}
+\DeclareOption{Kashida}{\input{kashida-xepersian.def}}
+\newfontscript{Persian}{arab}
+\newfontlanguage{Persian}{ARA}
+\newcommand*\settextfont[2][]{%
+\newfontfamily\persianfont[Script=Persian,Mapping=parsidigits,#1]{#2}
+\let\rmdefault\zf at family
+  \normalfont
+}
+\newcommand*\settxtmathfont[2][]{%
+\newfontfamily\TXTmath[Mapping=txt2maths,#1]{#2}
+}
+\newcommand*\setlatintextfont[2][]{%
+\newfontfamily\latinfont[Mapping=tex-text,#1]{#2}
+}
+\newcommand*\defpersianfont[1]{%
+  \@ifnextchar[{\defpersianfont at i#1}{\defpersianfont at i#1[]}}
+\def\defpersianfont at i#1[#2]#3{%
+  \zf at fontspec{Script=Persian,Mapping=parsidigits,#2}{#3}%
+  \edef\@tempa{%
+    \noexpand\DeclareRobustCommand\noexpand#1
+      {\noexpand\fontfamily{\zf at family}\noexpand\selectfont}}%
+  \@tempa}
+\newcommand*\deflatinfont[1]{%
+  \@ifnextchar[{\deflatinfont at i#1}{\deflatinfont at i#1[]}}
+\def\deflatinfont at i#1[#2]#3{%
+  \zf at fontspec{Mapping=tex-text,#2}{#3}%
+  \edef\@tempa{%
+    \noexpand\DeclareRobustCommand\noexpand#1
+      {\noexpand\fontfamily{\zf at family}\noexpand\selectfont}}%
+  \@tempa}
+\def\lr#1{\begingroup\beginL\latinfont#1\endL\endgroup}
+\def\rl#1{\begingroup\beginR\persianfont#1\endR\endgroup}
+\def\latin{\bgroup\par\@RTLfalse\latinfont}
+\def\endlatin{\par\egroup}
+\def\persian{\bgroup\par\@RTLtrue\persianfont}
+\def\endpersian{\par\egroup}
+\def\Latin{\if at RTL\par\@RTLfalse\latinfont\fi}
+\def\Persian{\if at RTL\relax\else\par\@RTLtrue\persianfont\fi}
+\let\originaltoday=\today
+\def\today{\lr{\originaltoday}}
+\let\latintoday\today
+\def\today{\rl{\persiantoday}}
+\newcommand\twocolumnstableofcontents{%
+  \begin{multicols}{2}[\section*{\contentsname}]%
+    \small
+    \@starttoc{toc}%
+  \end{multicols}}
+\def\reflect#1{{\setbox0=\hbox{#1}\rlap{\kern0.5\wd0
+  \special{x:gsave}\special{x:scale -1 1}}\box0 \special{x:grestore}}}
+\def\XePersian{\leavevmode$\smash{\hbox{X\lower.5ex
+  \hbox{\kern-.125em\reflect{E}}Persian}}$}
+\def\figurename{??????}
+\def\tablename{????????}
+\def\contentsname{?????????? ??????????}
+\def\listfigurename{???????? ????????????}
+\def\listtablename{???????? ??????????}
+\def\appendixname{??????????}
+\def\indexname{??????????}
+\def\refname{??????????}
+\def\abstractname{??????????}
+\def\partname{??????}
+\def\datename{??????????:}
+\def\bibname{???????????????????}
+\def\chaptername{??????}
+\def\ccname{????????????}
+\def\enclname{??????????}
+\def\pagename{????????}
+\def\headtoname{????}
+\def\proofname{??????????}
+\def\@harfi#1{\ifcase#1\or ??????\char"200D\or ??\or ??\or ??\or ??\or
+??\or ??\or ??\or ??\or ??\or ??\or ??\or ??\or ??\or ??\or ??\or ??\or ??\or ??\or
+??\or ??\or ??\or ??\or ??\or ??\or ??\or ??\or ??\or ??\else\@ctrerr\fi}
+\def\harfi#1{\expandafter\@harfi\csname c@#1\endcsname}
+\def\@adadi#1{\ifcase#1 \or ????\or ????\or ????\or ????????\or ??????\or ????\or ??????\or ??????\or ????\or ????\or ??????????\or ????????????\or ??????????\or ????????????\or ????????????\or ????????????\or ????????\or ????????\or ??????????\or ????????\else\@ctrerr\fi}
+\def\adadi#1{\expandafter\@adadi\csname c@#1\endcsname}
+\def\@tartibi#1{\ifcase#1 \or ?????? \or ?????? \or ?????? \or ?????????? \or ???????? \or ?????? \or ???????? \or ???????? \or ?????? \or ?????? \or ???????????? \or ?????????????? \or ???????????? \or ?????????????? \or ?????????????? \or ?????????????? \or ?????????? \or ?????????? \or ???????????? \or ??????????\else\@ctrerr\fi}
+\def\tartibi#1{\expandafter\@tartibi\csname c@#1\endcsname}
+\providecommand*{\xpg at warning}[1]{%
+   \PackageWarning{XePersian}%
+   {#1}}      
+\ifcsdef{abjad}{}{%
+\def\abjad#1{%
+\ifnum#1>1999 \xpg at warning{Illegal value (#1) for abjad numeral} {#1}
+\else
+  \ifnum#1<\z@\space\xpg at warning{Illegal value (#1) for abjad numeral}%
+  \else
+    \ifnum#1<10\expandafter\abj at num@i\number#1%
+    \else
+      \ifnum#1<100\expandafter\abj at num@ii\number#1%
+      \else
+        \ifnum#1<\@m\expandafter\abj at num@iii\number#1%
+        \else
+          \ifnum#1<\@M\expandafter\abj at num@iv\number#1%since #1<2000, we must have 1000
+          \fi
+        \fi
+      \fi
+    \fi
+  \fi
+\fi
+}
+\def\abjad at zero{}
+\def\abj at num@i#1{%
+  \ifcase#1\or ??????\or ??\or ??\or ??%
+           \or ??\char"200D\or ??\or ??\or ??\or ??\fi
+  \ifnum#1=\z@\abjad at zero\fi}
+\def\abj at num@ii#1{%
+  \ifcase#1\or ??\or ??\or ??\or ??\or ??%
+           \or ??\or ??\or ??\or ??\fi
+  \ifnum#1=\z@\fi\abj at num@i}
+\def\abj at num@iii#1{%
+  \ifcase#1\or ??\or ??\or ??\or ??\or ??%
+            \or ??\or ??\or ??\or ??\fi
+  \ifnum#1=\z@\fi\abj at num@ii}
+\def\abj at num@iv#1{%
+  \ifcase#1\or ??\fi
+  \ifnum#1=\z@\fi\abj at num@iii}
+}
+\let\@latinalph\@alph%
+   \let\@latinAlph\@Alph%
+   \let\@alph\abjad%
+   \let\@Alph\abjad%
+\@ifpackageloaded{listings}{\input{listings-xepersian.def}}{}
+\@ifpackageloaded{algorithmic}{\input{algorithmic-xepersian.def}}{}
+\@ifpackageloaded{algorithm}{\input{algorithm-xepersian.def}}{}
+\@ifpackageloaded{enumerate}{\input{enumerate-xepersian.def}}{}
+\@ifclassloaded{article}{\input{article-xepersian.def}}{}
+\@ifclassloaded{amsart}{\input{amsart-xepersian.def}}{}
+\@ifclassloaded{report}{\input{report-xepersian.def}}{}
+\@ifclassloaded{xepersian-thesis}{\input{xepersian-thesis-xepersian.def}}{}
+\@ifclassloaded{amsbook}{\input{amsbook-xepersian.def}}{}
+\@ifclassloaded{bookest}{\input{bookest-xepersian.def}}{}
+\@ifclassloaded{extbook}{\input{extbook-xepersian.def}}{}
+\@ifclassloaded{book}{\input{book-xepersian.def}}{}
+\@ifclassloaded{refrep}{\input{refrep-xepersian.def}}{}
+\@ifclassloaded{beamer}{\input{beamer-xepersian.def}}{}
+\DeclareOption{localise}{\input{localise-xepersian.def}}
+\ProcessOptions
+%    \end{macrocode}
+% \iffalse
+%</xepersian.sty>
+%<*algorithmic-xepersian.def>
+% \fi
+% \part{algorithmic-xepersian.def}
+%    \begin{macrocode}
+\if at RTL%
+\def\algorithmicrequire{\textbf{??????????:}}
+\def\algorithmicensure{\textbf{??????????:}}
+\fi
+%    \end{macrocode}
+% \iffalse
+%</algorithmic-xepersian.def>
+%<*algorithm-xepersian.def>
+% \fi
+% \part{algorithm-xepersian.def}
+%    \begin{macrocode}
+\if at RTL%
+\def\ALG at name{????????????????}
+\def\ALGS at name{???????????????????????}
+\def\listalgorithmname{???????? \ALGS at name}
+\fi
+%    \end{macrocode}
+% \iffalse
+%</algorithm-xepersian.def>
+%<*amsart-xepersian.def>
+% \fi
+% \part{amsart-xepersian.def}
+%    \begin{macrocode}
+\renewcommand \thepart {\@tartibi\c at part}
+\renewcommand\appendix{\par
+  \setcounter{section}{0}%
+  \setcounter{subsection}{0}%
+  \gdef\thesection{\@harfi\c at section}}
+%    \end{macrocode}
+% \iffalse
+%</amsart-xepersian.def>
+%<*amsbook-xepersian.def>
+% \fi
+% \part{amsbook-xepersian.def}
+%    \begin{macrocode}
+\def\frontmatter{\cleardoublepage\pagenumbering{harfi}}
+\renewcommand \thepart {\@tartibi\c at part}
+%to make appendix numbering persian
+\renewcommand\appendix{\par
+  \setcounter{chapter}{0}%
+  \setcounter{section}{0}%
+  \gdef\@chapapp{\appendixname}%
+  \gdef\thechapter{\@harfi\c at chapter}
+}%end appendix
+%    \end{macrocode}
+% \iffalse
+%</amsbook-xepersian.def>
+%<*article-xepersian.def>
+% \fi
+% \part{article-xepersian-def}
+%    \begin{macrocode}
+\renewcommand \thepart {\@tartibi\c at part}
+\renewcommand\appendix{\par
+  \setcounter{section}{0}%
+  \setcounter{subsection}{0}%
+  \gdef\thesection{\@harfi\c at section}}
+%    \end{macrocode}
+% \iffalse
+%</article-xepersian.def>
+%<*beamer-xepersian.def>
+% \fi
+% \part{beamer-xepersian.def}
+%    \begin{macrocode}
+\def\familydefault{\rmdefault}
+\def\latin{\bgroup\par\raggedright\@RTLfalse\latinfont}
+\def\endlatin{\par\egroup}
+\def\persian{\bgroup\par\raggedleft\@RTLtrue\persianfont}
+\def\endpersian{\par\egroup}
+\def\biditheoremname{????????}
+\def\bidicorollaryname{??????????}
+\def\bidifactname{??????????}
+\def\bidilemmaname{????}
+\def\bidiproblemname{??????????}
+\def\bidisolutionname{????????}
+\def\bididefinitionname{??????????}
+\def\bididefinitionsname{?????????????????}
+\def\bidiexamplename{????????}
+\def\bidiexamplesname{???????????????}
+\def\bidiproofname{??????????}
+%    \end{macrocode}
+% \iffalse
+%</beamer-xepersian.def>
+%<*bookest-xepersian.def>
+% \fi
+% \part{bookest-xepersian.def}
+%    \begin{macrocode}
+\renewcommand \thepart {\@tartibi\c at part}
+%to make appendix numbering persian
+\renewcommand\appendix{\par
+  \setcounter{chapter}{0}%
+  \setcounter{section}{0}%
+  \gdef\@chapapp{\appendixname}%
+  \gdef\thechapter{\@harfi\c at chapter}
+}%end appendix
+%    \end{macrocode}
+% \iffalse
+%</bookest-xepersian.def>
+%<*book-xepersian.def>
+% \fi
+% \part{book-xepersian.def}
+%    \begin{macrocode}
+\renewcommand\frontmatter{%
+    \cleardoublepage
+  \@mainmatterfalse
+  \pagenumbering{harfi}}
+\renewcommand\mainmatter{%
+    \cleardoublepage
+  \@mainmattertrue
+  \pagenumbering{arabic}}
+\renewcommand \thepart {\@tartibi\c at part}
+%to make appendix numbering Persian
+\renewcommand\appendix{\par
+  \setcounter{chapter}{0}%
+  \setcounter{section}{0}%
+  \gdef\@chapapp{\appendixname}%
+  \gdef\thechapter{\@harfi\c at chapter}
+}%end appendix
+%    \end{macrocode}
+% \iffalse
+%</book-xepersian.def>
+%<*localise-xepersian.def>
+% \fi
+% \part{localise-xepersian.def}
+%    \begin{macrocode}
+\catcode`\???=3
+\catcode`???=11
+\newcommand\eqcommand[2][]{\let#1=#2}
+\newcommand\eqenvironment[2][]{\newenvironment{#1}{\begin{#2}}{\end{#2}}}
+\define at key[zf]{options}{??????????}{%
+  \edef\@tempa{#1}%
+  \edef\@tempb{MatchLowercase}%
+  \ifx\@tempa\@tempb
+    \zf at calc@scale{5}%
+  \else
+    \edef\@tempb{MatchUppercase}%
+    \ifx\@tempa\@tempb
+      \zf at calc@scale{8}%
+    \else
+      \edef\zf at scale{#1}%
+    \fi
+  \fi
+  \zf at update@family{+scale:\zf at scale}%
+  \edef\zf at scale{s*[\zf at scale]}}
+\input{commands-ltx.def}
+\input{commands-xepersian.def}
+\input{environments-ltx.def}
+\input{environments-xepersian.def}
+\input{misccommandsenvironments-ltx.def}
+%    \end{macrocode}
+% \iffalse
+%</localise-xepersian.def>
+%<*commands-ltx.def>
+% \fi
+% \part{commands-ltx.def}
+%    \begin{macrocode}
+\eqcommand[]{\abovedisplayshortskip}
+\eqcommand[]{\abovedisplayskip}
+\eqcommand[]{\abstractname}
+\eqcommand[]{\acute}
+\eqcommand[]{\addcontentsline}
+\eqcommand[]{\address}
+\eqcommand[]{\addtocontents}
+\eqcommand[]{\addtocounter}
+\eqcommand[]{\addtolength}
+\eqcommand[]{\addvspace}
+\eqcommand[]{\aleph}
+\eqcommand[]{\allowdisplaybreaks}
+\eqcommand[]{\Alph}
+\eqcommand[]{\alph}
+\eqcommand[]{\alpha}
+\eqcommand[]{\alsoname}
+\eqcommand[]{\amalg}
+\eqcommand[]{\and}
+\eqcommand[]{\angle}
+\eqcommand[]{\appendixname}
+\eqcommand[]{\approx}
+\eqcommand[]{\arabic}
+\eqcommand[]{\arccos}
+\eqcommand[]{\arcsin}
+\eqcommand[]{\arctan}
+\eqcommand[]{\arg}
+\eqcommand[]{\arraycolsep}
+\eqcommand[]{\arrayrulewidth}
+\eqcommand[]{\arraystretch}
+\eqcommand[]{\ast}
+\eqcommand[]{\asymp}
+\eqcommand[]{\AtBeginDocument}
+\eqcommand[]{\AtEndDocument}
+\eqcommand[]{\AtEndOfClass}
+\eqcommand[]{\AtEndOfPackage}
+\eqcommand[]{\author}
+\eqcommand[]{\backmatter}
+\eqcommand[]{\backslash}
+\eqcommand[]{\bar}
+\eqcommand[]{\baselineskip}
+\eqcommand[]{\baselinestretch}
+\eqcommand[]{\begin}
+\eqcommand[]{\belowdisplayshortskip}
+\eqcommand[]{\belowdisplayskip}
+\eqcommand[]{\beta}
+\eqcommand[]{\bfdefault}
+\eqcommand[]{\bfseries}
+\eqcommand[]{\bibitem}
+\eqcommand[]{\bibliography}
+\eqcommand[]{\bibliographystyle}
+\eqcommand[]{\bibname}
+\eqcommand[]{\big}
+\eqcommand[]{\Big}
+\eqcommand[]{\bigcap}
+\eqcommand[]{\bigcirc}
+\eqcommand[]{\bigcup}
+\eqcommand[]{\bigg}
+\eqcommand[]{\Bigg}
+\eqcommand[]{\bigodot}
+\eqcommand[]{\bigoplus}
+\eqcommand[]{\bigotimes}
+\eqcommand[]{\bigskip}
+\eqcommand[]{\bigskipamount}
+\eqcommand[]{\bigsqcup}
+\eqcommand[]{\bigtriangledown}
+\eqcommand[]{\bigtriangleup}
+\eqcommand[]{\biguplus}
+\eqcommand[]{\bigvee}
+\eqcommand[]{\bigwedge}
+\eqcommand[]{\binom}
+\eqcommand[]{\bmod}
+\eqcommand[]{\boldmath}
+\eqcommand[]{\boldsymbol}
+\eqcommand[]{\bot}
+\eqcommand[]{\botfigrule}
+\eqcommand[]{\bottomfraction}
+\eqcommand[]{\bowtie}
+\eqcommand[]{\Box}
+\eqcommand[]{\boxed}
+\eqcommand[]{\breve}
+\eqcommand[]{\bullet}
+\eqcommand[]{\cap}
+\eqcommand[]{\caption}
+\eqcommand[]{\cc}
+\eqcommand[]{\ccname}
+\eqcommand[]{\cdot}
+\eqcommand[]{\cdots}
+\eqcommand[]{\centering}
+\eqcommand[]{\centerline}
+\eqcommand[]{\cfrac}
+\eqcommand[]{\chapter}
+\eqcommand[]{\chapter*}
+\eqcommand[]{\chaptername}
+\eqcommand[]{\check}
+\eqcommand[]{\CheckCommand}
+\eqcommand[]{\chi}
+\eqcommand[]{\circ}
+\eqcommand[]{\circle}
+\eqcommand[]{\circle*}
+\eqcommand[]{\cite}
+\eqcommand[]{\citep}
+\eqcommand[]{\citet}
+\eqcommand[]{\ClassError}
+\eqcommand[]{\ClassInfo}
+\eqcommand[]{\ClassWarning}
+\eqcommand[]{\ClassWarningNoLine}
+\eqcommand[]{\cleardoublepage}
+\eqcommand[]{\clearpage}
+\eqcommand[]{\cline}
+\eqcommand[]{\closing}
+\eqcommand[]{\clubsuit}
+\eqcommand[]{\color}
+\eqcommand[]{\colorbox}
+\eqcommand[]{\columnsep}
+\eqcommand[]{\columnseprule}
+\eqcommand[]{\cong}
+\eqcommand[]{\contentsline}
+\eqcommand[]{\contentsname}
+\eqcommand[]{\coprod}
+\eqcommand[]{\copyright}
+\eqcommand[]{\cos}
+\eqcommand[]{\cosh}
+\eqcommand[]{\cot}
+\eqcommand[]{\coth}
+\eqcommand[]{\csc}
+\eqcommand[]{\cup}
+\eqcommand[]{\CurrentOption}
+\eqcommand[]{\dag}
+\eqcommand[]{\dagger}
+\eqcommand[]{\dashbox}
+\eqcommand[]{\dashv}
+\eqcommand[]{\date}
+\eqcommand[]{\dbinom}
+\eqcommand[]{\dblfigrule}
+\eqcommand[]{\dblfloatpagefraction}
+\eqcommand[]{\dblfloatsep}
+\eqcommand[]{\dbltextfloatsep}
+\eqcommand[]{\dbltopfraction}
+\eqcommand[]{\ddag}
+\eqcommand[]{\ddagger}
+\eqcommand[]{\dddot}
+\eqcommand[]{\ddddot}
+\eqcommand[]{\ddot}
+\eqcommand[]{\ddots}
+\eqcommand[]{\DeclareGraphicsExtensions}
+\eqcommand[]{\DeclareGraphicsRule}
+\eqcommand[]{\DeclareOption}
+\eqcommand[]{\DeclareOption*}
+\eqcommand[]{\DeclareRobustCommand}
+\eqcommand[]{\DeclareRobustCommand*}
+\eqcommand[]{\definecolor}
+\eqcommand[]{\deg}
+\eqcommand[]{\DeleteShortVerb}
+\eqcommand[]{\Delta}
+\eqcommand[]{\delta}
+\eqcommand[]{\depth}
+\eqcommand[]{\det}
+\eqcommand[]{\dfrac}
+\eqcommand[]{\Diamond}
+\eqcommand[]{\diamond}
+\eqcommand[]{\diamondsuit}
+\eqcommand[]{\dim}
+\eqcommand[]{\discretionary}
+\eqcommand[]{\displaybreak}
+\eqcommand[]{\displaystyle}
+\eqcommand[]{\div}
+\eqcommand[]{\documentclass}
+\eqcommand[]{\dot}
+\eqcommand[]{\doteq}
+\eqcommand[]{\dotfill}
+\eqcommand[]{\dots}
+\eqcommand[]{\dotsb}
+\eqcommand[]{\dotsc}
+\eqcommand[]{\dotsi}
+\eqcommand[]{\dotsm}
+\eqcommand[]{\doublebox}
+\eqcommand[]{\doublerulesep}
+\eqcommand[]{\Downarrow}
+\eqcommand[]{\downarrow}
+\eqcommand[]{\ell}
+\eqcommand[]{\em}
+\eqcommand[]{\emph}
+\eqcommand[]{\emptyset}
+\eqcommand[]{\encl}
+\eqcommand[]{\enclname}
+\eqcommand[]{\end}
+\eqcommand[]{\endfirsthead}
+\eqcommand[]{\endfoot}
+\eqcommand[]{\endhead}
+\eqcommand[]{\endlastfoot}
+\eqcommand[]{\enlargethispage}
+\eqcommand[]{\enlargethispage*}
+\eqcommand[]{\ensuremath}
+\eqcommand[]{\epsilon}
+\eqcommand[]{\eqref}
+\eqcommand[]{\equiv}
+\eqcommand[]{\eta}
+\eqcommand[]{\euro}
+\eqcommand[]{\EUR}
+\eqcommand[]{\evensidemargin}
+\eqcommand[]{\ExecuteOptions}
+\eqcommand[]{\exists}
+\eqcommand[]{\exp}
+\eqcommand[]{\extracolsep}
+\eqcommand[]{\fancypage}
+\eqcommand[]{\fbox}
+\eqcommand[]{\fboxrule}
+\eqcommand[]{\fboxsep}
+\eqcommand[]{\fcolorbox}
+\eqcommand[]{\figurename}
+\eqcommand[]{\fill}
+\eqcommand[]{\flat}
+\eqcommand[]{\floatpagefraction}
+\eqcommand[]{\floatsep}
+\eqcommand[]{\flushbottom}
+\eqcommand[]{\fnsymbol}
+\eqcommand[]{\fontfamily}
+\eqcommand[]{\fontseries}
+\eqcommand[]{\fontshape}
+\eqcommand[]{\fontsize}
+\eqcommand[]{\LTRfootnote}
+\eqcommand[]{\footnote}
+\eqcommand[]{\footnotemark}
+\eqcommand[]{\footnoterule}
+\eqcommand[]{\footnotesep}
+\eqcommand[]{\footnotesize}
+\eqcommand[]{\footnotetext}
+\eqcommand[]{\footskip}
+\eqcommand[]{\forall}
+\eqcommand[]{\frac}
+\eqcommand[]{\frame}
+\eqcommand[]{\framebox}
+\eqcommand[]{\frenchspacing}
+\eqcommand[]{\frontmatter}
+\eqcommand[]{\frown}
+\eqcommand[]{\fussy}
+\eqcommand[]{\Gamma}
+\eqcommand[]{\gamma}
+\eqcommand[]{\gcd}
+\eqcommand[]{\ge}
+\eqcommand[]{\genfrac}
+\eqcommand[]{\geq}
+\eqcommand[]{\gets}
+\eqcommand[]{\gg}
+\eqcommand[]{\glossary}
+\eqcommand[]{\glossaryentry}
+\eqcommand[]{\graphpaper}
+\eqcommand[]{\grave}
+\eqcommand[]{\guillemotleft}
+\eqcommand[]{\guillemotright}
+\eqcommand[]{\guilsinglleft}
+\eqcommand[]{\guilsinglright}
+\eqcommand[]{\hat}
+\eqcommand[]{\hbar}
+\eqcommand[]{\headheight}
+\eqcommand[]{\headsep}
+\eqcommand[]{\headtoname}
+\eqcommand[]{\heartsuit}
+\eqcommand[]{\height}
+\eqcommand[]{\hfill}
+\eqcommand[]{\hline}
+\eqcommand[]{\hoffset}
+\eqcommand[]{\hom}
+\eqcommand[]{\hookleftarrow}
+\eqcommand[]{\hookrightarrow}
+\eqcommand[]{\hrulefill}
+\eqcommand[]{\hspace}
+\eqcommand[]{\hspace*}
+\eqcommand[]{\huge}
+\eqcommand[]{\Huge}
+\eqcommand[]{\hyperlink}
+\eqcommand[]{\hypersetup}
+\eqcommand[]{\hypertarget}
+\eqcommand[]{\hyphenation}
+\eqcommand[]{\idotsint}
+\eqcommand[]{\iff}
+\eqcommand[]{\IfFileExists}
+\eqcommand[]{\ifthenelse}
+\eqcommand[]{\Im}
+\eqcommand[]{\imath}
+\eqcommand[]{\in}
+\eqcommand[]{\include}
+\eqcommand[]{\includegraphics}
+\eqcommand[]{\includegraphics*}
+\eqcommand[]{\includeonly}
+\eqcommand[]{\indent}
+\eqcommand[]{\index}
+\eqcommand[]{\indexentry}
+\eqcommand[]{\indexname}
+\eqcommand[]{\indexspace}
+\eqcommand[]{\inf}
+\eqcommand[]{\infty}
+\eqcommand[]{\input}
+\eqcommand[]{\InputIfFileExists}
+\eqcommand[]{\int}
+\eqcommand[]{\iint}
+\eqcommand[]{\iiint}
+\eqcommand[]{\iiiint}
+\eqcommand[]{\intertext}
+\eqcommand[]{\intertextsep}
+\eqcommand[]{\invisible}
+\eqcommand[]{\iota}
+\eqcommand[]{\itdefault}
+\eqcommand[]{\item}
+\eqcommand[]{\itemindent}
+\eqcommand[]{\itemsep}
+\eqcommand[]{\itshape}
+\eqcommand[]{\jmath}
+\eqcommand[]{\join}
+\eqcommand[]{\jot}
+\eqcommand[]{\kappa}
+\eqcommand[]{\ker}
+\eqcommand[]{\kill}
+\eqcommand[]{\label}
+\eqcommand[]{\labelenumi}
+\eqcommand[]{\labelenumii}
+\eqcommand[]{\labelenumiii}
+\eqcommand[]{\labelenumiv}
+\eqcommand[]{\labelitemi}
+\eqcommand[]{\labelitemii}
+\eqcommand[]{\labelitemiii}
+\eqcommand[]{\labelitemiv}
+\eqcommand[]{\labelsep}
+\eqcommand[]{\labelwidth}
+\eqcommand[]{\Lambda}
+\eqcommand[]{\lambda}
+\eqcommand[]{\langle}
+\eqcommand[]{\language}
+\eqcommand[]{\large}
+\eqcommand[]{\Large}
+\eqcommand[]{\LARGE}
+\eqcommand[]{\LaTeX}
+\eqcommand[]{\LaTeXe}
+\eqcommand[]{\lceil}
+\eqcommand[]{\ldots}
+\eqcommand[]{\le}
+\eqcommand[]{\leadsto}
+\eqcommand[]{\left}
+\eqcommand[]{\Leftarrow}
+\eqcommand[]{\leftarrow}
+\eqcommand[]{\lefteqn}
+\eqcommand[]{\leftharpoondown}
+\eqcommand[]{\leftharpoonup}
+\eqcommand[]{\leftmargin}
+\eqcommand[]{\Leftrightarrow}
+\eqcommand[]{\leftrightarrow}
+\eqcommand[]{\leftroot}
+\eqcommand[]{\leq}
+\eqcommand[]{\lfloor}
+\eqcommand[]{\lg}
+\eqcommand[]{\lhd}
+\eqcommand[]{\lim}
+\eqcommand[]{\liminf}
+\eqcommand[]{\limits}
+\eqcommand[]{\limsup}
+\eqcommand[]{\line}
+\eqcommand[]{\linebreak}
+\eqcommand[]{\linethickness}
+\eqcommand[]{\linewidth}
+\eqcommand[]{\listfigurename}
+\eqcommand[]{\listfiles}
+\eqcommand[]{\listoffigures}
+\eqcommand[]{\listoftables}
+\eqcommand[]{\listparindent}
+\eqcommand[]{\listtablename}
+\eqcommand[]{\ll}
+\eqcommand[]{\ln}
+\eqcommand[]{\LoadClass}
+\eqcommand[]{\LoadClassWithOptions}
+\eqcommand[]{\location}
+\eqcommand[]{\log}
+\eqcommand[]{\Longleftarrow}
+\eqcommand[]{\longleftarrow}
+\eqcommand[]{\Longleftrightarrow}
+\eqcommand[]{\longleftrightarrow}
+\eqcommand[]{\longmapsto}
+\eqcommand[]{\Longrightarrow}
+\eqcommand[]{\longrightarrow}
+\eqcommand[]{\lvert}
+\eqcommand[]{\lVert}
+\eqcommand[]{\mainmatter}
+\eqcommand[]{\makebox}
+\eqcommand[]{\makeglossary}
+\eqcommand[]{\makeindex}
+\eqcommand[]{\makelabel}
+\eqcommand[]{\makelabels}
+\eqcommand[]{\MakeLowercase}
+\eqcommand[]{\MakeShortVerb}
+\eqcommand[]{\maketitle}
+\eqcommand[]{\MakeUppercase}
+\eqcommand[]{\mapsto}
+\eqcommand[]{\marginpar}
+\eqcommand[]{\marginparpush}
+\eqcommand[]{\marginparsep}
+\eqcommand[]{\marginparwidth}
+\eqcommand[]{\markboth}
+\eqcommand[]{\markright}
+\eqcommand[]{\mathbf}
+\eqcommand[]{\mathcal}
+\eqcommand[]{\mathindent}
+\eqcommand[]{\mathit}
+\eqcommand[]{\mathnormal}
+\eqcommand[]{\mathring}
+\eqcommand[]{\mathrm}
+\eqcommand[]{\mathsf}
+\eqcommand[]{\mathtt}
+\eqcommand[]{\max}
+\eqcommand[]{\mbox}
+\eqcommand[]{\mddefault}
+\eqcommand[]{\mdseries}
+\eqcommand[]{\medskip}
+\eqcommand[]{\medskipamount}
+\eqcommand[]{\medspace}
+\eqcommand[]{\MessageBreak}
+\eqcommand[]{\mho}
+\eqcommand[]{\mid}
+\eqcommand[]{\min}
+\eqcommand[]{\mod}
+\eqcommand[]{\models}
+\eqcommand[]{\mp}
+\eqcommand[]{\mspace}
+\eqcommand[]{\mu}
+\eqcommand[]{\multicolumn}
+\eqcommand[]{\multiput}
+\eqcommand[]{\multlinegap}
+\eqcommand[]{\nabla}
+\eqcommand[]{\name}
+\eqcommand[]{\natural}
+\eqcommand[]{\nearrow}
+\eqcommand[]{\NeedsTeXFormat}
+\eqcommand[]{\neg}
+\eqcommand[]{\negmedspace}
+\eqcommand[]{\negthickspace}
+\eqcommand[]{\negthinspace}
+\eqcommand[]{\neq}
+\eqcommand[]{\newboolean}
+\eqcommand[]{\newcommand}
+\eqcommand[]{\newcommand*}
+\eqcommand[]{\newcounter}
+\eqcommand[]{\newenvironment}
+\eqcommand[]{\newenvironment*}
+\eqcommand[]{\newfont}
+\eqcommand[]{\newlength}
+\eqcommand[]{\newline}
+\eqcommand[]{\newpage}
+\eqcommand[]{\newsavebox}
+\eqcommand[]{\newtheorem}
+\eqcommand[]{\ni}
+\eqcommand[]{\nocite}
+\eqcommand[]{\nofiles}
+\eqcommand[]{\noindent}
+\eqcommand[]{\nolimits}
+\eqcommand[]{\nolinebreak}
+\eqcommand[]{\nonfrenchspacing}
+\eqcommand[]{\nonumber}
+\eqcommand[]{\nopagebreak}
+\eqcommand[]{\normalcolor}
+\eqcommand[]{\normalfont}
+\eqcommand[]{\normalmarginpar}
+\eqcommand[]{\normalsize}
+\eqcommand[]{\not}
+\eqcommand[]{\notag}
+\eqcommand[]{\notin}
+\eqcommand[]{\nu}
+\eqcommand[]{\numberwithin}
+\eqcommand[]{\nwarrow}
+\eqcommand[]{\oddsidemargin}
+\eqcommand[]{\odot}
+\eqcommand[]{\oint}
+\eqcommand[]{\Omega}
+\eqcommand[]{\omega}
+\eqcommand[]{\ominus}
+\eqcommand[]{\onecolumn}
+\eqcommand[]{\onlynotes}
+\eqcommand[]{\onlyslides}
+\eqcommand[]{\opening}
+\eqcommand[]{\oplus}
+\eqcommand[]{\OptionNotUsed}
+\eqcommand[]{\oslash}
+\eqcommand[]{\otimes}
+\eqcommand[]{\oval}
+\eqcommand[]{\ovalbox}
+\eqcommand[]{\Ovalbox}
+\eqcommand[]{\overbrace}
+\eqcommand[]{\overleftarrow}
+\eqcommand[]{\overleftrightarrow}
+\eqcommand[]{\overline}
+\eqcommand[]{\overrightarrow}
+\eqcommand[]{\overset}
+\eqcommand[]{\PackageError}
+\eqcommand[]{\PackageInfo}
+\eqcommand[]{\PackageWarning}
+\eqcommand[]{\PackageWarningNoLine}
+\eqcommand[]{\pagebreak}
+\eqcommand[]{\pagecolor}
+\eqcommand[]{\pagename}
+\eqcommand[]{\pagenumbering}
+\eqcommand[]{\pageref}
+\eqcommand[]{\pagestyle}
+\eqcommand[]{\paperheight}
+\eqcommand[]{\paperwidth}
+\eqcommand[]{\par}
+\eqcommand[]{\paragraph}
+\eqcommand[]{\paragraph*}
+\eqcommand[]{\parallel}
+\eqcommand[]{\parbox}
+\eqcommand[]{\parindent}
+\eqcommand[]{\parsep}
+\eqcommand[]{\parskip}
+\eqcommand[]{\part}
+\eqcommand[]{\part*}
+\eqcommand[]{\partial}
+\eqcommand[]{\partname}
+\eqcommand[]{\partopsep}
+\eqcommand[]{\PassOptionToClass}
+\eqcommand[]{\PassOptionToPackage}
+\eqcommand[]{\path}
+\eqcommand[]{\prep}
+\eqcommand[]{\Phi}
+\eqcommand[]{\phi}
+\eqcommand[]{\Pi}
+\eqcommand[]{\pi}
+\eqcommand[]{\pm}
+\eqcommand[]{\pmb}
+\eqcommand[]{\pmod}
+\eqcommand[]{\pod}
+\eqcommand[]{\poptabs}
+\eqcommand[]{\pounds}
+\eqcommand[]{\Pr}
+\eqcommand[]{\prec}
+\eqcommand[]{\preceq}
+\eqcommand[]{\prime}
+\eqcommand[]{\printindex}
+\eqcommand[]{\ProcessOptions}
+\eqcommand[]{\ProcessOptions*}
+\eqcommand[]{\prod}
+\eqcommand[]{\propto}
+\eqcommand[]{\protect}
+\eqcommand[]{\providecommand}
+\eqcommand[]{\providecommand*}
+\eqcommand[]{\ProvidesClass}
+\eqcommand[]{\ProvidesFile}
+\eqcommand[]{\ProvidesPackage}
+\eqcommand[]{\ps}
+\eqcommand[]{\Psi}
+\eqcommand[]{\psi}
+\eqcommand[]{\pushtabs}
+\eqcommand[]{\put}
+\eqcommand[]{\qbezier}
+\eqcommand[]{\qquad}
+\eqcommand[]{\quad}
+\eqcommand[]{\raggedbottom}
+\eqcommand[]{\raggedleft}
+\eqcommand[]{\raggedright}
+\eqcommand[]{\raisebox}
+\eqcommand[]{\raisetag}
+\eqcommand[]{\rangle}
+\eqcommand[]{\rceil}
+\eqcommand[]{\Re}
+\eqcommand[]{\ref}
+\eqcommand[]{\reflectbox}
+\eqcommand[]{\refname}
+\eqcommand[]{\refstepcounter}
+\eqcommand[]{\renewcommand}
+\eqcommand[]{\renewcommand*}
+\eqcommand[]{\renewenvironment}
+\eqcommand[]{\renewenvironment*}
+\eqcommand[]{\RequirePackage}
+\eqcommand[]{\RequirePackageWithOptions}
+\eqcommand[]{\resizebox}
+\eqcommand[]{\resizebox*}
+\eqcommand[]{\reversemarginpar}
+\eqcommand[]{\rfloor}
+\eqcommand[]{\rhd}
+\eqcommand[]{\rho}
+\eqcommand[]{\right}
+\eqcommand[]{\Rightarrow}
+\eqcommand[]{\rightarrow}
+\eqcommand[]{\rightharpoondown}
+\eqcommand[]{\rightharpoonup}
+\eqcommand[]{\rightleftharpoons}
+\eqcommand[]{\rightmargin}
+\eqcommand[]{\rmdefault}
+\eqcommand[]{\rmfamily}
+\eqcommand[]{\Roman}
+\eqcommand[]{\roman}
+\eqcommand[]{\rotatebox}
+\eqcommand[]{\rule}
+\eqcommand[]{\rvert}
+\eqcommand[]{\rVert}
+\eqcommand[]{\savebox}
+\eqcommand[]{\sbox}
+\eqcommand[]{\scalebox}
+\eqcommand[]{\scdefault}
+\eqcommand[]{\scriptscriptstyle}
+\eqcommand[]{\scriptsize}
+\eqcommand[]{\scripstyle}
+\eqcommand[]{\scshape}
+\eqcommand[]{\searrow}
+\eqcommand[]{\sec}
+\eqcommand[]{\section}
+\eqcommand[]{\section*}
+\eqcommand[]{\see}
+\eqcommand[]{\seealso}
+\eqcommand[]{\seename}
+\eqcommand[]{\selectfont}
+\eqcommand[]{\setboolean}
+\eqcommand[]{\setcounter}
+\eqcommand[]{\setlength}
+\eqcommand[]{\setminus}
+\eqcommand[]{\settodepth}
+\eqcommand[]{\settoheight}
+\eqcommand[]{\settowidth}
+\eqcommand[]{\sfdefault}
+\eqcommand[]{\sffamily}
+\eqcommand[]{\shadowbox}
+\eqcommand[]{\sharp}
+\eqcommand[]{\shortstack}
+\eqcommand[]{\sideset}
+\eqcommand[]{\Sigma}
+\eqcommand[]{\sigma}
+\eqcommand[]{\signature}
+\eqcommand[]{\sim}
+\eqcommand[]{\simeq}
+\eqcommand[]{\sin}
+\eqcommand[]{\sinh}
+\eqcommand[]{\sldefault}
+\eqcommand[]{\sloppy}
+\eqcommand[]{\slshape}
+\eqcommand[]{\small}
+\eqcommand[]{\smallskip}
+\eqcommand[]{\smallskipamount}
+\eqcommand[]{\smash}
+\eqcommand[]{\smile}
+\eqcommand[]{\spadesuit}
+\eqcommand[]{\sqcap}
+\eqcommand[]{\sqcup}
+\eqcommand[]{\sqrt}
+\eqcommand[]{\sqsubset}
+\eqcommand[]{\sqsubseteq}
+\eqcommand[]{\sqsupset}
+\eqcommand[]{\sqsupseteq}
+\eqcommand[]{\stackrel}
+\eqcommand[]{\star}
+\eqcommand[]{\stepcounter}
+\eqcommand[]{\stretch}
+\eqcommand[]{\subitem}
+\eqcommand[]{\subparagraph}
+\eqcommand[]{\subparagraph*}
+\eqcommand[]{\subsection}
+\eqcommand[]{\subsection*}
+\eqcommand[]{\substack}
+\eqcommand[]{\subsubitem}
+\eqcommand[]{\subsubsection}
+\eqcommand[]{\subsubsection*}
+\eqcommand[]{\subset}
+\eqcommand[]{\subseteq}
+\eqcommand[]{\succ}
+\eqcommand[]{\succeq}
+\eqcommand[]{\sum}
+\eqcommand[]{\sup}
+\eqcommand[]{\supressfloats}
+\eqcommand[]{\supset}
+\eqcommand[]{\supseteq}
+\eqcommand[]{\surd}
+\eqcommand[]{\swarrow}
+\eqcommand[]{\tabbingsep}
+\eqcommand[]{\tabcolsep}
+\eqcommand[]{\tableofcontents}
+\eqcommand[]{\tablename}
+\eqcommand[]{\tabularnewline}
+\eqcommand[]{\tag}
+\eqcommand[]{\tan}
+\eqcommand[]{\tanh}
+\eqcommand[]{\tau}
+\eqcommand[]{\tbinom}
+\eqcommand[]{\telephone}
+\eqcommand[]{\TeX}
+\eqcommand[]{\text}
+\eqcommand[]{\textbullet}
+\eqcommand[]{\textemdash}
+\eqcommand[]{\textendash}
+\eqcommand[]{\textexclamdown}
+\eqcommand[]{\textperiodcentered}
+\eqcommand[]{\textquestiondown}
+\eqcommand[]{\textquotedblleft}
+\eqcommand[]{\textquotedblright}
+\eqcommand[]{\textquoteleft}
+\eqcommand[]{\textquoteright}
+\eqcommand[]{\textvisiblespace}
+\eqcommand[]{\textasciicircum}
+\eqcommand[]{\textasciitilde}
+\eqcommand[]{\textbackslash}
+\eqcommand[]{\textbar}
+\eqcommand[]{\textgreater}
+\eqcommand[]{\textless}
+\eqcommand[]{\textbf}
+\eqcommand[]{\textcircled}
+\eqcommand[]{\textcolor}
+\eqcommand[]{\textcompwordmark}
+\eqcommand[]{\textfloatsep}
+\eqcommand[]{\textfraction}
+\eqcommand[]{\textheight}
+\eqcommand[]{\textit}
+\eqcommand[]{\textmd}
+\eqcommand[]{\textnormal}
+\eqcommand[]{\textregistered}
+\eqcommand[]{\textrm}
+\eqcommand[]{\textsc}
+\eqcommand[]{\textsf}
+\eqcommand[]{\textsl}
+\eqcommand[]{\textstyle}
+\eqcommand[]{\textsuperscript}
+\eqcommand[]{\texttrademark}
+\eqcommand[]{\texttt}
+\eqcommand[]{\textup}
+\eqcommand[]{\textwidth}
+\eqcommand[]{\tfrac}
+\eqcommand[]{\thanks}
+\eqcommand[]{\Theta}
+\eqcommand[]{\theta}
+\eqcommand[]{\thicklines}
+\eqcommand[]{\thickspace}
+\eqcommand[]{\thinlines}
+\eqcommand[]{\thinspace}
+\eqcommand[]{\thisfancypage}
+\eqcommand[]{\thispagestyle}
+\eqcommand[]{\tilde}
+\eqcommand[]{\tiny}
+\eqcommand[]{\times}
+\eqcommand[]{\title}
+\eqcommand[]{\to}
+\eqcommand[]{\today}
+\eqcommand[]{\top}
+\eqcommand[]{\topfigrule}
+\eqcommand[]{\topfraction}
+\eqcommand[]{\topmargin}
+\eqcommand[]{\topsep}
+\eqcommand[]{\topskip}
+\eqcommand[]{\totalheight}
+\eqcommand[]{\triangle}
+\eqcommand[]{\triangleleft}
+\eqcommand[]{\triangleright}
+\eqcommand[]{\ttdefault}
+\eqcommand[]{\ttfamily}
+\eqcommand[]{\twocolumn}
+\eqcommand[]{\typein}
+\eqcommand[]{\typeout}
+\eqcommand[]{\unboldmath}
+\eqcommand[]{\underbrace}
+\eqcommand[]{\underleftarrow}
+\eqcommand[]{\underleftrightarrow}
+\eqcommand[]{\underline}
+\eqcommand[]{\underrightarrow}
+\eqcommand[]{\underset}
+\eqcommand[]{\unitlength}
+\eqcommand[]{\unlhd}
+\eqcommand[]{\unrhd}
+\eqcommand[]{\Uparrow}
+\eqcommand[]{\uparrow}
+\eqcommand[]{\updefault}
+\eqcommand[]{\Updownarrow}
+\eqcommand[]{\updownarrow}
+\eqcommand[]{\uplus}
+\eqcommand[]{\upshape}
+\eqcommand[]{\Upsilon}
+\eqcommand[]{\upsilon}
+\eqcommand[]{\uproot}
+\eqcommand[]{\url}
+\eqcommand[]{\urlstyle}
+\eqcommand[]{\usebox}
+\eqcommand[]{\usecounter}
+\eqcommand[]{\usefont}
+\eqcommand[]{\usepackage}
+\eqcommand[]{\value}
+\eqcommand[]{\varepsilon}
+\eqcommand[]{\varinjlim}
+\eqcommand[]{\varliminf}
+\eqcommand[]{\varlimsup}
+\eqcommand[]{\varphi}
+\eqcommand[]{\varpi}
+\eqcommand[]{\varprojlim}
+\eqcommand[]{\varrho}
+\eqcommand[]{\varsigma}
+\eqcommand[]{\vartheta}
+\eqcommand[]{\vdash}
+\eqcommand[]{\vdots}
+\eqcommand[]{\vec}
+\eqcommand[]{\vector}
+\eqcommand[]{\vee}
+\eqcommand[]{\verb}
+\eqcommand[]{\verb*}
+\eqcommand[]{\vfill}
+\eqcommand[]{\visible}
+\eqcommand[]{\vline}
+\eqcommand[]{\voffset}
+\eqcommand[]{\vpageref}
+\eqcommand[]{\vref}
+\eqcommand[]{\vspace}
+\eqcommand[]{\vspace*}
+\eqcommand[]{\wedge}
+\eqcommand[]{\whiledo}
+\eqcommand[]{\widehat}
+\eqcommand[]{\widetilde}
+\eqcommand[]{\width}
+\eqcommand[]{\wp}
+\eqcommand[]{\wr}
+\eqcommand[]{\Xi}
+\eqcommand[]{\xi}
+\eqcommand[]{\xleftarrow}
+\eqcommand[]{\xrightarrow}
+\eqcommand[]{\zeta}
+%    \end{macrocode}
+% \iffalse
+%</commands-ltx.def>
+%<*commands-xepersian.def>
+% \fi
+% \part{commands-xepersian.def}
+%    \begin{macrocode}
+
+%    \end{macrocode}
+% \iffalse
+%</commands-xepersian.def>
+%<*enumerate-xepersian.def>
+% \fi
+% \part{enumerate-xepersian.def}
+%    \begin{macrocode}
+\def\@enloop@{%
+  \ifx ??\@entemp         \def\@tempa{\@enLabel\harfi  }\else
+  \ifx ??\@entemp         \def\@tempa{\@enLabel\adadi  }\else
+  \ifx ??\@entemp         \def\@tempa{\@enLabel\tartibi  }\else
+  \ifx A\@entemp         \def\@tempa{\@enLabel\Alph  }\else
+  \ifx a\@entemp         \def\@tempa{\@enLabel\alph  }\else
+  \ifx i\@entemp         \def\@tempa{\@enLabel\roman }\else
+  \ifx I\@entemp         \def\@tempa{\@enLabel\Roman }\else
+  \ifx 1\@entemp         \def\@tempa{\@enLabel\arabic}\else
+  \ifx \@sptoken\@entemp \let\@tempa\@enSpace         \else
+  \ifx \bgroup\@entemp   \let\@tempa\@enGroup         \else
+  \ifx \@enum@\@entemp   \let\@tempa\@gobble          \else
+                         \let\@tempa\@enOther
+                         \@enhook
+             \fi\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi
+  \@tempa}
+%    \end{macrocode}
+% \iffalse
+%</enumerate-xepersian.def>
+%<*environments-ltx.def>
+% \fi
+% \part{environments-ltx.def}
+%    \begin{macrocode}
+\eqenvironment[]{abstract}
+\eqenvironment[]{align}
+\eqenvironment[]{alignat}
+\eqenvironment[]{aligned}
+\eqenvironment[]{appendix}
+\eqenvironment[]{array}
+\eqenvironment[]{center}
+\eqenvironment[]{alltt}
+\eqenvironment[]{bmatrix}
+\eqenvironment[]{Bmatrix}
+\eqenvironment[]{cases}
+\eqenvironment[]{description}
+\eqenvironment[]{displaymath}
+\eqenvironment[]{enumerate}
+\eqenvironment[]{eqnarray}
+\eqenvironment[]{eqnarray*}
+\eqenvironment[]{equation}
+\eqenvironment[]{equation*}
+\eqenvironment[]{falign}
+\eqenvironment[]{figure}
+\eqenvironment[]{figure*}
+\eqenvironment[]{filecontents}
+\eqenvironment[]{filecontents*}
+\eqenvironment[]{flushleft}
+\eqenvironment[]{flushright}
+\eqenvironment[]{gather}
+\eqenvironment[]{gathered}
+\eqenvironment[]{itemize}
+\eqenvironment[]{letter}
+\eqenvironment[]{list}
+\eqenvironment[]{longtable}
+\eqenvironment[]{lrbox}
+\eqenvironment[]{math}
+\eqenvironment[]{matrix}
+\eqenvironment[]{minipage}
+\eqenvironment[]{multicols}
+\eqenvironment[]{multline}
+\eqenvironment[]{note}
+\eqenvironment[]{overlay}
+\eqenvironment[]{picture}
+\eqenvironment[]{pmatrix}
+\eqenvironment[]{quotation}
+\eqenvironment[]{quote}
+\eqenvironment[]{slide}
+\eqenvironment[]{sloppypar}
+\eqenvironment[]{split}
+\eqenvironment[]{subarray}
+\eqenvironment[]{subequations}
+\eqenvironment[]{tabbing}
+\eqenvironment[]{table}
+\eqenvironment[]{table*}
+\eqenvironment[]{tabular}
+\eqenvironment[]{tabular*}
+\eqenvironment[]{thebibliography}
+\eqenvironment[]{theindex}
+\eqenvironment[]{titlepage}
+\eqenvironment[]{trivlist}
+\eqenvironment[]{verbatim}
+\eqenvironment[]{verbatim*}
+\eqenvironment[]{verse}
+\eqenvironment[]{vmatrix}
+\eqenvironment[]{Vmatrix}
+%    \end{macrocode}
+% \iffalse
+%</environments-ltx.def>
+%<*environments-xepersian.def>
+% \fi
+% \part{environments-xepersian.def}
+%    \begin{macrocode}
+
+%    \end{macrocode}
+% \iffalse
+%</environments-xepersian.def>
+%<*extbook-xepersian.def>
+% \fi
+% \part{extbook-xepersian.def}
+%    \begin{macrocode}
+\renewcommand\frontmatter{%
+    \cleardoublepage
+  \@mainmatterfalse
+  \pagenumbering{harfi}}
+\renewcommand\mainmatter{%
+    \cleardoublepage
+  \@mainmattertrue
+  \pagenumbering{arabic}}
+\renewcommand \thepart {\@tartibi\c at part}
+%to make appendix numbering Persian
+\renewcommand\appendix{\par
+  \setcounter{chapter}{0}%
+  \setcounter{section}{0}%
+  \gdef\@chapapp{\appendixname}%
+  \gdef\thechapter{\@harfi\c at chapter}
+}%end appendix
+%    \end{macrocode}
+% \iffalse
+%</extbook-xepersian.def>
+%<*kashida-xepersian.def>
+% \fi
+% \part{kashida-xepersian.def}
+%    \begin{macrocode}
+\chardef\zwj="200D % zero-width joiner
+\chardef\ksh="0640 % kashida
+
+\chardef\D=10 % dual-joiner class
+\chardef\L=11 % lam
+\chardef\R=12 % right-joiner
+\chardef\A=13 % alef
+\chardef\V=256 % vowel or other combining mark (to be ignored)
+
+\def\kashida{\zwj\nobreak \setbox0=\hbox{\ksh}%
+    \leaders\hrule height\ht0 \hskip0pt plus 0.5em \zwj}
+
+\def\setclass#1#2{\def\theclass{#1}\def\charlist{#2}%
+  \expandafter\dosetclass\charlist,\end}
+\def\dosetclass#1,#2\end{%
+  \def\test{#1}\def\charlist{#2}%
+  \ifx\test\empty\let\next\finishsetclass
+  \else \XeTeXcharclass "\test = \theclass
+     \let\next\dosetclass \fi
+  \expandafter\next\charlist,,\end}
+\def\finishsetclass#1,,\end{}
+
+\setclass \A {0622,0623,0625,0627}
+\setclass \R {0624,0629,062F,0630,0631,0632,0648,0698}
+\setclass \D {0626,0628,062A,062B,062C,062D,062E}
+\setclass \D {0633,0634,0635,0636,0637,0638,0639,063A}
+\setclass \D {0640,0641,0642,0643,0645,0646,0647,0649,064A}
+\setclass \D {067E,0686,06A9,06AF,06CC}
+\setclass \L {0644}
+\setclass \V {064B,064C,064D,064E,064F,0650,0651,0652}
+
+\XeTeXinterchartoks \D \D = {\kashida}
+\XeTeXinterchartoks \L \D = {\kashida}
+\XeTeXinterchartoks \D \L = {\kashida}
+\XeTeXinterchartoks \L \L = {\kashida}
+\XeTeXinterchartoks \D \R = {\kashida}
+\XeTeXinterchartoks \D \A = {\kashida}
+\XeTeXinterchartoks \L \R = {\kashida}
+\XeTeXinterchartoks \L \A = {}
+
+\XeTeXinterchartokenstate=1
+%    \end{macrocode}
+% \iffalse
+%</kashida-xepersian.def>
+%<*listings-xepersian.def>
+% \fi
+% \part{listings-xepersian.def}
+%    \begin{macrocode}
+\def\lstlistingname{??????????????}
+\def\lstlistlistingname{?????????? ???????????????????}
+%    \end{macrocode}
+% \iffalse
+%</listings-xepersian.def>
+%<*misccommandsenvironments-ltx.def>
+% \fi
+% \part{misccommandsenvironments-ltx.def}
+%    \begin{macrocode}
+\eqcommand[\??????]{\document}
+\eqcommand[\end??????]{\enddocument}
+%    \end{macrocode}
+% \iffalse
+%</misccommandsenvironments-ltx.def>
+%<*refrep-xepersian.def>
+% \fi
+% \part{refrep-xepersian.def}
+%    \begin{macrocode}
+\renewcommand \thepart {\@tartibi\c at part}
+%to make appendix numbering Persian
+\renewcommand\appendix{\par
+  \setcounter{chapter}{0}%
+  \setcounter{section}{0}%
+  \gdef\@chapapp{\appendixname}%
+  \gdef\thechapter{\@harfi\c at chapter}
+}%end appendix
+%    \end{macrocode}
+% \iffalse
+%</refrep-xepersian.def>
+%<*report-xepersian.def>
+% \fi
+% \part{report-xepersian.def}
+%    \begin{macrocode}
+\renewcommand \thepart {\@tartibi\c at part}
+%to make appendix numbering Persian
+\renewcommand\appendix{\par
+  \setcounter{chapter}{0}%
+  \setcounter{section}{0}%
+  \gdef\@chapapp{\appendixname}%
+  \gdef\thechapter{\@harfi\c at chapter}
+}%end appendix
+%    \end{macrocode}
+% \iffalse
+%</report-xepersian.def>
+%<*xepersian-magazine.cls>
+% \fi
+% \part{xepersian-magazine.cls}
+%    \begin{macrocode}
+\NeedsTeXFormat{LaTeX2e}
+\ProvidesClass{xepersian-magazine}[2009/01/05 v0.1 Typesetting Persian magazines in XeLaTeX (Author: Vafa Khalighi)]
+\RequirePackage{ifthen}
+\newlength{\xepersian at imgsize}
+\newlength{\xepersian at coltitsize}
+\newlength{\xepersian at pageneed}
+\newlength{\xepersian at pageleft}
+\newlength{\xepersian at indexwidth}
+\newcommand{\xepersian at ncolumns}{0}
+\newlength{\columnlines}
+\setlength{\columnlines}{0 pt} % no lines by default
+\newboolean{xepersian at hyphenatedtitles}
+\setboolean{xepersian at hyphenatedtitles}{true}
+\newboolean{xepersian at ninepoints}
+\setboolean{xepersian at ninepoints}{false}
+\newboolean{xepersian at showgrid}
+\setboolean{xepersian at showgrid}{false}
+\newboolean{xepersian at a3paper}
+\setboolean{xepersian at a3paper}{false}
+\newboolean{xepersian at insidefrontpage}
+\setboolean{xepersian at insidefrontpage}{false}
+\newboolean{xepersian at insideweather}
+\setboolean{xepersian at insideweather}{false}
+\newboolean{xepersian at insideindex}
+\setboolean{xepersian at insideindex}{false}
+\newcount\xepersian at gridrows
+\newcount\xepersian at gridcolumns
+\xepersian at gridrows=40
+\xepersian at gridcolumns=50
+\newcount\minraggedcols
+\minraggedcols=5
+\DeclareOption{10pt}{\PassOptionsToClass{10pt}{article}}
+\DeclareOption{11pt}{\PassOptionsToClass{11pt}{article}}
+\DeclareOption{12pt}{\PassOptionsToClass{12pt}{article}}
+\DeclareOption{twocolumn}%
+{\ClassWarning{xepersian-magazine}{Option 'twocolumn' not available for xepersian-magazine.}}
+\DeclareOption{notitlepage}%
+{\ClassWarning{xepersian-magazine}{Option 'notitlepage' not available for xepersian-magazine.}}
+\DeclareOption{twoside}%
+{\ClassWarning{xepersian-magazine}{Option 'twoside' not available for xepersian-magazine.}}
+\DeclareOption{9pt}{\setboolean{xepersian at ninepoints}{true}}
+\DeclareOption{hyphenatedtitles}{\setboolean{xepersian at hyphenatedtitles}{false}}
+\DeclareOption{columnlines}{\setlength{\columnlines}{0.1 pt}}
+\DeclareOption{showgrid}{\setboolean{xepersian at showgrid}{true}}
+\DeclareOption{a3paper}{\setboolean{xepersian at a3paper}{true}}
+\ProcessOptions\relax
+\LoadClass[10pt, onecolumn, titlepage, a4paper]{article}
+\RequirePackage{ifxetex}
+\RequirePackage{multido}
+\RequirePackage{datetime}
+\RequirePackage{fmultico}
+\RequirePackage{fancyhdr}
+\RequirePackage{fancybox}
+\ifthenelse{\boolean{xepersian at a3paper}}{%
+\RequirePackage[a3paper,headsep=0.5cm,vmargin={2cm,2cm},hmargin={1.5cm,1.5cm}]{geometry}
+}{
+\RequirePackage[headsep=0.5cm,vmargin={2cm,2cm},hmargin={1.5cm,1.5cm}]{geometry}
+}
+\RequirePackage[absolute]{textpos} % absoulte positioning
+\RequirePackage{hyphenat} % when hyphenate
+\RequirePackage{lastpage} % to know the last page number
+\RequirePackage{setspace} % set space between lines
+\RequirePackage{ragged2e}
+\newcommand{\raggedFormat}{\RaggedLeft}
+\AtEndOfClass{\xepersianInit}
+\ifthenelse{\boolean{xepersian at showgrid}}{%
+\AtBeginDocument{
+\grid[show]{\xepersian at gridrows}{\xepersian at gridcolumns}}
+\advance\minraggedcols by -1
+}{%
+\AtBeginDocument{
+\grid[]{\xepersian at gridrows}{\xepersian at gridcolumns}}
+\advance\minraggedcols by -1
+}
+\ifthenelse{\boolean{xepersian at ninepoints}}{
+\renewcommand{\normalsize}{%
+  \@setfontsize{\normalsize}{9pt}{10pt}%
+  \setlength{\abovedisplayskip}{5pt plus 1pt minus .5pt}%
+  \setlength{\belowdisplayskip}{\abovedisplayskip}%
+  \setlength{\abovedisplayshortskip}{3pt plus 1pt minus 2pt}%
+  \setlength{\belowdisplayshortskip}{\abovedisplayshortskip}}
+
+\renewcommand{\tiny}{\@setfontsize{\tiny}{5pt}{6pt}}
+
+\renewcommand{\scriptsize}{\@setfontsize{\scriptsize}{7pt}{8pt}}
+
+\renewcommand{\small}{%
+  \@setfontsize{\small}{8pt}{9pt}%
+  \setlength{\abovedisplayskip}{4pt plus 1pt minus 1pt}%
+  \setlength{\belowdisplayskip}{\abovedisplayskip}%
+  \setlength{\abovedisplayshortskip}{2pt plus 1pt}%
+  \setlength{\belowdisplayshortskip}{\abovedisplayshortskip}}
+
+\renewcommand{\footnotesize}{%
+  \@setfontsize{\footnotesize}{8pt}{9pt}%
+  \setlength{\abovedisplayskip}{4pt plus 1pt minus .5pt}%
+  \setlength{\belowdisplayskip}{\abovedisplayskip}%
+  \setlength{\abovedisplayshortskip}{2pt plus 1pt}%
+  \setlength{\belowdisplayshortskip}{\abovedisplayshortskip}}
+
+\renewcommand{\large}{\@setfontsize{\large}{11pt}{13pt}}
+\renewcommand{\Large}{\@setfontsize{\Large}{14pt}{18pt}}
+\renewcommand{\LARGE}{\@setfontsize{\LARGE}{18pt}{20pt}}
+\renewcommand{\huge}{\@setfontsize{\huge}{20pt}{25pt}}
+\renewcommand{\Huge}{\@setfontsize{\Huge}{25pt}{30pt}}
+}{}
+\def\customwwwTxt#1{\gdef\@customwwwTxt{\lr{#1}}}
+\newcommand{\xepersian at wwwFormat}{\sffamily}
+\newcommand{\xepersian at www}{%
+\raisebox{-3pt}{{\xepersian at wwwFormat\@customwwwTxt}}
+}
+\newcommand{\xepersian at edition}{???????????? ????}
+\newcommand{\editionFormat}{\large\bfseries\texttt}
+\newcommand{\xepersian at editionLogo}{%
+\raisebox{-3pt}{%
+{\editionFormat\xepersian at edition}%
+}%
+}
+\newcommand{\indexFormat}{\large\bfseries}
+\newcommand{\xepersian at indexFrameTitle}[1]
+{\begin{flushright}{{\indexFormat #1}}\end{flushright}}
+
+\newcommand{\indexEntryFormat}{\normalsize}
+\newcommand{\xepersian at indexEntry}[1]{\begin{minipage}{13\TPHorizModule}%
+{\indexEntryFormat\noindent\ignorespaces{#1}}%
+\end{minipage}}
+\newcommand{\indexEntrySeparator}{\rule{\xepersian at indexwidth}{.1pt}}
+\newcommand{\indexEntryPageTxt}{??????????}
+\newcommand{\indexEntryPageFormat}{\footnotesize}
+\newcommand{\xepersian at indexEntryPage}[1]{%
+{\indexEntryPageFormat{\indexEntryPageTxt{}~#1}}%
+}
+\newcommand{\headDateTimeFormat}{}
+\newcommand{\xepersian at headDateTime}{%
+\headDateTimeFormat\date\hspace{5pt}$\parallel$\hspace{5pt}%
+\currenttime %
+}
+\newcommand{\weatherFormat}{\bfseries}
+\newcommand{\xepersian at weather}[1]{%
+\noindent{\weatherFormat #1}%
+}
+\newcommand{\weatherTempFormat}{\small}
+\newcommand{\weatherUnits}{\textdegree{}C}
+\newcommand{\xepersian at section}[0]{?????????? ??????}
+\newcommand{\xepersian at headleft}{%
+{\small\bfseries \@custommagazinename}?? \date
+}
+\newcommand{\xepersian at headcenter}{%
+\xepersian at section{}
+}
+\newcommand{\xepersian at headright}{%
+\small\xepersian at edition%
+\hspace*{5pt}\beginL\thepage\ / \pageref{LastPage}\endL
+}
+
+\newcommand{\heading}[3]{%
+\renewcommand{\xepersian at headleft}{\beginR#1\endR}%
+\renewcommand{\xepersian at headcenter}{\beginR#2\endR}%
+\renewcommand{\xepersian at headright}{\beginR#3\endR}%
+}
+\newcommand{\xepersian at footright}{%
+{\footnotesize\lr{\copyright\ \@customwwwTxt{}}---????????????????? ???????? \lr{\XePersian}}%
+}
+\newcommand{\xepersian at footcenter}{%
+}
+\newcommand{\xepersian at footleft}{%
+}
+
+\newcommand{\foot}[3]{%
+\renewcommand{\xepersian at footleft}{\beginR#1\endR}%
+\renewcommand{\xepersian at footcenter}{\beginR#2\endR}%
+\renewcommand{\xepersian at footright}{\beginR#3\endR}%
+}
+\newcommand{\firstTitleFormat}{\Huge\bfseries\flushright}
+\newcommand{\xepersian at firstTitle}[1]{%
+{%
+\begin{spacing}{2.0}{%
+\noindent\ignorespaces
+\ifthenelse{\boolean{xepersian at hyphenatedtitles}}%
+{\nohyphens{\firstTitleFormat #1}}%
+{{\firstTitleFormat #1}}%
+}%
+\end{spacing}%
+}%
+}
+\newcommand{\firstTextFormat}{}
+\newcommand{\xepersian at firstText}[1]{%
+{\noindent\ignorespaces\firstTextFormat #1}%
+}
+\newcommand{\secondTitleFormat}{\LARGE\bfseries}
+\newcommand{\xepersian at secondTitle}[1]{%
+\begin{spacing}{1.5}{%
+\noindent\ignorespaces\flushright
+\ifthenelse{\boolean{xepersian at hyphenatedtitles}}%
+{\nohyphens{\secondTitleFormat #1}}%
+{{\secondTitleFormat #1}}%
+}\end{spacing}%
+}
+\newcommand{\secondSubtitleFormat}{\large}
+\newcommand{\xepersian at secondSubtitle}[1]{%
+{\noindent\ignorespaces{\secondSubtitleFormat #1}}%
+}
+\newcommand{\secondTextFormat}{}
+\newcommand{\xepersian at secondText}[1]{%
+\begin{multicols}{2}
+{\noindent\ignorespaces\secondTextFormat #1}
+\end{multicols}
+}
+\newcommand{\thirdTitleFormat}{\Large\bfseries}
+\newcommand{\xepersian at thirdTitle}[1]{%
+\begin{spacing}{1.5}{%
+\noindent\ignorespaces\flushright
+\ifthenelse{\boolean{xepersian at hyphenatedtitles}}%
+{\nohyphens{\thirdTitleFormat #1}}%
+{{\thirdTitleFormat #1}}%
+}\end{spacing}%
+}
+\newcommand{\thirdSubtitleFormat}{\large}
+\newcommand{\xepersian at thirdSubtitle}[1]%
+{{\noindent\ignorespaces\thirdSubtitleFormat #1}}
+\newcommand{\thirdTextFormat}{}
+\newcommand{\xepersian at thirdText}[1]{{\thirdTextFormat #1}}
+\newcommand{\pictureCaptionFormat}{\small\bfseries}
+\newcommand{\xepersian at pictureCaption}[1]{%
+{\noindent\pictureCaptionFormat #1}%
+}
+\newcommand{\pagesFormat}{\bfseries\footnotesize}
+\newcommand{\xepersian at pages}[1]%
+{\noindent{\pagesFormat\MakeUppercase{#1}}}
+\newcommand{\innerTitleFormat}{\Huge}
+\newcommand{\xepersian at innerTitle}[1]{%
+\begin{flushright}{%
+\noindent
+\ifthenelse{\boolean{xepersian at hyphenatedtitles}}%
+{\nohyphens{\innerTitleFormat #1}}%
+{{\innerTitleFormat #1}}%
+}%
+\\%
+\end{flushright}%
+}
+\newcommand{\innerSubtitleFormat}{\large}
+\newcommand{\xepersian at innerSubtitle}[1]{{\innerSubtitleFormat #1}}
+\newcommand{\timestampTxt}{}
+\newcommand{\timestampSeparator}{|}
+\newcommand{\timestampFormat}{\small}
+\newcommand{\timestamp}[1]{%
+{\timestampFormat%
+#1~\timestampTxt{}%
+}~\timestampSeparator{}%
+}
+\newcommand{\innerAuthorFormat}{\footnotesize}
+\newcommand{\innerPlaceFormat}{\footnotesize\bfseries}
+\newcommand{\innerTextFinalMark}{\rule{0.65em}{0.65em}}
+\newcommand{\editorialTitleFormat}{\LARGE\textit}
+\newcommand{\xepersian at editorialTitle}[1]{\editorialTitleFormat{#1}}
+\newcommand{\editorialAuthorFormat}{\textsc}
+\newcommand{\shortarticleTitleFormat}{\LARGE\bfseries}
+\newcommand{\xepersian at shortarticleTitle}[1]{{\shortarticleTitleFormat #1}}
+\newcommand{\shortarticleSubtitleFormat}{\Large}
+\newcommand{\xepersian at shortarticleSubtitle}[1]{{\shortarticleSubtitleFormat #1}}
+\newcommand{\shortarticleItemTitleFormat}{\large\bfseries}
+\newcommand{\xepersian at shortarticleItemTitle}[1]{{\shortarticleItemTitleFormat #1}}
+\renewcommand{\maketitle}{\begin{titlepage}%
+  \let\footnotesize\small
+  \let\footnoterule\relax
+  \let \footnote \thanks
+  \null\vfil
+  \vskip 60\p@
+  \begin{center}%
+    {\LARGE \@title \par}%
+    \vskip 1em%
+    {\LARGE ??\xepersian at edition?? \par}%
+    \vskip 3em%
+    {\large
+     \lineskip .75em%
+      \begin{tabular}[t]{c}%
+        \@author
+      \end{tabular}\par}%
+      \vskip 1.5em%
+    {\large \@date \par}%
+  \end{center}\par
+  \@thanks
+  \vfil\null
+  \end{titlepage}%
+  \setcounter{footnote}{0}%
+  \global\let\thanks\relax
+  \global\let\maketitle\relax
+  \global\let\@thanks\@empty
+  \global\let\@author\@empty
+  \global\let\@date\@empty
+  \global\let\@title\@empty
+  \global\let\title\relax
+  \global\let\author\relax
+  \global\let\date\relax
+  \global\let\and\relax
+}
+\newcommand{\xepersian at say}[1]{\typeout{#1}}
+\newsavebox{\xepersian at fmbox}
+\newenvironment{xepersian at fmpage}[1]
+ {\begin{lrbox}{\xepersian at fmbox}\begin{minipage}{#1}}
+ {\end{minipage}\end{lrbox}\fbox{\usebox{\xepersian at fmbox}}}
+\newcommand{\image}[2]{
+\vspace{5pt}
+\setlength{\fboxsep}{1pt}
+\addtolength{\xepersian at imgsize}{\columnwidth}
+\addtolength{\xepersian at imgsize}{-1\columnsep}
+\ifxetex
+\setlength{\xepersian at pageneed}{1.5\xepersian at imgsize}
+\addtolength{\xepersian at pageneed}{50pt}
+\ClassWarning{xepersian-magazine}{%
+Image #1 needs: \the\xepersian at pageneed \space %
+and there is left: \the\page at free\space%
+}
+\ifdim \xepersian at pageneed < \page at free
+
+{\centering\fbox{%
+\includegraphics[width = \xepersian at imgsize,
+height = \xepersian at imgsize,
+keepaspectratio ]{#1}}}
+\xepersian at pictureCaption{#2}
+
+\vspace{5pt}
+\else
+\ClassWarning{Image #1 needs more space!%
+  It was not inserted!}
+\fi
+\fi
+}
+\textblockorigin{1cm}{1cm}
+\newdimen\xepersian at dx
+\newdimen\xepersian at dy
+\newcount\xepersian at cx
+\newcount\xepersian at cy
+\newcommand{\grid}[3][]{
+\xepersian at dx=\textwidth%
+\xepersian at dy=\textheight%
+\xepersian at cx=#3% %columns
+\xepersian at cy=#2% %rows
+
+\count1=#3%
+\advance\count1 by 1
+
+\count2=#2%
+\advance\count2 by 1
+
+\divide\xepersian at dx by #3
+\divide\xepersian at dy by #2
+
+\setlength{\TPHorizModule}{\xepersian at dx}
+\setlength{\TPVertModule}{\xepersian at dy}
+
+\ifthenelse{\equal{#1}{show}}{
+\multido{\xepersian at nrow=0+1}{\count2}{
+\begin{textblock}{\xepersian at cx}(0,\xepersian at nrow)
+\rule[0pt]{\textwidth}{.1pt}
+\end{textblock}
+}
+
+\multido{\xepersian at ncol=0+1}{\count1}{
+\begin{textblock}{\xepersian at cy}(\xepersian at ncol,0)
+\rule[0pt]{.1pt}{\textheight}
+\end{textblock}
+}
+}{}
+}
+\newcommand{\xepersianInit}{
+\setlength{\headheight}{14pt}
+\renewcommand{\headrulewidth}{0.4pt}
+
+\pagestyle{fancy}
+
+\setlength{\columnseprule}{\columnlines}
+\setlength{\fboxrule}{0.1 pt}
+
+}
+
+\def\customlogo#1{\gdef\@customlogo{\beginR#1\endR}}
+\def\customminilogo#1{\gdef\@customminilogo{\beginR#1\endR}}
+\def\custommagazinename#1{\gdef\@custommagazinename{\beginR#1\endR}}
+\newcommand{\logo}[0]{
+%% Heading %%
+\noindent\hrulefill\hspace{10pt}\xepersian at editionLogo\hspace{5pt}\xepersian at www
+
+\vspace*{-3pt}
+
+{\Large\bfseries \@customlogo}
+\hrulefill
+\hspace{10pt}\xepersian at headDateTime
+
+}
+\newcommand{\minilogo}[0]{
+{\large\bfseries \@customminilogo}
+
+\vspace*{5pt}
+}
+\newcommand{\mylogo}[1]{
+{\beginR#1\endR}
+
+\noindent
+\xepersian at editionLogo\hspace{5pt}
+\hrulefill
+\hspace{5pt}\xepersian at headDateTime
+}
+\newcommand{\edition}[1]{\renewcommand{\xepersian at edition}{#1}}
+\newenvironment{frontpage}[0]
+{
+\setboolean{xepersian at insidefrontpage}{true}
+\thispagestyle{empty}
+%\pdfbookmark[1]{?????????? ??????}{\thepage}
+\logo
+
+}%
+{
+\thispagestyle{empty}
+\clearpage
+\newpage
+\fancyhead{}
+ \fancyfoot{}
+\fancyhead[RO,LE]{\beginR\xepersian at headright\endR}
+\fancyhead[LO,RE]{\beginR\xepersian at headleft\endR}
+    \fancyhead[C]{\beginR\xepersian at headcenter\endR}
+    \fancyfoot[RO,LE]{\beginR\xepersian at footright\endR}
+    \fancyfoot[LO,RE]{\beginR\xepersian at footleft\endR}
+\fancyfoot[C]{\beginR\xepersian at footcenter\endR}
+\renewcommand{\headrulewidth}{0.4pt}
+\setboolean{xepersian at insidefrontpage}{false}
+
+}
+\newcommand{\firstarticle}[3]
+{
+\ifthenelse{\boolean{xepersian at insidefrontpage}}{%
+\ifthenelse{\boolean{xepersian at hyphenatedtitles}}{%
+\begin{textblock}{24}(22,5)
+}
+{
+\begin{textblock}{28}(22,5)
+}
+\vspace{-7pt}
+\xepersian at firstTitle{#1}
+\end{textblock}
+\begin{textblock}{29}(22,10)
+\vspace{5pt plus 2pt minus 2pt}
+
+\xepersian at firstText{\timestamp{#3}~#2}
+
+\end{textblock}
+
+\begin{textblock}{50}(0,15)
+\rule{50\TPHorizModule}{.3pt}
+\end{textblock}
+}{%else
+\ClassError{xepersian-magazine}{%
+\protect\firstarticle\space in a wrong place.\MessageBreak
+\protect\firstarticle\space may only appear inside frontpage environment.
+}{%
+\protect\firstarticle\space may only appear inside frontpage environment.
+}%
+}
+}
+\newcommand{\secondarticle}[5]
+{
+\ifthenelse{\boolean{xepersian at insidefrontpage}}{%
+\begin{textblock}{33}(2,16)
+\xepersian at pages{#4}
+\vspace{-5pt}
+\xepersian at secondTitle{#1}
+
+\vspace*{5pt}
+
+\xepersian at secondSubtitle{#2}
+
+\vspace*{-7pt}
+
+\xepersian at secondText{\timestamp{#5}~#3}
+
+\end{textblock}
+
+\begin{textblock}{33}(2,25)
+\vspace{5pt plus 2pt minus 2pt}
+
+\noindent\ignorespaces\rule{33\TPHorizModule}{.3pt}
+\end{textblock}
+}{%else
+\ClassError{xepersian-magazine}{%
+\protect\secondarticle\space in a wrong place.\MessageBreak
+\protect\secondarticle\space may only appear inside frontpage environment.
+}{%
+\protect\secondarticle\space may only appear inside frontpage environment.
+}%
+}
+}
+\newcommand{\thirdarticle}[6]
+{
+\ifthenelse{\boolean{xepersian at insidefrontpage}}{%
+\begin{textblock}{32}(2,26)
+\xepersian at pages{#5}
+\vspace{-5pt}
+\setlength{\fboxsep}{1pt}
+\xepersian at thirdTitle{#1}
+
+\vspace*{5pt}
+
+\xepersian at thirdSubtitle{#2}
+
+\vspace*{5pt}
+
+{\noindent\ignorespaces %
+\ifthenelse{\equal{#4}{}}{}
+
+\xepersian at thirdText{\timestamp{#6}~#3}
+
+}
+
+\vspace*{5pt}
+
+\end{textblock}
+}{%else
+\ClassError{xepersian-magazine}{%
+\protect\thirdarticle\space in a wrong place.\MessageBreak
+\protect\thirdarticle\space may only appear inside frontpage environment.
+}{%
+\protect\thirdarticle\space may only appear inside frontpage environment.
+}%
+}
+}
+\newcommand{\firstimage}[2]
+{
+\ifthenelse{\boolean{xepersian at insidefrontpage}}{%
+\begin{textblock}{18}(2,5)
+\setlength{\fboxsep}{1pt}
+\ifxetex % only in PDF
+\noindent\fbox{\includegraphics[width = 18\TPHorizModule ]{#1}}
+\fi
+
+\xepersian at pictureCaption{#2}
+\end{textblock}%
+}
+{\ClassError{xepersian-magazine}{%
+\protect\firstimage\space in a wrong place.\MessageBreak
+\protect\firstimage\space may only appear inside frontpage environment.
+}{%
+\protect\firstimage\space may only appear inside frontpage environment.
+}}
+}%
+\newcommand{\weatheritem}[5]{%
+\ifthenelse{\boolean{xepersian at insideweather}}{
+\begin{minipage}{45pt}
+\ifxetex
+\includegraphics[width=40pt]{#1}
+\fi
+\end{minipage}
+\begin{minipage}{50pt}
+\weatherTempFormat
+#2\\
+\beginL#3 $\|$ #4 \lr{\weatherUnits{}}\endL\\
+#5
+\end{minipage}
+}{%else
+\ClassError{xepersian-magazine}{%
+\protect\weatheritem\space in a wrong place.\MessageBreak
+\protect\weatheritem\space may only appear inside weatherblock environment.
+}{%
+\protect\weatheritem\space may only appear inside weatherblock environment.\MessageBreak
+weatherblock environment may only appear inside frontpage environment.
+}%
+}
+}
+\newenvironment{weatherblock}[1]
+{
+\ifthenelse{\boolean{xepersian at insidefrontpage}}{%
+\setboolean{xepersian at insideweather}{true}
+\begin{textblock}{32}(2,38)
+\vspace*{-15pt}
+
+\xepersian at weather{\beginR#1\endR}
+
+\vspace*{5pt}
+
+\noindent\begin{xepersian at fmpage}{32\TPHorizModule}
+\begin{minipage}{32\TPHorizModule}
+\hspace{5pt}
+
+}{%
+\ClassError{xepersian-magazine}{%
+weatherblock in a wrong place.\MessageBreak
+weatherblock may only appear inside frontpage environment.
+}{%
+weatherblock may only appear inside frontpage environment.
+}
+}
+}%
+{
+\end{minipage}
+\end{xepersian at fmpage}
+\end{textblock}
+\setboolean{xepersian at insideweather}{false}
+}
+\newenvironment{authorblock}[0]
+{
+\ifthenelse{\boolean{xepersian at insidefrontpage}}{%
+\begin{textblock}{15}(36,35)
+\setlength{\fboxsep}{5pt}
+\begin{xepersian at fmpage}{13\TPHorizModule}
+\begin{minipage}{13\TPHorizModule}
+\centering
+\minilogo
+
+}{%else
+\ClassError{xepersian-magazine}{%
+authorblock in a wrong place.\MessageBreak
+authorblock may only appear inside frontpage environment.
+}{%
+authorblock may only appear inside frontpage environment.
+}
+}
+}
+{
+\end{minipage}
+\end{xepersian at fmpage}
+\end{textblock}
+}
+\newenvironment{indexblock}[1]
+{
+\ifthenelse{\boolean{xepersian at insidefrontpage}}{%
+\setboolean{xepersian at insideindex}{true}%let's in
+\begin{textblock}{15}(36,16)
+\setlength{\xepersian at indexwidth}{13\TPHorizModule}
+\xepersian at indexFrameTitle{#1}
+
+\setlength{\fboxsep}{5pt} %espacio entre el frame y la imagen
+\begin{xepersian at fmpage}{\xepersian at indexwidth}
+\begin{minipage}{\xepersian at indexwidth}
+\vspace*{10pt}
+}{%else
+\ClassError{xepersian-magazine}{%
+indexblock in a wrong place.\MessageBreak
+indexblock may only appear inside frontpage environment.
+}{%
+indexblock may only appear inside frontpage environment.
+}
+}
+}%
+{
+\end{minipage}
+\end{xepersian at fmpage}
+\end{textblock}
+\setboolean{xepersian at insideindex}{false}%let's out
+}
+\newcommand{\indexitem}[2]
+{
+\ifthenelse{\boolean{xepersian at insideindex}}{
+\xepersian at indexEntry{#1?? \xepersian at indexEntryPage{\pageref{#2}}}
+
+\vspace{0.5cm}
+
+\noindent\ignorespaces\indexEntrySeparator{}
+}{%else
+\ClassError{xepersian-magazine}{%
+\protect\indexitem\space in a wrong place.\MessageBreak
+\protect\indexitem\space may only appear inside indexblock environment.
+}{%
+\protect\indexitem\space may only appear inside indexblock environment.\MessageBreak
+indexblock environment may only appear inside frontpage environment.
+}%
+}
+}
+\newcommand{\xepersian at inexpandedtitle}[1]{
+\begin{minipage}{.95\textwidth}
+\begin{center}
+\noindent\Large\textbf{\beginR#1\endR}
+\end{center}
+\end{minipage}
+}
+\newcommand{\expandedtitle}[2]{
+\end{multicols}
+
+\begin{center}
+\setlength{\fboxsep}{5pt}
+\setlength{\shadowsize}{2pt}
+\ifthenelse{\equal{#1}{shadowbox}}{%
+\shadowbox{%
+\xepersian at inexpandedtitle{#2}%
+}%
+}{}
+\ifthenelse{\equal{#1}{doublebox}}{%
+\doublebox{%
+\xepersian at inexpandedtitle{#2}%
+}%
+}{}
+\ifthenelse{\equal{#1}{ovalbox}}{%
+\ovalbox{%
+\xepersian at inexpandedtitle{#2}%
+}%
+}{}
+\ifthenelse{\equal{#1}{Ovalbox}}{%
+\Ovalbox{%
+\xepersian at inexpandedtitle{#2}%
+}%
+}{}
+\ifthenelse{\equal{#1}{lines}}{
+\hrule
+\vspace*{8pt}
+\begin{center}
+\noindent\Large\textbf{#2}
+\end{center}
+\vspace*{8pt}
+\hrule
+}{}
+\end{center}
+
+\begin{multicols}{\xepersian at ncolumns{}}
+\ifnum \xepersian at ncolumns > \minraggedcols
+\raggedFormat
+\fi
+}
+\newcommand{\xepersian at incolumntitle}[2]{
+\begin{minipage}{#1}
+\begin{center}
+\noindent\normalsize\textbf{#2}
+\end{center}
+\end{minipage}
+}
+
+\newcommand{\columntitle}[2]{
+\vspace*{5pt}
+\begin{center}
+\setlength{\fboxsep}{5pt}
+\setlength{\shadowsize}{2pt}
+\addtolength{\xepersian at coltitsize}{\columnwidth}
+\addtolength{\xepersian at coltitsize}{-1\columnsep}
+\addtolength{\xepersian at coltitsize}{-5pt}
+\addtolength{\xepersian at coltitsize}{-1\shadowsize}
+\ifthenelse{\equal{#1}{shadowbox}}{%
+\shadowbox{%
+\xepersian at incolumntitle{\xepersian at coltitsize}{#2}%
+}%
+}{}
+\ifthenelse{\equal{#1}{doublebox}}{%
+\doublebox{%
+\xepersian at incolumntitle{\xepersian at coltitsize}{#2}%
+}%
+}{}
+\ifthenelse{\equal{#1}{ovalbox}}{%
+\ovalbox{%
+\xepersian at incolumntitle{\xepersian at coltitsize}{#2}%
+}%
+}{}
+\ifthenelse{\equal{#1}{Ovalbox}}{%
+\Ovalbox{%
+\xepersian at incolumntitle{\xepersian at coltitsize}{#2}%
+}%
+}{}
+\ifthenelse{\equal{#1}{lines}}{
+\hrule
+\vspace*{5pt}
+\begin{center}
+\noindent\normalsize\textbf{#2}
+\end{center}
+\vspace*{5pt}
+\hrule
+}{}
+\end{center}
+}
+\renewcommand{\date}{%
+\longdate{\today}%
+}
+\newcommand{\authorandplace}[2]{%
+\rightline{%
+{\innerAuthorFormat #1},\space{}{\innerPlaceFormat #2}%
+}%
+\par %
+}
+\newcommand{\newsection}[1]{
+%\pdfbookmark[0]{#1}{\thepage} %bookmark para el pdf
+\renewcommand{\xepersian at section}{#1}
+}
+\newenvironment{article}[5]
+{
+\xepersian at say{Adding a new piece of article}
+\renewcommand{\xepersian at ncolumns}{#1}
+\begin{multicols}{#1}[
+\xepersian at pages{#4}
+\xepersian at innerTitle{#2}%
+\xepersian at innerSubtitle{#3}%
+][4cm]%
+\label{#5}
+\ifnum #1 > \minraggedcols
+\raggedFormat
+\fi
+}
+{~\innerTextFinalMark{}
+\end{multicols}
+}
+\newcommand{\articlesep}{%
+\setlength{\xepersian at pageneed}{16000pt}
+\setlength\xepersian at pageleft{\pagegoal}
+\addtolength\xepersian at pageleft{-\pagetotal}
+
+\xepersian at say{How much left \the\xepersian at pageleft}
+
+\ifdim \xepersian at pageneed < \xepersian at pageleft
+\xepersian at say{Not enough space}
+\else
+\xepersian at say{Adding sep line between articles}
+\vspace*{10pt plus 10pt minus 5pt}
+\hrule
+\vspace*{10pt plus 5pt minus 5pt}
+\fi
+
+}
+\newcommand{\xepersian at editorialTit}[2]{
+\setlength{\arrayrulewidth}{.1pt}
+\begin{center}
+\begin{tabular}{c}
+\noindent
+\xepersian at editorialTitle{#1}
+\vspace{2pt plus 1pt minus 1pt}
+\\
+\hline
+\vspace{2pt plus 1pt minus 1pt}
+\\
+\editorialAuthorFormat{#2}
+\end{tabular}
+\end{center}
+}
+\newenvironment{editorial}[4]
+{
+\xepersian at say{Adding a new editorial}
+\begin{multicols}{#1}[%
+\xepersian at editorialTit{#2}{#3}%
+][4cm]
+\label{#4}
+\ifnum #1 > \minraggedcols
+\raggedFormat
+\fi
+}
+{
+\end{multicols}
+}
+\newcommand{\xepersian at shortarticleTit}[2]{
+\begin{center}
+\vbox{%
+\noindent
+\xepersian at shortarticleTitle{#1}
+\vspace{4pt plus 2pt minus 2pt}
+\hrule
+\vspace{4pt plus 2pt minus 2pt}
+\xepersian at shortarticleSubtitle{#2}
+}
+\end{center}
+}
+\newenvironment{shortarticle}[4]
+{
+\xepersian at say{Adding a short article block}
+\begin{multicols}{#1}[\xepersian at shortarticleTit{#2}{#3}][4cm] %
+    \label{#4}
+\par %
+\ifnum #1 > \minraggedcols
+\raggedFormat
+\fi
+}
+{
+\end{multicols}
+}
+\newcommand{\shortarticleitem}[2]{
+\goodbreak
+\vspace{5pt plus 3pt minus 3pt}
+{\vbox{\noindent\xepersian at shortarticleItemTitle{#1}}}
+\vspace{5pt plus 3pt minus 3pt}
+{\noindent #2}\\
+}
+%    \end{macrocode}
+% \iffalse
+%</xepersian-magazine.cls>
+%<*xepersian-mathsdigitspec.sty>
+% \fi
+% \part{xepersian-mathsdigitspec.sty}
+%    \begin{macrocode}
+\NeedsTeXFormat{LaTeX2e}
+\ProvidesPackage{xepersian-mathsdigitspec}
+  [2009/04/22 v1.0.1 Unicode Persian maths digits in XeLaTeX (Author: Vafa Khalighi)]
+\@zf at mathfalse
+\def\@preamblecmds{}
+\newcommand\not at onlypreamble[1]{{%
+  \def\do##1{\ifx#1##1\else\noexpand\do\noexpand##1\fi}%
+  \xdef\@preamblecmds{\@preamblecmds}}}
+\def\gm at notprerr{ can be used only in preamble (\on at line)}
+\AtBeginDocument{%
+  \def\do#1{\noexpand\do\noexpand#1}%
+  \edef\@preamblecmds{%
+    \def\noexpand\do##1{%
+      \def##1{\noexpand\PackageError{gmutils/LaTeX}%
+        {\noexpand\string##1 \noexpand\gm at notprerr}\noexpand\@eha}}%
+    \@preamblecmds}}
+\def\nocite#1{%
+  \@bsphack{\setbox0=\hbox{\cite{#1}}}\@esphack}
+\newcommand\xepersian at PackageInfo[1]{\PackageInfo{xepersian-mathsdigitspec}{#1}}
+\newcommand\SetMathCode[4]{%
+  \XeTeXmathcode#1="\mathchar at type#2 \csname sym#3\endcsname #4\relax}
+\newcommand\SetMathCharDef[4]{%
+  \XeTeXmathchardef#1="\mathchar at type#2 \csname sym#3\endcsname #4\relax}
+\newcommand\setdigitfont[2][]{%
+  \let\glb at currsize\relax
+  \setkeys*[xepersian-mathsdigitspec]{options}{#1}%
+  \edef\@tempa{\noexpand\zf at fontspec{%
+    \XKV at rm}{#2}}\@tempa
+  \xepersian at PackageInfo{Defining the default Persian maths digits font as '#2'}
+  \DeclareSymbolFont{OPERATORS}   {EU1}{\zf at family} {m}{n}
+  \SetSymbolFont{OPERATORS}{bold}{EU1}{\zf at family} {bx}{n}
+  \DeclareMathAlphabet      {\mathit}{EU1}{\zf at family}{m}{it}
+  \DeclareSymbolFontAlphabet{\mathrm}    {OPERATORS}
+  \DeclareMathAlphabet      {\mathbf}{EU1}{\zf at family}{bx}{n}
+  \SetMathCode{`0}{\mathalpha}{OPERATORS}{"06F0}
+  \SetMathCode{`1}{\mathalpha}{OPERATORS}{"06F1}
+  \SetMathCode{`2}{\mathalpha}{OPERATORS}{"06F2}
+  \SetMathCode{`3}{\mathalpha}{OPERATORS}{"06F3}
+  \SetMathCode{`4}{\mathalpha}{OPERATORS}{"06F4}
+  \SetMathCode{`5}{\mathalpha}{OPERATORS}{"06F5}
+  \SetMathCode{`6}{\mathalpha}{OPERATORS}{"06F6}
+  \SetMathCode{`7}{\mathalpha}{OPERATORS}{"06F7}
+  \SetMathCode{`8}{\mathalpha}{OPERATORS}{"06F8}
+  \SetMathCode{`9}{\mathalpha}{OPERATORS}{"06F9}
+  \SetMathCharDef{\decimalseparator}{\mathpunct}{OPERATORS}{"066B}
+}
+\ifx\newcommand\undefined\else
+  \newcommand{\ZifferAn}{}
+\fi
+\mathchardef\ziffer at DotOri="013A
+{\ZifferAn
+ \catcode`\.=\active\gdef.{\begingroup\obeyspaces\futurelet\n\ziffer at dcheck}}
+\def\ziffer at dcheck{\ziffer at check\ZifferLeer\ziffer at DotOri}
+\def\ziffer at check#1#2{%
+  \ifx\n1\endgroup#1\else
+    \ifx\n2\endgroup#1\else
+      \ifx\n3\endgroup#1\else
+        \ifx\n4\endgroup#1\else
+          \ifx\n5\endgroup#1\else
+            \ifx\n6\endgroup#1\else
+              \ifx\n7\endgroup#1\else
+                \ifx\n8\endgroup#1\else
+                  \ifx\n9\endgroup#1\else
+                    \ifx\n0\endgroup#1\else
+                      \endgroup#2%
+                    \fi
+                  \fi
+                \fi
+              \fi
+            \fi
+          \fi
+        \fi
+      \fi
+    \fi
+  \fi}
+\mathcode`.="8000\relax
+\def\ZifferLeer{\ifx\decimalseparator\undefied .\else \decimalseparator\fi}
+%    \end{macrocode}
+% \iffalse
+%</xepersian-mathsdigitspec.sty>
+%<*xepersian-multiplechoice.sty>
+% \fi
+% \part{xepersian-multiplechoice.sty}
+%    \begin{macrocode}
+\NeedsTeXFormat{LaTeX2e}
+\ProvidesPackage{xepersian-multiplechoice}[2009/03/21 v0.1
+                    Multiple Choice Questionnaire class for Persian in XeLaTeX (Author: Vafa Khalighi)]
+\RequirePackage{pifont}
+\RequirePackage{fullpage}
+\RequirePackage{ifthen}
+\RequirePackage{calc}
+\RequirePackage{verbatim}
+\RequirePackage{fmultico}
+\def\@headerfont{\bfseries}
+\newcommand\headerfont[1]{\gdef\@headerfont{#1}}
+\def\@X{X}
+\newcommand\X[1]{\gdef\@X{#1}}
+\def\pbs#1{\let\tmp=\\#1\let\\=\tmp}
+\newcommand\makeform at nocorrection{%
+  \addtocontents{frm}{\protect\end{tabular}}
+  \@starttoc{frm}}
+\newcommand\makeform at correction{%
+  \addtocontents{frm}{\protect\end{tabular}}}
+\newcommand\makemask at nocorrection{%
+  \addtocontents{msk}{\protect\end{tabular}}
+  \@starttoc{msk}}
+\newcommand\makemask at correction{%
+  \addtocontents{msk}{\protect\end{tabular}}}
+\newlength\questionspace
+\setlength\questionspace{0pt}
+\newcommand\answerstitle[1]{\gdef\@answerstitle{#1}}
+\def\@answerstitlefont{\bfseries}
+\newcommand\answerstitlefont[1]{\gdef\@answerstitlefont{#1}}
+\def\@answernumberfont{\bfseries}
+\newcommand\answernumberfont[1]{\gdef\@answernumberfont{#1}}
+\newcounter{question}\stepcounter{question}
+\newcounter{@choice}
+\def\@initorcheck{%
+  \xdef\@choices{\the at choice}%
+  \setcounter{@choice}{1}%
+  \gdef\@arraydesc{|l||}%
+  \gdef\@headerline{}%
+  \whiledo{\not{\value{@choice}>\@choices}}{
+    \xdef\@arraydesc{\@arraydesc c|}
+    \def\@appendheader{\g at addto@macro\@headerline}
+    \@appendheader{&\protect\@headerfont}
+    \edef\@the at choice{{\alph{@choice}}}
+    \expandafter\@appendheader\@the at choice
+    \stepcounter{@choice}}%
+  \addtocontents{frm}{%
+    \protect\begin{tabular}{\@arraydesc}
+    \protect\hline
+    \@headerline\protect\\\protect\hline\protect\hline}%
+  \addtocontents{msk}{%
+    \protect\begin{tabular}{\@arraydesc}
+    \protect\hline
+    \@headerline\protect\\\protect\hline\protect\hline}%
+  \gdef\@initorcheck{%
+    \ifthenelse{\value{@choice} = \@choices}{}{%
+      \ClassError{xepersian-multiplechoice}{Question \thequestion: wrong number of choices
+        (\the at choice\space instead of \@choices)}{%
+        Questions must all have the same number of proposed answers.%
+        \MessageBreak
+        Type X <return> to quit, fix your MCQ (multiple choice question) and rerun XeLaTeX.}}}}
+\newenvironment{question}[1]{%
+  %% \begin{question}
+  \begin{minipage}{\textwidth}
+    \xdef\@formanswerline{\@questionheader}%
+    \xdef\@maskanswerline{\@questionheader}%
+    \fbox{\parbox[c]{\linewidth}{#1}}
+    \vspace\questionspace\par
+    {\@answerstitlefont\@answerstitle}
+\begin{multicols}{4}
+    \begin{list}{\@answernumberfont\alph{@choice})~}{\usecounter{@choice}}}{%
+  %% \end{question}
+    \end{list}
+\end{multicols}
+    \@initorcheck%
+    \addtocontents{frm}{\@formanswerline\protect\\\protect\hline}%
+    \addtocontents{msk}{\@maskanswerline\protect\\\protect\hline}%
+  \end{minipage}
+  \stepcounter{question}}
+\def\@truesymbol{\ding{52}~}
+\def\@falsesymbol{\ding{56}~}
+\newcommand\truesymbol[1]{\gdef\@truesymbol{#1}}
+\newcommand\falsesymbol[1]{\gdef\@falsesymbol{#1}}
+\def\@true at nocorrection{\item}
+\def\@false at nocorrection{\item}
+\def\@true at correction{\item[\@truesymbol\refstepcounter{@choice}]}
+\def\@false at correction{\item[\@falsesymbol\refstepcounter{@choice}]}
+\newcommand\true{%
+  \xdef\@formanswerline{\@formanswerline&}%
+  \xdef\@maskanswerline{\@maskanswerline&\@X}%
+  \@true}%
+\newcommand\false{%
+  \xdef\@formanswerline{\@formanswerline&}%
+  \xdef\@maskanswerline{\@maskanswerline&}%
+  \@false}%
+\def\@correctionstyle{\itshape}
+\newcommand\correctionstyle[1]{\gdef\@correctionstyle{#1}}
+\newenvironment{@correction}{\@correctionstyle}{}
+ \def\@questionheader{???????? \thequestion}
+  \answerstitle{?????????????? ????????:}
+\DeclareOption{nocorrection}{%
+  \let\@true\@true at nocorrection
+  \let\@false\@false at nocorrection
+  \let\correction\comment
+  \let\endcorrection\endcomment
+  \def\makeform{\makeform at nocorrection}
+  \def\makemask{\makemask at nocorrection}}
+\DeclareOption{correction}{%
+  \let\@true\@true at correction
+  \let\@false\@false at correction
+  \let\correction\@correction
+  \let\endcorrection\end at correction
+  \def\makeform{\makeform at correction}
+  \def\makemask{\makemask at correction}}
+\ExecuteOptions{nocorrection}
+\newcommand\questiontitle[1]{\gdef\@questiontitle{#1}}
+\def\@questiontitlefont{\bfseries}
+\newcommand\questiontitlefont[1]{\gdef\@questiontitlefont{#1}}
+\newlength\questiontitlespace
+\setlength\questiontitlespace{5pt}
+\newlength\questionsepspace
+\setlength\questionsepspace{20pt}
+\gdef\@questionsepspace{0pt}
+\let\old at question\question
+\let\old at endquestion\endquestion
+\renewenvironment{question}[1]{%
+  %% \begin{question}
+  \vspace\@questionsepspace
+  \fbox{\parbox[c]{0.25\linewidth}{\@questiontitlefont\@questiontitle}}
+  \nopagebreak\vspace\questiontitlespace\par
+  \old at question{#1}}{%
+  %% \end{question}
+  \old at endquestion
+  \gdef\@questionsepspace{\questionsepspace}}
+ \questiontitle{???????? \thequestion:}
+\ProcessOptions
+%    \end{macrocode}
+% \iffalse
+%</xepersian-multiplechoice.sty>
+%<*xepersian-persiancal.sty>
+% \fi
+% \part{xepersian-persiancal.sty}
+%    \begin{macrocode}
+\NeedsTeXFormat{LaTeX2e}
+\ProvidesPackage{xepersian-persiancal}
+
+\newif\ifXePersian at leap \newif\ifXePersian at kabiseh
+\newcount\XePersian at i  \newcount\XePersian at y  \newcount\XePersian at m  \newcount\XePersian at d
+\newcount\XePersian at latini    \newcount\XePersian at persiani
+\newcount\XePersian at latinii   \newcount\XePersian at persianii
+\newcount\XePersian at latiniii  \newcount\XePersian at persianiii
+\newcount\XePersian at latiniv   \newcount\XePersian at persianiv
+\newcount\XePersian at latinv    \newcount\XePersian at persianv
+\newcount\XePersian at latinvi   \newcount\XePersian at persianvi
+\newcount\XePersian at latinvii  \newcount\XePersian at persianvii
+\newcount\XePersian at latinviii \newcount\XePersian at persianviii
+\newcount\XePersian at latinix   \newcount\XePersian at persianix
+\newcount\XePersian at latinx    \newcount\XePersian at persianx
+\newcount\XePersian at latinxi   \newcount\XePersian at persianxi
+\newcount\XePersian at latinxii  \newcount\XePersian at persianxii
+                       \newcount\XePersian at persianxiii
+
+\newcount\XePersian at temp
+\newcount\XePersian at temptwo
+\newcount\XePersian at tempthree
+\newcount\XePersian at yModHundred
+\newcount\XePersian at thirtytwo
+\newcount\XePersian at dn
+\newcount\XePersian at sn
+\newcount\XePersian at mminusone
+
+\def\persiantoday{%
+\XePersian at y=\year \XePersian at m=\month \XePersian at d=\day
+%
+\XePersian at temp=\XePersian at y
+\divide\XePersian at temp by 100\relax
+\multiply\XePersian at temp by 100\relax
+\XePersian at yModHundred=\XePersian at y
+\advance\XePersian at yModHundred by -\XePersian at temp\relax
+%
+\ifodd\XePersian at yModHundred
+   \XePersian at leapfalse
+\else
+   \XePersian at temp=\XePersian at yModHundred
+   \divide\XePersian at temp by 2\relax
+   \ifodd\XePersian at temp\XePersian at leapfalse
+   \else
+      \ifnum\XePersian at yModHundred=0%
+         \XePersian at temp=\XePersian at y
+         \divide\XePersian at temp by 400\relax
+         \multiply\XePersian at temp by 400\relax
+         \ifnum\XePersian at y=\XePersian at temp\XePersian at leaptrue\else\XePersian at leapfalse\fi
+      \else\XePersian at leaptrue
+      \fi
+   \fi
+\fi
+%
+\XePersian at latini=31\relax
+\ifXePersian at leap
+  \XePersian at latinii = 29\relax
+\else
+  \XePersian at latinii = 28\relax
+\fi
+\XePersian at latiniii = 31\relax
+\XePersian at latiniv  = 30\relax
+\XePersian at latinv = 31\relax
+\XePersian at latinvi = 30\relax
+\XePersian at latinvii = 31\relax
+\XePersian at latinviii = 31\relax
+\XePersian at latinix = 30\relax
+\XePersian at latinx = 31\relax
+\XePersian at latinxi = 30\relax
+\XePersian at latinxii = 31\relax
+%
+\XePersian at thirtytwo=32\relax
+%
+\XePersian at temp=\XePersian at y
+\advance\XePersian at temp by -17\relax
+\XePersian at temptwo=\XePersian at temp
+\divide\XePersian at temptwo by 33\relax
+\multiply\XePersian at temptwo by 33\relax
+\advance\XePersian at temp by -\XePersian at temptwo
+\ifnum\XePersian at temp=\XePersian at thirtytwo\XePersian at kabisehfalse
+\else
+   \XePersian at temptwo=\XePersian at temp
+   \divide\XePersian at temptwo by 4\relax
+   \multiply\XePersian at temptwo by 4\relax
+   \advance\XePersian at temp by -\XePersian at temptwo
+   \ifnum\XePersian at temp=\z@\XePersian at kabisehtrue\else\XePersian at kabisehfalse\fi
+\fi
+%
+% In fact persiani is equal to the Leap years from a fixed year to the last
+% year minus the Kabise years from a fixed year to the last year plus a const.
+%
+\XePersian at tempthree=\XePersian at y                 % Number of Leap years
+\advance\XePersian at tempthree by -1
+\XePersian at temp=\XePersian at tempthree              % T := (MY-1) div 4
+\divide\XePersian at temp by 4\relax
+\XePersian at temptwo=\XePersian at tempthree           % T := T - ((MY-1) div 100)
+\divide\XePersian at temptwo by 100\relax
+\advance\XePersian at temp by -\XePersian at temptwo
+\XePersian at temptwo=\XePersian at tempthree           % T := T + ((MY-1) div 400)
+\divide\XePersian at temptwo by 400\relax
+\advance\XePersian at temp by \XePersian at temptwo
+\advance\XePersian at tempthree by -611       % Number of Kabise years
+\XePersian at temptwo=\XePersian at tempthree           % T := T - ((SY+10) div 33) * 8
+\divide\XePersian at temptwo by 33\relax
+\multiply\XePersian at temptwo by 8\relax
+\advance\XePersian at temp by -\XePersian at temptwo
+\XePersian at temptwo=\XePersian at tempthree           %
+\divide\XePersian at temptwo by 33\relax
+\multiply\XePersian at temptwo by 33\relax
+\advance\XePersian at tempthree by -\XePersian at temptwo
+\ifnum\XePersian at tempthree=32\advance\XePersian at temp by 1\fi % if (SY+10) mod 33=32 then Inc(T);
+\divide\XePersian at tempthree by 4\relax     % T := T - ((SY+10) mod 33) div 4
+\advance\XePersian at temp by -\XePersian at tempthree
+\advance\XePersian at temp by -137            % T := T - 137  Adjust the value
+\XePersian at persiani=31
+\advance\XePersian at persiani by -\XePersian at temp                 % now 31 - T is the persiani
+%
+\XePersian at persianii = 30\relax
+\ifXePersian at kabiseh
+  \XePersian at persianiii = 30\relax
+\else
+  \XePersian at persianiii = 29\relax
+\fi
+\XePersian at persianiv  = 31\relax
+\XePersian at persianv   = 31\relax
+\XePersian at persianvi  = 31\relax
+\XePersian at persianvii = 31\relax
+\XePersian at persianviii= 31\relax
+\XePersian at persianix  = 31\relax
+\XePersian at persianx   = 30\relax
+\XePersian at persianxi  = 30\relax
+\XePersian at persianxii = 30\relax
+\XePersian at persianxiii= 30\relax
+%
+\XePersian at dn= 0\relax
+\XePersian at sn= 0\relax
+\XePersian at mminusone=\XePersian at m
+\advance\XePersian at mminusone by -1\relax
+%
+\XePersian at i=0\relax
+\ifnum\XePersian at i < \XePersian at mminusone
+\loop
+\advance \XePersian at i by 1\relax
+\advance\XePersian at dn by \csname XePersian at latin\romannumeral\the\XePersian at i\endcsname
+\ifnum\XePersian at i<\XePersian at mminusone \repeat
+\fi
+\advance \XePersian at dn by \XePersian at d
+%
+\XePersian at i=1\relax
+\XePersian at sn = \XePersian at persiani
+\ifnum \XePersian at sn<\XePersian at dn
+\loop
+\advance \XePersian at i by 1\relax
+\advance\XePersian at sn by \csname XePersian at persian\romannumeral\the\XePersian at i\endcsname
+\ifnum \XePersian at sn<\XePersian at dn \repeat
+\fi
+\ifnum \XePersian at i < 4
+   \XePersian at m = 9 \advance\XePersian at m by \XePersian at i
+   \advance \XePersian at y by -622\relax
+\else
+   \XePersian at m = \XePersian at i \advance \XePersian at m by -3\relax
+   \advance \XePersian at y by -621\relax
+\fi
+\advance\XePersian at sn by -\csname XePersian at persian\romannumeral\the\XePersian at i%
+\endcsname
+\ifnum\XePersian at i = 1
+  \XePersian at d = \XePersian at dn \advance \XePersian at d by 30 \advance\XePersian at d by -\XePersian at persiani
+\else
+  \XePersian at d = \XePersian at dn \advance \XePersian at d by -\XePersian at sn
+\fi
+\beginL\number\XePersian at d\endL\space%
+\persianmonth{\XePersian at m}\space\beginL\number\XePersian at y\endL%
+}
+\def\persianmonth#1{\ifcase#1\or ??????????????\or 
+????????????????\or 
+??????????\or ??????\or 
+??????????\or 
+????????????\or ??????\or 
+????????\or ??????\or 
+????\or ????????\or 
+??????????\fi}
+%    \end{macrocode}
+% \iffalse
+%</xepersian-persiancal.sty>
+%<*xepersian-thesis.cls>
+% \fi
+% \part{xepersian-thesis.cls}
+%    \begin{macrocode}
+\NeedsTeXFormat{LaTeX2e}
+\ProvidesClass{xepersian-thesis}
+              [2009/01/05 v0.1
+ Persian thesis document class in XeLaTeX]
+\DeclareOption*{\PassOptionsToClass{\CurrentOption}{report}}
+\ProcessOptions
+\LoadClass{report}
+\def\university#1{\gdef\@university{#1}}
+\def\department#1{\gdef\@department{#1}}
+\def\degree#1{\gdef\@degree{#1}}
+\def\thesisdate#1{\gdef\@thesisdate{#1}}
+\def\supervisor#1{\gdef\@supervisor{#1}}
+\def\city#1{\gdef\@city{#1}}
+
+\def\latintitle#1{\gdef\@latintitle{#1}}
+\def\latinauthor#1{\gdef\@latinauthor{#1}}
+\def\latindegree#1{\gdef\@latindegree{#1}}
+\def\latindepartment#1{\gdef\@latindepartment{#1}}
+\def\latinthesisdate#1{\gdef\@latinthesisdate{#1}}
+\def\latinsupervisor#1{\gdef\@latinsupervisor{#1}}
+\def\latincity#1{\gdef\@latincity{#1}}
+\def\latinuniversity#1{\gdef\@latinuniversity{#1}}
+
+\def\maketitle{\begin{titlepage}
+{\includegraphics{logo}}
+\vskip 1.5cm
+{\Huge\bf \@title}\par
+\vskip 1cm
+{\large%
+  \by}\par
+{\Large\bf \@author}\par
+\vskip 5mm
+{\large\bf\writtenfor
+\par
+\@degree}
+\par
+\vskip 1cm
+{\large
+  \undersupervision\par
+\Large\bf \@supervisor}
+\par
+\vskip 1cm
+{\large \@thesisdate}
+\par
+\vskip 1cm
+{\large\bf\departmentof\space\@department}
+\par
+{\large\bf\universityof\space\@university \par\@city}
+\vfill
+\end{titlepage}%
+}
+
+\def\abstractpage{\newpage
+\thispagestyle{empty}
+\vskip 15mm
+\begin{center}{\large{\bf \@title} \\}
+\end{center}
+\par
+\begin{abstract}}
+\def\endabstractpage{\end{abstract}
+\newpage
+}
+
+\def\latinabstract{\newpage
+\thispagestyle{empty}
+\vskip 15mm
+\begin{center}{\Large\bf \@latintitle \\[5mm]}
+{\bf Abstract}
+\end{center}
+\vspace{5mm}}
+
+\def\endlatinabstract{\newpage}
+
+\def\acknowledgementpage{\newpage
+\thispagestyle{empty}
+\centerline{\Large \bf\acknowledgementname} 
+\vspace{1cm}
+\par\noindent}
+\def\endacknowledgementpage{\newpage}
+
+\def\titlepage{\newpage\centering
+  \thispagestyle{empty}
+  \parindent 0pt \parskip 10pt plus 1fil minus 1fil
+  \def\baselinestretch{1}\@normalsize\vbox to \vsize\bgroup\vbox to 9in\bgroup}
+\def\endtitlepage{\par\kern 0pt\egroup\vss\egroup\newpage}
+
+\def\signature#1#2{\par\noindent#1\dotfill\null\\*
+  {\raggedright #2\par}}
+\def\abstract{\subsection*{\abstractname}\small\def\baselinestretch{1}
+\@normalsize}
+\def\endabstract{\par}
+
+
+
+\pagenumbering{harfi}
+\let\ol at chapter\@chapter
+\def\@chapter{%
+  \ifnum\c at chapter=0 \pagenumbering{arabic}\setcounter{page}{1}\fi
+  \ol at chapter}
+
+
+
+\def\keywords#1{\par \vspace{5mm}
+{\textbf{????????????????? ??????????:}} {\textit{ #1}}}
+
+\def\latinkeywords#1{\par \vspace{5mm}
+\noindent {\textbf{Keywords:}} {\textit{ #1}}}
+
+\font\titlefont=cmssbx10 scaled 2074
+\font\supervisorfont=cmbxti10
+\def\makelatintitle{\begin{titlepage}
+{\includegraphics{logo}}
+\vskip 1.5cm
+\addtolength{\baselineskip}{5mm}
+{\titlefont \@latintitle} \par
+\addtolength{\baselineskip}{-5mm}
+\vskip 1cm
+{\bf\latinby}\par
+{\Large\bf \@latinauthor}\par
+\vskip 5mm
+{\latinwrittenfor\par
+\large\@latindegree}
+\par
+\vskip 1cm
+Under supervision of \\
+{\supervisorfont\@latinsupervisor}
+\par
+\vskip 1cm
+{\@latinthesisdate}
+\par
+\vskip 1cm
+\large\bf
+\@latindepartment\space Department
+\par
+\@latinuniversity \par\@latincity
+\vfill
+\end{titlepage}%
+}
+
+
+\def\acknowledgementname{??????????????}
+\def\by{????????}
+\def\writtenfor{  ???????????? ?????????? ?????? ???? ?????????? ???????? ???? ?????????????? ???????? ???????????? ??????????}
+\def\undersupervision{?????? ??????}
+\def\departmentof{????????????????}
+\def\universityof{??????????????}
+\def\latinby{by}
+\def\latinwrittenfor{Submitted in Partial Fulfillment\\ of the Requirements\\ for the Degree of}
+\def\latinundersupervision{Under supervision of}
+%    \end{macrocode}
+% \iffalse
+%</xepersian-thesis.cls>
+%<*xepersian-thesis-xepersian.def>
+% \fi
+% \part{xepersian-thesis-xepersian.def}
+%    \begin{macrocode}
+\renewcommand \thepart {\@tartibi\c at part}
+%to make appendix numbering persian
+\renewcommand\appendix{\par
+  \setcounter{chapter}{0}%
+  \setcounter{section}{0}%
+  \gdef\@chapapp{\appendixname}%
+  \gdef\thechapter{\@harfi\c at chapter}
+}%end appendix
+%    \end{macrocode}
+% \iffalse
+%</xepersian-thesis-xepersian.def>
+%<*acm-fa.bst>
+% \fi
+% \part{acm-fa.bst}
+%    \begin{macrocode}
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+%% Bib. style "acm-fa", Persian (farsi)  version of acm.bst
+%%
+%% by: Mahmood Amintoosi and Mostafa Vahedi
+%% For XePersian, a Persian Typsetting Package in XeTeX, Developed by:
+%% Vafa Khalighi, Mehdi Omidali and Mostafa Vahedi 
+%% 2009/02/12
+%% It may be distributed and/or modified under the
+%% conditions of the LaTeX Project Public License, either this version
+%% of this license or (at your option) any later version.
+%%
+%% NOTE: Its output for English references may has a bit difference with acm.bst, for pure English texts please use acm.bst
+%%
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+%% Original Copyright of acm.bst
+% ACM Transactions bibliography style (24-Jan-88 version)
+%    A lot like abbrv.bst, but names come out "Last, initials", and in \sc.
+%    Some dates are parenthesized.
+
+% History of acm-fa.bst
+% 2009/02/12, The initial release was a combination of acm.bst and plain-fa.bst
+%		\textsc is used here instead of \sc.
+%		
+	
+ENTRY
+  { address
+    author
+    booktitle
+    chapter
+    edition
+    editor
+    howpublished
+    institution
+    journal
+    key
+	language
+    month
+    note
+    number
+    organization
+    pages
+    publisher
+    school
+    series
+    title
+	translator
+    type
+    volume
+    year
+  }
+  {}
+  { label }
+
+INTEGERS { output.state before.all mid.sentence after.sentence after.block }
+STRINGS {bbl.and bbl.etal bbl.editors bbl.editor bbl.edition bbl.volume bbl.of bbl.number
+		 bbl.in bbl.pages bbl.page bbl.chapter bbl.series bbl.techrep bbl.mthesis bbl.phdthesis 
+		 bbl.translator}% bbl.formatnames}
+FUNCTION {is.print.banners.to.terminal} { #1 }
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+%% FILE VERSION AND BANNER %%
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+
+FUNCTION{bst.file.version} { "0.3" }
+FUNCTION{bst.file.date} { "2009/02/12" }
+FUNCTION{bst.file.website} { "http://parsilatex.org/" }
+FUNCTION{bst.file.authors} {"M.Amintoosi and M.Vahedi" }
+
+FUNCTION {banner.message}
+{ is.print.banners.to.terminal
+     { "-- acm-fa.bst version" " " * bst.file.version *
+       " (" * bst.file.date * ") " * %"by " * bst.file.authors *
+       top$
+       "-- This is a BibTeX style for XePersian: " bst.file.website *
+       %top$
+       %"-- See the " quote$ * "xepersian_bibtex_userguide.pdf" * quote$ * " manual for usage information." *
+       top$
+     }
+     { skip$ }
+   if$
+}
+
+FUNCTION {completed.message}
+{ is.print.banners.to.terminal
+     { ""
+       top$
+       "Done."
+       top$
+     }
+     { skip$ }
+   if$
+}
+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+%% Persian Functions	   %%
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+
+FUNCTION {fa.isPersianLanguage}
+{
+  language missing$
+    {#0}
+    {language "l" change.case$ "persian" =}
+  if$
+}
+
+FUNCTION {keywords.fa}
+{
+  " ?? " 			'bbl.and 		:=
+  " ?? ????????????" 		'bbl.etal 		:=
+  " ???????????????????? " 	'bbl.editors 	:=
+  " ??????????????????? " 		'bbl.editor 	:=
+  " ???????????? " 		'bbl.edition    :=
+  " ?????? " 			'bbl.volume		:=
+  " ???? " 			'bbl.of			:=
+  " ?????????? " 			'bbl.number		:=
+  " ???? " 			'bbl.in 		:=
+  " ?????????? " 		'bbl.pages 		:=
+  " ??." 			'bbl.page 		:=
+  " ?????? " 			'bbl.chapter	:=
+  " ?????? "				'bbl.series		:=
+  " ?????????? ?????? ????????????"	'bbl.techrep	:=
+  " ????????????????????? ???????????????????????????" 'bbl.mthesis 	:=
+  " ????????????????????? ??????????" 		'bbl.phdthesis	:=   
+  " ??????????????? "					'bbl.translator :=  
+}
+
+FUNCTION {keywords.en}
+{
+  " and " 			'bbl.and 		:=
+  " et~al." 		'bbl.etal 		:=
+  " Eds." 			'bbl.editors 	:=
+  " Ed." 			'bbl.editor 	:=
+  " Ed." 			'bbl.edition    :=
+  " Vol." 			'bbl.volume		:=
+  " of " 			'bbl.of			:=
+  " No." 			'bbl.number		:=
+  " In " 			'bbl.in 		:=
+  " pp." 			'bbl.pages 		:=
+  " p." 			'bbl.page 		:=
+  " Ch." 			'bbl.chapter	:=
+  " Ser."			'bbl.series		:=
+  " Tech. Rep."		'bbl.techrep	:=
+  " Master's thesis" 'bbl.mthesis 	:=
+  " Ph.D. thesis"  'bbl.phdthesis	:=   
+  " Translator "	'bbl.translator :=
+  %"{vv~}{ll}{, jj}{, f.}"   'bbl.formatnames :=
+}
+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+%% End of Persian Functions %%
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+
+FUNCTION {init.state.consts}
+{ #0 'before.all :=
+  #1 'mid.sentence :=
+  #2 'after.sentence :=
+  #3 'after.block :=
+}
+
+STRINGS { s t }
+
+FUNCTION {output.nonnull}
+{ 's :=
+  output.state mid.sentence =
+    { ", " * write$ }
+    { output.state after.block =
+	{ add.period$ write$
+	  newline$
+	  "\newblock " write$
+	}
+	{ output.state before.all =
+	    'write$
+	    { add.period$ " " * write$ }
+	  if$
+	}
+      if$
+      mid.sentence 'output.state :=
+    }
+  if$
+  s
+}
+
+FUNCTION {output}
+{ duplicate$ empty$
+    'pop$
+    'output.nonnull
+  if$
+}
+
+FUNCTION {output.check}
+{ 't :=
+  duplicate$ empty$
+    { pop$ "empty " t * " in " * cite$ * warning$ }
+    'output.nonnull
+  if$
+}
+
+FUNCTION {output.bibitem}
+{ 
+  newline$
+  fa.isPersianLanguage
+    { keywords.fa
+	  "\Persian" write$
+      newline$ }
+    { keywords.en
+	  "\Latin" write$
+      newline$ }
+  if$
+  "\bibitem{" write$
+  cite$ write$
+  "}" write$
+  newline$
+  ""
+  before.all 'output.state :=
+}
+
+FUNCTION {fin.entry}
+{ add.period$
+  write$
+  newline$
+}
+
+FUNCTION {new.block}
+{ output.state before.all =
+    'skip$
+    { after.block 'output.state := }
+  if$
+}
+
+FUNCTION {new.sentence}
+{ output.state after.block =
+    'skip$
+    { output.state before.all =
+	'skip$
+	{ after.sentence 'output.state := }
+      if$
+    }
+  if$
+}
+
+FUNCTION {not}
+{   { #0 }
+    { #1 }
+  if$
+}
+
+FUNCTION {and}
+{   'skip$
+    { pop$ #0 }
+  if$
+}
+
+FUNCTION {or}
+{   { pop$ #1 }
+    'skip$
+  if$
+}
+
+FUNCTION {new.block.checka}
+{ empty$
+    'skip$
+    'new.block
+  if$
+}
+
+FUNCTION {new.block.checkb}
+{ empty$
+  swap$ empty$
+  and
+    'skip$
+    'new.block
+  if$
+}
+
+FUNCTION {new.sentence.checka}
+{ empty$
+    'skip$
+    'new.sentence
+  if$
+}
+
+FUNCTION {new.sentence.checkb}
+{ empty$
+  swap$ empty$
+  and
+    'skip$
+    'new.sentence
+  if$
+}
+
+
+FUNCTION {field.or.null}
+{ duplicate$ empty$
+    { pop$ "" }
+    'skip$
+  if$
+}
+
+FUNCTION {emphasize}
+{ duplicate$ empty$
+    { pop$ "" }
+    { "{\em " swap$ * "}" * }
+  if$
+}
+
+FUNCTION {emphasizeic}
+{ duplicate$ empty$
+    { pop$ "" }
+    { "{\em " swap$ * "\/}" * }
+  if$
+}
+
+FUNCTION {scapify}
+{ duplicate$ empty$
+    { pop$ "" }
+    { "\textsc{ " swap$ * "}" * }
+  if$
+}
+
+INTEGERS { nameptr namesleft numnames }
+
+FUNCTION {format.names}
+{ 's :=
+  #1 'nameptr :=
+  s num.names$ 'numnames :=
+  numnames 'namesleft :=
+    { namesleft #0 > }
+    {fa.isPersianLanguage 
+        { s nameptr "{vv~}{ll}{, jj}{, ff}" format.name$ 't :=}
+        { s nameptr "{vv~}{ll}{, jj}{, f.}" format.name$ 't :=}
+      if$  
+     nameptr #1 >
+	{ namesleft #1 >
+	    { ", " * t * }
+	    { t "others" =
+		{ ","  bbl.etal * * }
+		{ ","  bbl.and  * * t * }
+	      if$
+	    }
+	  if$
+	}
+	't
+      if$
+      nameptr #1 + 'nameptr :=
+      namesleft #1 - 'namesleft :=
+    }
+  while$
+}
+
+% For names inside entries (e.g., editors of an "In ...");
+% this is exactly ABBRV.BST's `format.names' function.
+FUNCTION {format.innames}
+{ 's :=
+  #1 'nameptr :=
+  s num.names$ 'numnames :=
+  numnames 'namesleft :=
+    { namesleft #0 > }
+    {fa.isPersianLanguage 
+        {s nameptr "{ff}{vv~}{ll}{, jj}" format.name$ 't :=}
+        {s nameptr "{f.~}{vv~}{ll}{, jj}" format.name$ 't :=}
+      if$
+       nameptr #1 >
+	{ namesleft #1 >
+	    { ", " * t * }
+	    { numnames #2 >
+		{ "," * }
+		'skip$
+	      if$
+	      t "others" =
+		{ bbl.etal * }
+		{ bbl.and * t * }
+	      if$
+	    }
+	  if$
+	}
+	't
+      if$
+      nameptr #1 + 'nameptr :=
+      namesleft #1 - 'namesleft :=
+    }
+  while$
+}
+
+FUNCTION {format.authors}
+{ author empty$
+    { "" }
+    { author format.names  scapify}
+  if$
+}
+
+FUNCTION {format.editors}
+{ editor empty$
+    { "" }
+    { fa.isPersianLanguage
+	    {
+		editor num.names$ #1 >
+			{bbl.editors editor format.names * }
+			{bbl.editor editor format.names * }
+		if$
+		}
+		{
+ 		editor format.names scapify
+		editor num.names$ #1 >
+			{ ", " bbl.editors * *}
+			{ ", " bbl.editor * *}
+		if$
+		}
+	  if$	
+    }
+  if$
+}
+
+FUNCTION {format.ineditors}
+{ editor empty$
+    { "" }
+    { editor format.innames
+      editor num.names$ #1 >
+	{ ", " * bbl.editors *}
+	{ ", " * bbl.editor *}
+      if$
+    }
+  if$
+}
+
+FUNCTION {format.translators}
+{ translator empty$
+    { "" }
+    { fa.isPersianLanguage
+	    {
+		bbl.translator translator format.names *
+		}
+		{
+ 		translator format.names
+		", " bbl.translator * *
+		}
+	  if$	
+    }
+  if$
+}
+
+FUNCTION {format.title}
+{ title empty$
+    { "" }
+    { title "t" change.case$ }
+  if$
+}
+
+FUNCTION {n.dashify}
+{ 't :=
+  ""
+    { t empty$ not }
+    { t #1 #1 substring$ "-" =
+	{ t #1 #2 substring$ "--" = not
+	    { "--" *
+	      t #2 global.max$ substring$ 't :=
+	    }
+	    {   { t #1 #1 substring$ "-" = }
+		{ "-" *
+		  t #2 global.max$ substring$ 't :=
+		}
+	      while$
+	    }
+	  if$
+	}
+	{ t #1 #1 substring$ *
+	  t #2 global.max$ substring$ 't :=
+	}
+      if$
+    }
+  while$
+}
+
+FUNCTION {format.date}
+{ year empty$
+    { month empty$
+	{ "" }
+	{ "there's a month but no year in " cite$ * warning$
+	  month
+	}
+      if$
+    }
+    { month empty$
+	'year
+	{ month " " * year * }
+      if$
+    }
+  if$
+}
+
+FUNCTION {format.btitle}
+{ title emphasize
+}
+
+FUNCTION {tie.or.space.connect}
+{ duplicate$ text.length$ #3 <
+    { "~" }
+    { " " }
+  if$
+  swap$ * *
+}
+
+FUNCTION {either.or.check}
+{ empty$
+    'pop$
+    { "can't use both " swap$ * " fields in " * cite$ * warning$ }
+  if$
+}
+
+FUNCTION {format.bvolume}
+{ volume empty$
+    { "" }
+    { "volume" volume tie.or.space.connect
+      series empty$
+	'skip$
+	{ " of " * series emphasize * }
+      if$
+      "volume and number" number either.or.check
+    }
+  if$
+}
+
+FUNCTION {format.number.series}
+{ volume empty$
+    { number empty$
+	{ series field.or.null }
+	{ output.state mid.sentence =
+	    { bbl.number }
+	    { bbl.number "t" change.case$ }
+	  if$
+	  number tie.or.space.connect
+	  series empty$
+	    { "there's a number but no series in " cite$ * warning$ }
+	    { bbl.in * series * }
+	  if$
+	}
+      if$
+    }
+    { "" }
+  if$
+}
+
+FUNCTION {format.edition}
+{ edition empty$
+    { "" }
+    { fa.isPersianLanguage
+	    {
+		   bbl.edition edition * 
+		}
+		{
+	      output.state mid.sentence =
+	       { edition "l" change.case$ bbl.edition * }
+	       { edition "t" change.case$ bbl.edition * }
+          if$
+		}
+	  if$	
+    }
+  if$
+}
+
+FUNCTION {format.pages}
+{ pages empty$
+    { "" }
+    { pages n.dashify }
+  if$
+}
+
+INTEGERS { multiresult }
+
+FUNCTION {multi.page.check}
+{ 't :=
+  #0 'multiresult :=
+    { multiresult not
+      t empty$ not
+      and
+    }
+    { t #1 #1 substring$
+      duplicate$ "-" =
+      swap$ duplicate$ "," =
+      swap$ "+" =
+      or or
+	{ #1 'multiresult := }
+	{ t #2 global.max$ substring$ 't := }
+      if$
+    }
+  while$
+  multiresult
+}
+
+FUNCTION {format.pp.pages}
+{ pages empty$
+    { "" }
+    { pages multi.page.check
+	   { bbl.pages pages n.dashify tie.or.space.connect }
+	   { bbl.page pages tie.or.space.connect }
+      if$
+    }
+  if$
+}
+
+FUNCTION {format.journal.vol.num.date}
+{ journal empty$
+    { "empty journal in " cite$ * warning$
+      ""
+    }
+    { journal
+      volume empty$
+	'skip$
+	{ " " * volume * }
+      if$
+      number empty$
+	'emphasizeic
+	{ emphasize ", " * number * }
+      if$
+      year empty$
+	{ "empty year in " cite$ * warning$ }
+	{ " (" * format.date * ")" * }
+      if$
+    }
+  if$
+}
+
+FUNCTION {format.chapter.pages}
+{ chapter empty$
+    'format.pp.pages
+    { type empty$
+	{ bbl.chapter }
+	{ type "l" change.case$ }
+      if$
+      chapter tie.or.space.connect
+      pages empty$
+	'skip$
+	{ ", " * format.pp.pages * }
+      if$
+    }
+  if$
+}
+
+FUNCTION {format.in.ed.booktitle}
+{ 
+  booktitle empty$
+    { "" }
+    {bbl.in booktitle emphasize *
+      editor empty$
+	'skip$
+	{ ", " * format.ineditors * }
+      if$
+    }
+  if$
+}
+
+% The proceedings title (it's on the stack) gets an (address, date) appended
+FUNCTION {format.proc.date}
+{ duplicate$ empty$
+    { pop$ "" }
+    { year empty$
+	{ "empty year in " cite$ * warning$
+	  address empty$
+	    'emphasize
+	    { emphasizeic
+	      " (" * address * ")" *
+	    }
+	  if$
+	}
+	{ emphasizeic
+	  " (" *
+	  address empty$
+	    'skip$
+	    { address * ", " * }
+	  if$
+	  format.date *
+	  ")" *
+	}
+      if$
+    }
+  if$
+}
+
+FUNCTION {format.in.proc.date}
+{ booktitle empty$
+    { "" }
+    { bbl.in booktitle format.proc.date * }
+  if$
+}
+FUNCTION {empty.misc.check}
+{ author empty$ title empty$ howpublished empty$
+  month empty$ year empty$ note empty$
+  and and and and and
+  key empty$ not and
+    { "all relevant fields are empty in " cite$ * warning$ }
+    'skip$
+  if$
+}
+
+FUNCTION {format.thesis.type}
+{ type empty$
+    'skip$
+    { pop$
+      type "t" change.case$
+    }
+  if$
+}
+
+FUNCTION {format.tr.number}
+{ type empty$
+    { bbl.techrep }
+    'type
+  if$
+  number empty$
+    { "t" change.case$ }
+    { number tie.or.space.connect }
+  if$
+}
+
+FUNCTION {format.article.crossref}
+{ key empty$
+    { journal empty$
+	{ "need key or journal for " cite$ * " to crossref " * crossref *
+	  warning$
+	  ""
+	}
+	{ bbl.in "{\em "  * journal * "\/}" * }
+      if$
+    }
+    { bbl.in key * }
+  if$
+  " \cite{" * crossref * "}" *
+}
+
+FUNCTION {format.crossref.editor}
+{ editor #1 "{vv~}{ll}" format.name$
+  editor num.names$ duplicate$  #2 >
+    { pop$ bbl.etal * }
+    { #2 < 'skip$
+	    { editor #2 "{ff }{vv }{ll}{ jj}" format.name$ "others" =
+	      { bbl.etal * }
+	      { bbl.and * editor #2 "{vv~}{ll}" format.name$ * }
+	    if$
+	    }			
+    if$
+    }
+  if$
+}
+
+FUNCTION {format.book.crossref}
+{ volume empty$
+    { "empty volume in " cite$ * "'s crossref of " * crossref * warning$
+      bbl.in
+    }
+    { bbl.volume volume tie.or.space.connect
+      bbl.of *
+    }
+  if$
+  editor empty$
+  editor field.or.null author field.or.null =
+  or
+    { key empty$
+	{ series empty$
+	    { "need editor, key, or series for " cite$ * " to crossref " *
+	      crossref * warning$
+	      "" *
+	    }
+	    { "{\em " * series * "\/}" * }
+	  if$
+	}
+	{ key * }
+      if$
+    }
+    { format.crossref.editor * }
+  if$
+  " \cite{" * crossref * "}" *
+}
+
+FUNCTION {format.incoll.inproc.crossref}
+{ editor empty$
+  editor field.or.null author field.or.null =
+  or
+    { key empty$
+	{ booktitle empty$
+	    { "need editor, key, or booktitle for " cite$ * " to crossref " *
+	      crossref * warning$
+	      ""
+	    }
+	    { bbl.in " {\em " * booktitle * "\/}" * }
+	  if$
+	}
+	{ bbl.in key * }
+      if$
+    }
+    { bbl.in format.crossref.editor * }
+  if$
+  " \cite{" * crossref * "}" *
+}
+
+FUNCTION {article}
+{ output.bibitem
+  format.authors "author" output.check
+  new.block
+  format.title "title" output.check
+  new.block
+  crossref missing$
+    { format.journal.vol.num.date output
+      format.pages output
+    }
+    { format.article.crossref output.nonnull
+      format.pp.pages output
+    }
+  if$
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {book}
+{ output.bibitem
+  fa.isPersianLanguage
+  {
+	format.authors  output
+    new.block
+    format.btitle "title" output.check
+    format.edition output
+	new.block
+    format.translators output
+	format.editors  output
+  }
+  { author empty$
+      { format.editors "author and editor" output.check }
+      { format.authors output.nonnull
+        crossref missing$
+	      { "author and editor" editor either.or.check }
+	      'skip$
+        if$
+      }
+    if$
+    new.block
+    format.btitle "title" output.check
+    format.edition output
+  }  
+  if$
+  crossref missing$
+    { format.bvolume output
+      new.block
+      format.number.series output
+      new.sentence
+      publisher "publisher" output.check
+      address output
+    }
+    { new.block
+      format.book.crossref output.nonnull
+    }
+  if$
+  format.date "year" output.check
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {booklet}
+{ output.bibitem
+  format.authors output
+  new.block
+  format.title "title" output.check
+  howpublished address new.block.checkb
+  howpublished output
+  address output
+  format.date output
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {inbook}
+{ output.bibitem
+  author empty$
+    { format.editors "author and editor" output.check }
+    { format.authors output.nonnull
+      crossref missing$
+	{ "author and editor" editor either.or.check }
+	'skip$
+      if$
+    }
+  if$
+  new.block
+  format.btitle "title" output.check
+  format.edition output
+  crossref missing$
+    { format.bvolume output
+      new.block
+      format.number.series output
+      new.sentence
+      publisher "publisher" output.check
+      address output
+    }
+    { 
+      new.block
+      format.book.crossref output.nonnull
+    }
+  if$
+  format.date "year" output.check
+  format.chapter.pages "chapter and pages" output.check
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {incollection}
+{ output.bibitem
+  format.authors "author" output.check
+  new.block
+  format.title "title" output.check
+  new.block
+  crossref missing$
+    { format.in.ed.booktitle "booktitle" output.check
+      format.edition output
+      format.bvolume output
+      format.number.series output
+      new.sentence
+      publisher "publisher" output.check
+      address output
+      format.date "year" output.check
+    }
+    { format.incoll.inproc.crossref output.nonnull
+    }
+  if$
+  format.chapter.pages output
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {inproceedings}
+{ output.bibitem
+  format.authors "author" output.check
+  new.block
+  format.title "title" output.check
+  new.block
+  crossref missing$
+    { format.in.proc.date "booktitle" output.check
+      format.ineditors output
+      format.bvolume output
+      format.number.series output
+	  organization output
+	  publisher output
+	}
+    { format.incoll.inproc.crossref output.nonnull  }
+  if$
+  format.pp.pages output
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {conference} { inproceedings }
+
+FUNCTION {manual}
+{ output.bibitem
+  author empty$
+    { organization scapify output }
+    { format.authors output.nonnull }
+  if$
+  new.block
+  format.btitle "title" output.check
+  format.edition output
+  author empty$
+	{ address new.block.checka }
+    { organization address new.block.checkb
+      organization output
+    }
+  if$
+  address output
+  format.date output
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {mastersthesis}
+{ output.bibitem
+  format.authors "author" output.check
+  new.block
+  format.title "title" output.check
+  new.block
+  bbl.mthesis
+  format.thesis.type output.nonnull
+  school "school" output.check
+  address output
+  format.date "year" output.check
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {misc}
+{ output.bibitem
+  format.authors output
+  title howpublished new.block.checkb
+  format.title output
+  howpublished new.block.checka
+  howpublished output
+  format.date output
+  new.block
+  note output
+  fin.entry
+  empty.misc.check
+}
+
+FUNCTION {phdthesis}
+{ output.bibitem
+  format.authors "author" output.check
+  new.block
+  format.btitle "title" output.check
+  new.block
+  bbl.phdthesis
+  format.thesis.type output.nonnull
+  school "school" output.check
+  address output
+  format.date "year" output.check
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {proceedings}
+{ output.bibitem
+  editor empty$
+    { organization scapify output }
+    { format.editors output.nonnull }
+  if$
+  new.block
+  title format.proc.date "title" output.check
+  format.bvolume output
+  format.number.series output
+  editor empty$
+	'skip$
+	{ organization output }
+  if$
+  publisher output
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {techreport}
+{ output.bibitem
+  format.authors "author" output.check
+  new.block
+  format.title "title" output.check
+  new.block
+  format.tr.number output.nonnull
+  institution "institution" output.check
+  address output
+  format.date "year" output.check
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {unpublished}
+{ output.bibitem
+  format.authors "author" output.check
+  new.block
+  format.title "title" output.check
+  new.block
+  note "note" output.check
+  format.date output
+  fin.entry
+}
+
+FUNCTION {default.type} { misc }
+
+MACRO {jan} {"Jan."}
+
+MACRO {feb} {"Feb."}
+
+MACRO {mar} {"Mar."}
+
+MACRO {apr} {"Apr."}
+
+MACRO {may} {"May"}
+
+MACRO {jun} {"June"}
+
+MACRO {jul} {"July"}
+
+MACRO {aug} {"Aug."}
+
+MACRO {sep} {"Sept."}
+
+MACRO {oct} {"Oct."}
+
+MACRO {nov} {"Nov."}
+
+MACRO {dec} {"Dec."}
+
+MACRO {acmcs} {"ACM Comput. Surv."}
+
+MACRO {acta} {"Acta Inf."}
+
+MACRO {cacm} {"Commun. ACM"}
+
+
+MACRO {ibmjrd} {"IBM J. Res. Dev."}
+
+MACRO {ibmsj} {"IBM Syst.~J."}
+
+
+MACRO {ieeese} {"IEEE Trans. Softw. Eng."}
+
+MACRO {ieeetc} {"IEEE Trans. Comput."}
+
+MACRO {ieeetcad}
+ {"IEEE Trans. Comput.-Aided Design Integrated Circuits"}
+
+
+MACRO {ipl} {"Inf. Process. Lett."}
+
+MACRO {jacm} {"J.~ACM"}
+
+
+MACRO {jcss} {"J.~Comput. Syst. Sci."}
+
+MACRO {scp} {"Sci. Comput. Programming"}
+
+MACRO {sicomp} {"SIAM J. Comput."}
+
+
+MACRO {tocs} {"ACM Trans. Comput. Syst."}
+
+MACRO {tods} {"ACM Trans. Database Syst."}
+
+MACRO {tog} {"ACM Trans. Gr."}
+
+
+MACRO {toms} {"ACM Trans. Math. Softw."}
+
+MACRO {toois} {"ACM Trans. Office Inf. Syst."}
+
+
+MACRO {toplas} {"ACM Trans. Program. Lang. Syst."}
+
+MACRO {tcs} {"Theoretical Comput. Sci."}
+
+READ
+
+FUNCTION {sortify}
+{ 
+  fa.isPersianLanguage
+    { "l" change.case$}
+    {purify$ "l" change.case$}
+  if$  
+  %duplicate$ write$
+}
+
+INTEGERS { len }
+
+FUNCTION {chop.word}
+{ 's :=
+  'len :=
+  s #1 len substring$ =
+    { s len #1 + global.max$ substring$ }
+    's
+  if$
+}
+
+FUNCTION {sort.format.names}
+{ 's :=
+  #1 'nameptr :=
+  ""
+  s num.names$ 'numnames :=
+  numnames 'namesleft :=
+    { namesleft #0 > }
+      { nameptr #1 >
+	    { "   " * }
+	    'skip$
+      if$
+      s nameptr "{vv{ } }{ll{ }}{  ff{ }}{  jj{ }}" format.name$ 't :=
+      nameptr numnames = t "others" = and
+	   { bbl.etal * }
+	   { t sortify * }
+      if$
+	  nameptr #1 + 'nameptr :=
+      namesleft #1 - 'namesleft :=
+    }
+  while$  
+}
+
+FUNCTION {sort.format.title}
+{ 't :=
+  "A " #2
+    "An " #3
+      "The " #4 t chop.word
+    chop.word
+  chop.word
+  sortify
+  #1 global.max$ substring$
+}
+
+FUNCTION {author.sort}
+{ author empty$
+    { key empty$
+	    { "to sort, need author or key in " cite$ * warning$
+	     ""
+	    }
+	    { key sortify }
+      if$
+    }
+    { author sort.format.names }
+  if$  
+}
+
+FUNCTION {author.editor.sort}
+{ author empty$
+    { editor empty$
+	{ key empty$
+	    { "to sort, need author, editor, or key in " cite$ * warning$
+	      ""
+	    }
+	    { key sortify }
+	  if$
+	}
+	{ editor sort.format.names }
+      if$
+    }
+    { author sort.format.names }
+  if$
+}
+
+FUNCTION {author.organization.sort}
+{ author empty$
+    { organization empty$
+	{ key empty$
+	    { "to sort, need author, organization, or key in " cite$ * warning$
+	      ""
+	    }
+	    { key sortify }
+	  if$
+	}
+	{ "The " #4 organization chop.word sortify }
+      if$
+    }
+    { author sort.format.names }
+  if$
+}
+
+FUNCTION {editor.organization.sort}
+{ editor empty$
+    { organization empty$
+	{ key empty$
+	    { "to sort, need editor, organization, or key in " cite$ * warning$
+	      ""
+	    }
+	    { key sortify }
+	  if$
+	}
+	{ "The " #4 organization chop.word sortify }
+      if$
+    }
+    { editor sort.format.names }
+  if$
+}
+
+FUNCTION {presort}
+{ type$ "book" =
+  type$ "inbook" =
+  or
+    'author.editor.sort
+    { type$ "proceedings" =
+	'editor.organization.sort
+	{ type$ "manual" =
+	    'author.organization.sort
+	    'author.sort
+	  if$
+	}
+      if$
+    }
+  if$
+  "    "
+  *
+  year field.or.null sortify
+  *
+  "    "
+  *
+  title field.or.null
+  sort.format.title
+  *
+  #1 entry.max$ substring$
+  'sort.key$ :=  
+}
+
+ITERATE {presort}
+
+SORT
+
+STRINGS { longest.label }
+
+INTEGERS { number.label longest.label.width }
+
+FUNCTION {initialize.longest.label}
+{ "" 'longest.label :=
+  #1 'number.label :=
+  #0 'longest.label.width :=
+}
+
+FUNCTION {longest.label.pass}
+{ number.label int.to.str$ 'label :=
+  number.label #1 + 'number.label :=
+  label width$ longest.label.width >
+    { label 'longest.label :=
+      label width$ 'longest.label.width :=
+    }
+    'skip$
+  if$
+}
+
+EXECUTE {banner.message}
+EXECUTE {initialize.longest.label}
+
+ITERATE {longest.label.pass}
+
+FUNCTION {begin.bib}
+{ 
+  "% Generated by plain-fa.bst,  version: " bst.file.version * " (" * bst.file.date * "), for XePersian Package" *
+  write$ newline$
+  "% Authors: " bst.file.authors *
+  write$ newline$
+  "\providecommand{\noopsort}[1]{}"
+  write$ newline$
+  preamble$ empty$
+    'skip$
+    { preamble$ write$ newline$ }
+  if$
+  "\begin{thebibliography}{"  longest.label  * "}" * write$ newline$
+}
+
+EXECUTE {begin.bib}
+
+EXECUTE {init.state.consts}
+
+ITERATE {call.type$}
+
+FUNCTION {end.bib}
+{ newline$
+  "\end{thebibliography}" write$ newline$
+  "\Persian" write$ newline$
+}
+
+EXECUTE {end.bib}
+EXECUTE{completed.message}
+%    \end{macrocode}
+% \iffalse
+%</acm-fa.bst>
+%<*ieeetr-fa.bst>
+% \fi
+% \part{ieeetr-fa.bst}
+%    \begin{macrocode}
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+%% Bib. style "ieeetr-fa", Persian (farsi)  version of ieeetr.bst
+%%
+%% by: Mahmood Amintoosi and Mostafa Vahedi
+%% For XePersian, a Persian Typsetting Package in XeTeX, Developed by:
+%% Vafa Khalighi, Mehdi Omidali and Mostafa Vahedi 
+%% 2009/02/12
+%% It may be distributed and/or modified under the
+%% conditions of the LaTeX Project Public License, either this version
+%% of this license or (at your option) any later version.
+%%
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+%% Original Copyright
+% IEEE Transactions bibliography style (29-Jan-88 version)
+%    numeric labels, order-of-reference, IEEE abbreviations,
+%    quotes around article titles, commas separate all fields
+%    except after book titles and before "notes".  Otherwise,
+%    much like the "plain" family, from which this is adapted.
+%
+
+ENTRY
+  { address
+    author
+    booktitle
+    chapter
+    edition
+    editor
+    howpublished
+    institution
+    journal
+    key
+	language
+    month
+    note
+    number
+    organization
+    pages
+    publisher
+    school
+    series
+    title
+	translator
+    type
+    volume
+    year
+  }
+  {}
+  { label }
+
+INTEGERS { output.state before.all mid.sentence after.quote after.sentence
+		after.quoted.block after.block }
+STRINGS {bbl.and bbl.etal bbl.editors bbl.editor bbl.edition bbl.volume bbl.of bbl.number
+		 bbl.in bbl.pages bbl.page bbl.chapter bbl.series bbl.techrep bbl.mthesis bbl.phdthesis 
+		 bbl.translator}% bbl.formatnames}
+FUNCTION {is.print.banners.to.terminal} { #1 }
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+%% FILE VERSION AND BANNER %%
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+
+FUNCTION{bst.file.version} { "0.3" }
+FUNCTION{bst.file.date} { "2009/02/12" }
+FUNCTION{bst.file.website} { "http://parsilatex.org/" }
+FUNCTION{bst.file.authors} {"M.Amintoosi and M.Vahedi" }
+
+FUNCTION {banner.message}
+{ is.print.banners.to.terminal
+     { "-- ieeetr-fa.bst version" " " * bst.file.version *
+       " (" * bst.file.date * ") " * %"by " * bst.file.authors *
+       top$
+       "-- This is a BibTeX style for XePersian: " bst.file.website *
+       %top$
+       %"-- See the " quote$ * "xepersian_bibtex_userguide.pdf" * quote$ * " manual for usage information." *
+       top$
+     }
+     { skip$ }
+   if$
+}
+
+FUNCTION {completed.message}
+{ is.print.banners.to.terminal
+     { ""
+       top$
+       "Done."
+       top$
+     }
+     { skip$ }
+   if$
+}
+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+%% Persian Functions	   %%
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+
+FUNCTION {fa.isPersianLanguage}
+{
+  language missing$
+    {#0}
+    {language "l" change.case$ "persian" =}
+  if$
+}
+
+FUNCTION {keywords.fa}
+{
+  " ?? " 			'bbl.and 		:=
+  " ?? ????????????" 		'bbl.etal 		:=
+  " ???????????????????? " 	'bbl.editors 	:=
+  " ??????????????????? " 		'bbl.editor 	:=
+  " ???????????? " 		'bbl.edition    :=
+  " ?????? " 			'bbl.volume		:=
+  " ???? " 			'bbl.of			:=
+  " ?????????? " 			'bbl.number		:=
+  " ???? " 			'bbl.in 		:=
+  " ?????????? " 		'bbl.pages 		:=
+  " ??." 			'bbl.page 		:=
+  " ?????? " 			'bbl.chapter	:=
+  " ?????? "				'bbl.series		:=
+  " ?????????? ?????? ????????????"	'bbl.techrep	:=
+  " ????????????????????? ???????????????????????????" 'bbl.mthesis 	:=
+  " ????????????????????? ??????????" 		'bbl.phdthesis	:=   
+  " ??????????????? "					'bbl.translator :=  
+}
+
+FUNCTION {keywords.en}
+{
+  " and " 			'bbl.and 		:=
+  " et~al." 		'bbl.etal 		:=
+  " Eds." 			'bbl.editors 	:=
+  " Ed." 			'bbl.editor 	:=
+  " Ed." 			'bbl.edition    :=
+  " Vol." 			'bbl.volume		:=
+  " of " 			'bbl.of			:=
+  " No." 			'bbl.number		:=
+  " In " 			'bbl.in 		:=
+  " pp." 			'bbl.pages 		:=
+  " p." 			'bbl.page 		:=
+  " Ch." 			'bbl.chapter	:=
+  " Ser."			'bbl.series		:=
+  " Tech. Rep."		'bbl.techrep	:=
+  " Master's thesis" 'bbl.mthesis 	:=
+  " Ph.D. disseration"  'bbl.phdthesis	:=   
+  " Translator "	'bbl.translator :=
+}
+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+%% End of Persian Functions %%
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+
+FUNCTION {init.state.consts}
+{ #0 'before.all :=
+  #1 'mid.sentence :=
+  #2 'after.quote :=
+  #3 'after.sentence :=
+  #4 'after.quoted.block :=
+  #5 'after.block :=
+}
+
+STRINGS { s t }
+
+FUNCTION {output.nonnull}
+{ 's :=
+  output.state mid.sentence =
+    { ", " * write$ }
+    { output.state after.quote =
+	{ " " * write$ }
+	{ output.state after.block =
+	    { add.period$ write$
+	      newline$
+	      "\newblock " write$
+	    }
+	    { output.state before.all =
+		'write$
+		{ output.state after.quoted.block =
+		    { write$
+		      newline$
+		      "\newblock " write$
+		    }
+		    { add.period$ " " * write$ }
+		  if$
+		}
+	      if$
+	    }
+	  if$
+	}
+      if$
+      mid.sentence 'output.state :=
+    }
+  if$
+  s
+}
+
+FUNCTION {output}
+{ duplicate$ empty$
+    'pop$
+    'output.nonnull
+  if$
+}
+
+FUNCTION {output.check}
+{ 't :=
+  duplicate$ empty$
+    { pop$ "empty " t * " in " * cite$ * warning$ }
+    'output.nonnull
+  if$
+}
+
+FUNCTION {output.bibitem}
+{ newline$
+  fa.isPersianLanguage
+    { keywords.fa
+	  "\Persian" write$
+      newline$ }
+    { keywords.en
+	  "\Latin" write$
+      newline$ }
+  if$
+  "\bibitem{" write$
+  cite$ write$
+  "}" write$
+  newline$
+  ""
+  before.all 'output.state :=
+}
+
+FUNCTION {blank.sep}
+{ after.quote 'output.state :=
+}
+
+FUNCTION {fin.entry}
+{ output.state after.quoted.block =
+    'skip$
+    'add.period$
+  if$
+  write$
+  newline$
+}
+
+FUNCTION {new.block}
+{ output.state before.all =
+    'skip$
+    { output.state after.quote =
+	{ after.quoted.block 'output.state := }
+	{ after.block 'output.state := }
+      if$
+    }
+  if$
+}
+
+FUNCTION {new.sentence}
+{ output.state after.block =
+    'skip$
+    { output.state before.all =
+	'skip$
+	{ after.sentence 'output.state := }
+      if$
+    }
+  if$
+}
+
+FUNCTION {not}
+{   { #0 }
+    { #1 }
+  if$
+}
+
+FUNCTION {and}
+{   'skip$
+    { pop$ #0 }
+  if$
+}
+
+FUNCTION {or}
+{   { pop$ #1 }
+    'skip$
+  if$
+}
+
+FUNCTION {new.block.checka}
+{ empty$
+    'skip$
+    'new.block
+  if$
+}
+
+FUNCTION {new.block.checkb}
+{ empty$
+  swap$ empty$
+  and
+    'skip$
+    'new.block
+  if$
+}
+
+FUNCTION {new.sentence.checka}
+{ empty$
+    'skip$
+    'new.sentence
+  if$
+}
+
+FUNCTION {field.or.null}
+{ duplicate$ empty$
+    { pop$ "" }
+    'skip$
+  if$
+}
+
+FUNCTION {emphasize}
+{ duplicate$ empty$
+    { pop$ "" }
+    { "{\em " swap$ * "}" * }
+  if$
+}
+
+INTEGERS { nameptr namesleft numnames }
+
+FUNCTION {format.names}
+{ 's :=
+  #1 'nameptr :=
+  s num.names$ 'numnames :=
+  numnames 'namesleft :=
+    { namesleft #0 > }
+    { %s nameptr "{f.~}{vv~}{ll}{, jj}" format.name$ 't :=
+      fa.isPersianLanguage 
+        { s nameptr "{vv~}{ll}{, jj}{, ff}" format.name$ 't :=}
+        { s nameptr "{vv~}{ll}{, jj}{, f.}" format.name$ 't :=}
+      if$  
+	  nameptr #1 >
+	{ namesleft #1 >
+	    { ", " * t * }
+	    { numnames #2 >
+		{ "," * }
+		'skip$
+	      if$
+	      t "others" =
+		{ " {\em" * bbl.etal * "}" * }
+		{ bbl.and * t * }
+	      if$
+	    }
+	  if$
+	}
+	't
+      if$
+      nameptr #1 + 'nameptr :=
+      namesleft #1 - 'namesleft :=
+    }
+  while$
+}
+
+FUNCTION {format.authors}
+{ author empty$
+    { "" }
+    { author format.names }
+  if$
+}
+
+FUNCTION {format.editors}
+{ editor empty$
+    { "" }
+    { fa.isPersianLanguage
+	    {
+		editor num.names$ #1 >
+			{bbl.editors editor format.names * }
+			{bbl.editor editor format.names * }
+		if$
+		}
+		{
+ 		editor format.names
+		editor num.names$ #1 >
+			{ ", " bbl.editors * *}
+			{ ", " bbl.editor * *}
+		if$
+		}
+	  if$	
+    }
+  if$
+}
+
+FUNCTION {format.translators}
+{ translator empty$
+    { "" }
+    { fa.isPersianLanguage
+	    {
+		bbl.translator translator format.names *
+		}
+		{
+ 		translator format.names
+		", " bbl.translator * *
+		}
+	  if$	
+    }
+  if$
+}
+
+FUNCTION {format.title}
+{ title empty$
+    { "" }
+	{ fa.isPersianLanguage
+        { "''" title * ",``" * }
+	    { "``" title "t" change.case$ * ",''" * }
+	  if$ 
+	}
+  if$
+}
+
+FUNCTION {format.title.p}
+{ title empty$
+    { "" }
+	{ fa.isPersianLanguage
+        { "''" title * ",``" * }
+	    { "``" title "t" change.case$ * ",''" * }
+	  if$ 
+	}
+  if$
+}
+
+FUNCTION {n.dashify}
+{ 't :=
+  ""
+    { t empty$ not }
+    { t #1 #1 substring$ "-" =
+	{ t #1 #2 substring$ "--" = not
+	    { "--" *
+	      t #2 global.max$ substring$ 't :=
+	    }
+	    {   { t #1 #1 substring$ "-" = }
+		{ "-" *
+		  t #2 global.max$ substring$ 't :=
+		}
+	      while$
+	    }
+	  if$
+	}
+	{ t #1 #1 substring$ *
+	  t #2 global.max$ substring$ 't :=
+	}
+      if$
+    }
+  while$
+}
+
+FUNCTION {format.date}
+{ year empty$
+    { month empty$
+	{ "" }
+	{ "there's a month but no year in " cite$ * warning$
+	  month
+	}
+      if$
+    }
+    { month empty$
+	'year
+	{ month " " * year * }
+      if$
+    }
+  if$
+}
+
+FUNCTION {format.btitle}
+{ title emphasize
+}
+
+FUNCTION {tie.or.space.connect}
+{ duplicate$ text.length$ #3 <
+    { "~" }
+    { " " }
+  if$
+  swap$ * *
+}
+
+FUNCTION {either.or.check}
+{ empty$
+    'pop$
+    { "can't use both " swap$ * " fields in " * cite$ * warning$ }
+  if$
+}
+
+FUNCTION {format.bvolume}
+{ volume empty$
+    { "" }
+    { bbl.volume volume *
+      series empty$
+	'skip$
+	{ bbl.of * series emphasize * }
+      if$
+      "volume and number" number either.or.check
+    }
+  if$
+}
+
+FUNCTION {format.number.series}
+{ volume empty$
+    { number empty$
+	{ series field.or.null }
+	{ output.state mid.sentence =
+	    { bbl.number }
+	    { bbl.number "t" change.case$ }
+	  if$
+	  number tie.or.space.connect
+	  series empty$
+	    { "there's a number but no series in " cite$ * warning$ }
+	    { bbl.in * series * }
+	  if$
+	}
+      if$
+    }
+    { "" }
+  if$
+}
+
+FUNCTION {format.edition}
+{ edition empty$
+    { "" }
+    { fa.isPersianLanguage
+	    {
+		   bbl.edition edition * 
+		}
+		{
+	      output.state mid.sentence =
+	       { edition "l" change.case$ bbl.edition * }
+	       { edition "t" change.case$ bbl.edition * }
+          if$
+		}
+	  if$	
+    }
+  if$
+}
+
+INTEGERS { multiresult }
+
+FUNCTION {multi.page.check}
+{ 't :=
+  #0 'multiresult :=
+    { multiresult not
+      t empty$ not
+      and
+    }
+    { t #1 #1 substring$
+      duplicate$ "-" =
+      swap$ duplicate$ "," =
+      swap$ "+" =
+      or or
+	{ #1 'multiresult := }
+	{ t #2 global.max$ substring$ 't := }
+      if$
+    }
+  while$
+  multiresult
+}
+
+FUNCTION {format.pages}
+{ pages empty$
+    { "" }
+    { pages multi.page.check
+	{ bbl.pages pages n.dashify * }
+	{ bbl.page pages * }
+      if$
+    }
+  if$
+}
+
+FUNCTION {format.volume}
+{ volume empty$
+    { "" }
+    { bbl.volume volume * }%M.Amintoosi "vol.~"
+  if$
+}
+
+FUNCTION {format.number}
+{ number empty$
+    { "" }
+    { bbl.number number * }%M.Amintoosi "no.~"
+  if$
+}
+
+FUNCTION {format.chapter.pages}
+{ chapter empty$
+    'format.pages
+    { type empty$
+	{ bbl.chapter }
+	{ type "l" change.case$ }
+      if$
+      chapter tie.or.space.connect
+      pages empty$
+	'skip$
+	{ ", " * format.pages * }
+      if$
+    }
+  if$
+}
+
+FUNCTION {format.in.ed.booktitle}
+{ booktitle empty$
+    { "" }
+    { bbl.in booktitle emphasize *
+      editor empty$
+	   'skip$
+	   { " (" * format.editors * ")" * }
+      if$
+    }
+  if$
+}
+
+FUNCTION {format.thesis.type}
+{ type empty$
+    'skip$
+    { pop$
+      output.state after.block =
+	{ type "t" change.case$ }
+	{ type "l" change.case$ }
+      if$
+    }
+  if$
+}
+
+FUNCTION {empty.misc.check}
+{ author empty$ title empty$ howpublished empty$
+  month empty$ year empty$ note empty$
+  and and and and and
+    { "all relevant fields are empty in " cite$ * warning$ }
+    'skip$
+  if$
+}
+
+FUNCTION {format.tr.number}
+{ type empty$
+    { bbl.techrep }
+    'type
+  if$
+  number empty$
+    { "l" change.case$ }
+    { number tie.or.space.connect }
+  if$
+}
+
+FUNCTION {format.addr.pub}
+{ publisher empty$
+    { "" }
+    { address empty$
+	{ "" }
+	{ address ": " * }
+      if$
+      publisher *
+    }
+  if$
+}
+
+FUNCTION {format.paddress}
+{ address empty$
+    { "" }
+    { "(" address * ")" * }
+  if$
+}
+
+FUNCTION {format.article.crossref}
+{ key empty$
+    { journal empty$
+	{ "need key or journal for " cite$ * " to crossref " * crossref *
+	  warning$
+	  ""
+	}
+	{ bbl.in "{\em " * journal * "\/}" * }
+      if$
+    }
+    { bbl.in  key * }
+  if$
+  " \cite{" * crossref * "}" *
+}
+
+FUNCTION {format.crossref.editor}
+{ editor #1 "{vv~}{ll}" format.name$
+  editor num.names$ duplicate$
+  #2 >
+    { pop$ " {\em" * bbl.etal * "}" * }
+    { #2 <
+	'skip$
+	{ editor #2 "{ff }{vv }{ll}{ jj}" format.name$ "others" =
+	    { " {\em"  bbl.etal * "}" * }
+	    { bbl.and * editor #2 "{vv~}{ll}" format.name$ * }
+	  if$
+	}
+      if$
+    }
+  if$
+}
+
+FUNCTION {format.book.crossref}
+{ volume empty$
+    { "empty volume in " cite$ * "'s crossref of " * crossref * warning$
+      bbl.in
+    }
+    { bbl.volume volume tie.or.space.connect
+      bbl.of  *
+    }
+  if$
+  editor empty$
+  editor field.or.null author field.or.null =
+  or
+    { key empty$
+	{ series empty$
+	    { "need editor, key, or series for " cite$ * " to crossref " *
+	      crossref * warning$
+	      "" *
+	    }
+	    { "{\em " * series * "\/}" * }
+	  if$
+	}
+	{ key * }
+      if$
+    }
+    { format.crossref.editor * }
+  if$
+  " \cite{" * crossref * "}" *
+}
+
+FUNCTION {format.incoll.inproc.crossref}
+{ editor empty$
+  editor field.or.null author field.or.null =
+  or
+    { key empty$
+	{ booktitle empty$
+	    { "need editor, key, or booktitle for " cite$ * " to crossref " *
+	      crossref * warning$
+	      ""
+	    }
+	    { bbl.in "{\em " * booktitle * "\/}" * }
+	  if$
+	}
+	{ bbl.in key * }
+      if$
+    }
+    { bbl.in format.crossref.editor * }
+  if$
+  " \cite{" * crossref * "}" *
+}
+
+FUNCTION {article}
+{ output.bibitem
+  format.authors "author" output.check
+  format.title "title" output.check
+  blank.sep
+  crossref missing$
+    { journal emphasize "journal" output.check
+      format.volume output
+      month empty$
+	{ format.number output }
+	'skip$
+      if$
+      format.pages output
+      format.date "year" output.check
+    }
+    { format.article.crossref output.nonnull
+      format.pages output
+    }
+  if$
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {book}
+{ output.bibitem
+  fa.isPersianLanguage
+  {
+	format.authors  output
+    new.block
+    format.btitle "title" output.check
+	new.block
+    format.translators output
+	format.editors  output
+  }
+  { author empty$
+      { format.editors "author and editor" output.check }
+      { format.authors output.nonnull
+        crossref missing$
+	      { "author and editor" editor either.or.check }
+	      'skip$
+        if$
+      }
+    if$
+    new.block
+    format.btitle "title" output.check
+  }  
+  if$
+  crossref missing$
+    { format.bvolume output
+      new.block
+      format.number.series output
+      format.addr.pub "publisher" output.check
+    }
+    { new.block
+      format.book.crossref output.nonnull
+    }
+  if$
+  format.edition output
+  format.date "year" output.check
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {booklet}
+{ output.bibitem
+  format.authors output
+  title empty$
+    { "empty title in " cite$ * warning$
+      howpublished new.sentence.checka
+    }
+    { howpublished empty$ not
+      address empty$ month empty$ year empty$ and and
+      or
+	{ format.title.p output.nonnull }
+	{ format.title output.nonnull }
+      if$
+      blank.sep
+    }
+  if$
+  howpublished output
+  address output
+  format.date output
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {inbook}
+{ output.bibitem
+  author empty$
+    { format.editors "author and editor" output.check }
+    { format.authors output.nonnull
+      crossref missing$
+	{ "author and editor" editor either.or.check }
+	'skip$
+      if$
+    }
+  if$
+  format.btitle "title" output.check
+  crossref missing$
+    { format.bvolume output
+      format.chapter.pages "chapter and pages" output.check
+      new.block
+      format.number.series output
+      format.addr.pub "publisher" output.check
+    }
+    { format.chapter.pages "chapter and pages" output.check
+      new.block
+      format.book.crossref output.nonnull
+    }
+  if$
+  format.edition output
+  format.date "year" output.check
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {incollection}
+{ output.bibitem
+  format.authors "author" output.check
+  format.title "title" output.check
+  blank.sep
+  crossref missing$
+    { format.in.ed.booktitle "booktitle" output.check
+      format.bvolume output
+      format.number.series output
+      format.chapter.pages output
+      format.addr.pub "publisher" output.check
+      format.edition output
+      format.date "year" output.check
+    }
+    { format.incoll.inproc.crossref output.nonnull
+      format.chapter.pages output
+    }
+  if$
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {inproceedings}
+{ output.bibitem
+  format.authors "author" output.check
+  format.title "title" output.check
+  blank.sep
+  crossref missing$
+    { format.in.ed.booktitle "booktitle" output.check
+      format.bvolume output
+      format.number.series output
+      format.paddress output
+      format.pages output
+      organization output
+      publisher output
+      format.date "year" output.check
+    }
+    { format.incoll.inproc.crossref output.nonnull
+      format.pages output
+    }
+  if$
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {conference} { inproceedings }
+
+FUNCTION {manual}
+{ output.bibitem
+  author empty$
+    { organization empty$
+	'skip$
+	{ organization output.nonnull
+	  address output
+	}
+      if$
+    }
+    { format.authors output.nonnull }
+  if$
+  format.btitle "title" output.check
+  author empty$
+    { organization empty$
+	{ address new.block.checka
+	  address output
+	}
+	'skip$
+      if$
+    }
+    { organization address new.block.checkb
+      organization output
+      address output
+    }
+  if$
+  format.edition output
+  format.date output
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {mastersthesis}
+{ output.bibitem
+  format.authors "author" output.check
+  format.title "title" output.check
+  blank.sep
+  bbl.mthesis format.thesis.type output.nonnull
+  school "school" output.check
+  address output
+  format.date "year" output.check
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {misc}
+{ output.bibitem
+  format.authors output
+  title empty$
+    { howpublished new.sentence.checka }
+    { howpublished empty$ not
+      month empty$ year empty$ and
+      or
+	{ format.title.p output.nonnull }
+	{ format.title output.nonnull }
+      if$
+      blank.sep
+    }
+  if$
+  howpublished output
+  format.date output
+  new.block
+  note output
+  fin.entry
+  empty.misc.check
+}
+
+FUNCTION {phdthesis}
+{ output.bibitem
+  format.authors "author" output.check
+  format.btitle "title" output.check
+  new.block
+  bbl.phdthesis format.thesis.type output.nonnull
+  school "school" output.check
+  address output
+  format.date "year" output.check
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {proceedings}
+{ output.bibitem
+  editor empty$
+    { organization output }
+    { format.editors output.nonnull }
+  if$
+  format.btitle "title" output.check
+  format.bvolume output
+  format.number.series output
+  format.paddress output
+  editor empty$
+    'skip$
+    { organization output }
+  if$
+  publisher output
+  format.date "year" output.check
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {techreport}
+{ output.bibitem
+  format.authors "author" output.check
+  format.title "title" output.check
+  blank.sep
+  format.tr.number output.nonnull
+  institution "institution" output.check
+  address output
+  format.date "year" output.check
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {unpublished}
+{ output.bibitem
+  format.authors "author" output.check
+  format.title.p "title" output.check
+  blank.sep
+  note "note" output.check
+  format.date output
+  fin.entry
+}
+
+FUNCTION {default.type} { misc }
+
+MACRO {jan} {"Jan."}
+
+MACRO {feb} {"Feb."}
+
+MACRO {mar} {"Mar."}
+
+MACRO {apr} {"Apr."}
+
+MACRO {may} {"May"}
+
+MACRO {jun} {"June"}
+
+MACRO {jul} {"July"}
+
+MACRO {aug} {"Aug."}
+
+MACRO {sep} {"Sept."}
+
+MACRO {oct} {"Oct."}
+
+MACRO {nov} {"Nov."}
+
+MACRO {dec} {"Dec."}
+
+MACRO {acmcs} {"ACM Computing Surveys"}
+
+MACRO {acta} {"Acta Informatica"}
+
+MACRO {cacm} {"Communications ACM"}
+
+MACRO {ibmjrd} {"IBM J. Research and Development"}
+
+MACRO {ibmsj} {"IBM Systems~J."}
+
+MACRO {ieeese} {"IEEE Trans. Software Engineering"}
+
+MACRO {ieeetc} {"IEEE Trans. Computers"}
+
+MACRO {ieeetcad}
+ {"IEEE Trans. Computer-Aided Design"}
+
+MACRO {ipl} {"Information Processing Letters"}
+
+MACRO {jacm} {"J.~ACM"}
+
+MACRO {jcss} {"J.~Computer and System Sciences"}
+
+MACRO {scp} {"Science of Computer Programming"}
+
+MACRO {sicomp} {"SIAM J. Computing"}
+
+MACRO {tocs} {"ACM Trans. Computer Systems"}
+
+MACRO {tods} {"ACM Trans. Database Systems"}
+
+MACRO {tog} {"ACM Trans. Graphics"}
+
+MACRO {toms} {"ACM Trans. Mathematical Software"}
+
+MACRO {toois} {"ACM Trans. Office Information Systems"}
+
+MACRO {toplas} {"ACM Trans. Programming Languages and Systems"}
+
+MACRO {tcs} {"Theoretical Computer Science"}
+
+READ
+
+STRINGS { longest.label }
+
+INTEGERS { number.label longest.label.width }
+
+FUNCTION {initialize.longest.label}
+{ "" 'longest.label :=
+  #1 'number.label :=
+  #0 'longest.label.width :=
+}
+
+FUNCTION {longest.label.pass}
+{ number.label int.to.str$ 'label :=
+  number.label #1 + 'number.label :=
+  label width$ longest.label.width >
+    { label 'longest.label :=
+      label width$ 'longest.label.width :=
+    }
+    'skip$
+  if$
+}
+
+EXECUTE {banner.message}
+EXECUTE {initialize.longest.label}
+
+ITERATE {longest.label.pass}
+FUNCTION {begin.bib}
+{ 
+  "% Generated by plain-fa.bst,  version: " bst.file.version * " (" * bst.file.date * "), for XePersian Package" *
+  write$ newline$
+  "% Authors: " bst.file.authors *
+  write$ newline$
+  "\providecommand{\noopsort}[1]{}"
+  write$ newline$
+  preamble$ empty$
+    'skip$
+    { preamble$ write$ newline$ }
+  if$
+  "\begin{thebibliography}{"  longest.label  * "}" * write$ newline$
+}
+
+EXECUTE {begin.bib}
+
+EXECUTE {init.state.consts}
+
+ITERATE {call.type$}
+
+FUNCTION {end.bib}
+{ newline$
+  "\end{thebibliography}" write$ newline$
+  "\Persian" write$ newline$
+}
+
+EXECUTE {end.bib}
+EXECUTE{completed.message}
+%    \end{macrocode}
+% \iffalse
+%</ieeetr-fa.bst>
+%<*plain-fa.bst>
+% \fi
+% \part{plain-fa.bst}
+%    \begin{macrocode}
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+%% Bib. style "plain-fa", Persian (farsi)  version of plain.bst
+%%
+%% by: Mahmood Amintoosi and Mostafa Vahedi
+%% For XePersian, a Persian Typsetting Package in XeTeX, Developed by:
+%% Vafa Khalighi, Mehdi Omidali and Mostafa Vahedi 
+%% 2009/02/09
+%% It may be distributed and/or modified under the
+%% conditions of the LaTeX Project Public License, either this version
+%% of this license or (at your option) any later version.
+%%
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+%% Original Copyright
+% BibTeX standard bibliography style `plain'
+	% version 0.99a for BibTeX versions 0.99a or later, LaTeX version 2.09.
+	% Copyright (C) 1985, all rights reserved.
+	% Copying of this file is authorized only if either
+	% (1) you make absolutely no changes to your copy, including name, or
+	% (2) if you do make changes, you name it something other than
+	% btxbst.doc, plain.bst, unsrt.bst, alpha.bst, and abbrv.bst.
+	% This restriction helps ensure that all standard styles are identical.
+	% The file btxbst.doc has the documentation for this style.
+
+%History
+% 2009/02/11, Copy and made the necessary changes from unsrt-fa.bst
+%		Changing the sortify function so that it does nothing for persian entries
+% 2009/02/12, Chaniging format.names so that prints last name and then first names, 
+%	also it uses only one character of latin first names and whole persian first names
+	
+ENTRY
+  { address
+    author
+    booktitle
+    chapter
+    edition
+    editor
+    howpublished
+    institution
+    journal
+    key
+	language
+    month
+    note
+    number
+    organization
+    pages
+    publisher
+    school
+    series
+    title
+	translator
+    type
+    volume
+    year
+  }
+  {}
+  { label }
+
+INTEGERS { output.state before.all mid.sentence after.sentence after.block }
+STRINGS {bbl.and bbl.etal bbl.editors bbl.editor bbl.edition bbl.volume bbl.of bbl.number
+		 bbl.in bbl.pages bbl.page bbl.chapter bbl.series bbl.techrep bbl.mthesis bbl.phdthesis 
+		 bbl.translator}% bbl.formatnames}
+FUNCTION {is.print.banners.to.terminal} { #1 }
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+%% FILE VERSION AND BANNER %%
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+
+FUNCTION{bst.file.version} { "0.2" }
+FUNCTION{bst.file.date} { "2009/02/09" }
+FUNCTION{bst.file.website} { "http://parsilatex.org/" }
+FUNCTION{bst.file.authors} {"M.Amintoosi and M.Vahedi" }
+
+FUNCTION {banner.message}
+{ is.print.banners.to.terminal
+     { "-- plain-fa.bst version" " " * bst.file.version *
+       " (" * bst.file.date * ") " * %"by " * bst.file.authors *
+       top$
+       "-- This is a BibTeX style for XePersian: " bst.file.website *
+       %top$
+       %"-- See the " quote$ * "xepersian_bibtex_userguide.pdf" * quote$ * " manual for usage information." *
+       top$
+     }
+     { skip$ }
+   if$
+}
+
+FUNCTION {completed.message}
+{ is.print.banners.to.terminal
+     { ""
+       top$
+       "Done."
+       top$
+     }
+     { skip$ }
+   if$
+}
+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+%% Persian Functions	   %%
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+
+FUNCTION {fa.isPersianLanguage}
+{
+  language missing$
+    {#0}
+    {language "l" change.case$ "persian" =}
+  if$
+}
+
+FUNCTION {keywords.fa}
+{
+  " ?? " 			'bbl.and 		:=
+  " ?? ????????????" 		'bbl.etal 		:=
+  " ???????????????????? " 	'bbl.editors 	:=
+  " ??????????????????? " 		'bbl.editor 	:=
+  " ???????????? " 		'bbl.edition    :=
+  " ?????? " 			'bbl.volume		:=
+  " ???? " 			'bbl.of			:=
+  " ?????????? " 			'bbl.number		:=
+  " ???? " 			'bbl.in 		:=
+  " ?????????? " 		'bbl.pages 		:=
+  " ??." 			'bbl.page 		:=
+  " ?????? " 			'bbl.chapter	:=
+  " ?????? "				'bbl.series		:=
+  " ?????????? ?????? ????????????"	'bbl.techrep	:=
+  " ????????????????????? ???????????????????????????" 'bbl.mthesis 	:=
+  " ????????????????????? ??????????" 		'bbl.phdthesis	:=   
+  " ??????????????? "					'bbl.translator :=  
+}
+
+FUNCTION {keywords.en}
+{
+  " and " 			'bbl.and 		:=
+  " et~al." 		'bbl.etal 		:=
+  " Eds." 			'bbl.editors 	:=
+  " Ed." 			'bbl.editor 	:=
+  " Ed." 			'bbl.edition    :=
+  " Vol." 			'bbl.volume		:=
+  " of " 			'bbl.of			:=
+  " No." 			'bbl.number		:=
+  " In " 			'bbl.in 		:=
+  " pp." 			'bbl.pages 		:=
+  " p." 			'bbl.page 		:=
+  " Ch." 			'bbl.chapter	:=
+  " Ser."			'bbl.series		:=
+  " Tech. Rep."		'bbl.techrep	:=
+  " Master's thesis" 'bbl.mthesis 	:=
+  " Ph.D. disseration"  'bbl.phdthesis	:=   
+  " Translator "	'bbl.translator :=
+  %"{vv~}{ll}{, jj}{, f.}"   'bbl.formatnames :=
+}
+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+%% End of Persian Functions %%
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+
+FUNCTION {init.state.consts}
+{ #0 'before.all :=
+  #1 'mid.sentence :=
+  #2 'after.sentence :=
+  #3 'after.block :=
+}
+
+STRINGS { s t }
+
+FUNCTION {output.nonnull}
+{ 's :=
+  output.state mid.sentence =
+    { ", " * write$ }
+    { output.state after.block =
+	{ add.period$ write$
+	  newline$
+	  "\newblock " write$
+	}
+	{ output.state before.all =
+	    'write$
+	    { add.period$ " " * write$ }
+	  if$
+	}
+      if$
+      mid.sentence 'output.state :=
+    }
+  if$
+  s
+}
+
+FUNCTION {output}
+{ duplicate$ empty$
+    'pop$
+    'output.nonnull
+  if$
+}
+
+FUNCTION {output.check}
+{ 't :=
+  duplicate$ empty$
+    { pop$ "empty " t * " in " * cite$ * warning$ }
+    'output.nonnull
+  if$
+}
+
+FUNCTION {output.bibitem}
+{ 
+  newline$
+  fa.isPersianLanguage
+    { keywords.fa
+	  "\Persian" write$
+      newline$ }
+    { keywords.en
+	  "\Latin" write$
+      newline$ }
+  if$
+  "\bibitem{" write$
+  cite$ write$
+  "}" write$
+  newline$
+  ""
+  before.all 'output.state :=
+}
+
+FUNCTION {fin.entry}
+{ add.period$
+  write$
+  newline$
+}
+
+FUNCTION {new.block}
+{ output.state before.all =
+    'skip$
+    { after.block 'output.state := }
+  if$
+}
+
+FUNCTION {new.sentence}
+{ output.state after.block =
+    'skip$
+    { output.state before.all =
+	'skip$
+	{ after.sentence 'output.state := }
+      if$
+    }
+  if$
+}
+
+FUNCTION {not}
+{   { #0 }
+    { #1 }
+  if$
+}
+
+FUNCTION {and}
+{   'skip$
+    { pop$ #0 }
+  if$
+}
+
+FUNCTION {or}
+{   { pop$ #1 }
+    'skip$
+  if$
+}
+
+FUNCTION {new.block.checka}
+{ empty$
+    'skip$
+    'new.block
+  if$
+}
+
+FUNCTION {new.block.checkb}
+{ empty$
+  swap$ empty$
+  and
+    'skip$
+    'new.block
+  if$
+}
+
+FUNCTION {new.sentence.checka}
+{ empty$
+    'skip$
+    'new.sentence
+  if$
+}
+
+FUNCTION {new.sentence.checkb}
+{ empty$
+  swap$ empty$
+  and
+    'skip$
+    'new.sentence
+  if$
+}
+
+FUNCTION {field.or.null}
+{ duplicate$ empty$
+    { pop$ "" }
+    'skip$
+  if$
+}
+
+FUNCTION {emphasize}
+{ duplicate$ empty$
+    { pop$ "" }
+    { "{\em " swap$ * "}" * }
+  if$
+}
+
+INTEGERS { nameptr namesleft numnames }
+
+FUNCTION {format.names}
+{ 's :=
+  #1 'nameptr :=
+  s num.names$ 'numnames :=
+  numnames 'namesleft :=
+ { namesleft #0 > }
+    { 
+      s nameptr "{vv~}{ll}{, jj}{, ff}"  format.name$ 't :=   %{ff~}{vv~}{ll}{, jj}
+	  %fa.isPersianLanguage 
+	  %  {s nameptr "{vv~}{ll}{, jj}{, ff}"  format.name$ 't :=   %{ff~}{vv~}{ll}{, jj}
+	  %  }
+	  %  {s nameptr "{vv~}{ll}{, jj}{, f.}"  format.name$ 't :=  
+		%t "t" change.case$ 't := %I wrote it to lower the letters of latin last names, but it also affected the first name
+		%}
+	  %if$	
+    nameptr #1 >
+	{ namesleft #1 >
+	    { ", " * t * }
+	    { numnames #2 >
+		   { "," * }
+		   'skip$
+	      if$
+	      t "others" =
+		    { bbl.etal * }
+		    { bbl.and * t * }
+	      if$
+	    }
+	  if$
+	}
+	't
+    if$
+      nameptr #1 + 'nameptr :=
+      namesleft #1 - 'namesleft :=
+    }
+  while$
+}
+
+FUNCTION {format.authors}
+{ author empty$
+    { "" }
+    { author format.names }
+  if$
+}
+
+FUNCTION {format.editors}
+{ editor empty$
+    { "" }
+    { fa.isPersianLanguage
+	    {
+		editor num.names$ #1 >
+			{bbl.editors editor format.names * }
+			{bbl.editor editor format.names * }
+		if$
+		}
+		{
+ 		editor format.names
+		editor num.names$ #1 >
+			{ ", " bbl.editors * *}
+			{ ", " bbl.editor * *}
+		if$
+		}
+	  if$	
+    }
+  if$
+}
+
+FUNCTION {format.translators}
+{ translator empty$
+    { "" }
+    { fa.isPersianLanguage
+	    {
+		bbl.translator translator format.names *
+		}
+		{
+ 		translator format.names
+		", " bbl.translator * *
+		}
+	  if$	
+    }
+  if$
+}
+
+FUNCTION {format.title}
+{ title empty$
+    { "" }
+    { title "t" change.case$ }
+  if$
+}
+
+FUNCTION {n.dashify}
+{ 't :=
+  ""
+    { t empty$ not }
+    { t #1 #1 substring$ "-" =
+	{ t #1 #2 substring$ "--" = not
+	    { "--" *
+	      t #2 global.max$ substring$ 't :=
+	    }
+	    {   { t #1 #1 substring$ "-" = }
+		{ "-" *
+		  t #2 global.max$ substring$ 't :=
+		}
+	      while$
+	    }
+	  if$
+	}
+	{ t #1 #1 substring$ *
+	  t #2 global.max$ substring$ 't :=
+	}
+      if$
+    }
+  while$
+}
+
+FUNCTION {format.date}
+{ year empty$
+    { month empty$
+	{ "" }
+	{ "there's a month but no year in " cite$ * warning$
+	  month
+	}
+      if$
+    }
+    { month empty$
+	'year
+	{ month " " * year * }
+      if$
+    }
+  if$
+}
+
+FUNCTION {format.btitle}
+{ title emphasize
+}
+
+FUNCTION {tie.or.space.connect}
+{ duplicate$ text.length$ #3 <
+    { "~" }
+    { " " }
+  if$
+  swap$ * *
+}
+
+FUNCTION {either.or.check}
+{ empty$
+    'pop$
+    { "can't use both " swap$ * " fields in " * cite$ * warning$ }
+  if$
+}
+
+FUNCTION {format.bvolume}
+{ volume empty$
+    { "" }
+    { bbl.volume volume tie.or.space.connect
+      series empty$
+	'skip$
+	{ bbl.of * series emphasize * }
+      if$
+      "volume and number" number either.or.check
+    }
+  if$
+}
+
+FUNCTION {format.number.series}
+{ volume empty$
+    { number empty$
+	{ series field.or.null }
+	{ output.state mid.sentence =
+	    { bbl.number }
+	    { bbl.number "t" change.case$ }
+	  if$
+	  number tie.or.space.connect
+	  series empty$
+	    { "there's a number but no series in " cite$ * warning$ }
+	    { bbl.in * series * }
+	  if$
+	}
+      if$
+    }
+    { "" }
+  if$
+}
+
+FUNCTION {format.edition}
+{ edition empty$
+    { "" }
+    { fa.isPersianLanguage
+	    {
+		   bbl.edition edition * 
+		}
+		{
+	      output.state mid.sentence =
+	       { edition "l" change.case$ bbl.edition * }
+	       { edition "t" change.case$ bbl.edition * }
+          if$
+		}
+	  if$	
+    }
+  if$
+}
+
+INTEGERS { multiresult }
+
+FUNCTION {multi.page.check}
+{ 't :=
+  #0 'multiresult :=
+    { multiresult not
+      t empty$ not
+      and
+    }
+    { t #1 #1 substring$
+      duplicate$ "-" =
+      swap$ duplicate$ "," =
+      swap$ "+" =
+      or or
+	{ #1 'multiresult := }
+	{ t #2 global.max$ substring$ 't := }
+      if$
+    }
+  while$
+  multiresult
+}
+
+FUNCTION {format.pages}
+{ pages empty$
+    { "" }
+    { pages multi.page.check
+	   { bbl.pages pages n.dashify tie.or.space.connect }
+	   { bbl.page pages tie.or.space.connect }
+      if$
+    }
+  if$
+}
+
+FUNCTION {format.vol.num.pages}
+{ volume field.or.null
+  number empty$
+    'skip$
+    { "(" number * ")" * *
+      volume empty$
+	{ "there's a number but no volume in " cite$ * warning$ }
+	'skip$
+      if$
+    }
+  if$
+  pages empty$
+    'skip$
+    { duplicate$ empty$
+	{ pop$ format.pages }
+	{ ":" * pages n.dashify * }
+      if$
+    }
+  if$
+}
+
+FUNCTION {format.chapter.pages}
+{ chapter empty$
+    'format.pages
+    { type empty$
+	{ bbl.chapter }
+	{ type "l" change.case$ }
+      if$
+      chapter tie.or.space.connect
+      pages empty$
+	'skip$
+	{ ", " * format.pages * }
+      if$
+    }
+  if$
+}
+
+FUNCTION {format.in.ed.booktitle}
+{ 
+  booktitle empty$
+    { "" }
+    { editor empty$
+	    { bbl.in booktitle emphasize * }
+	    { bbl.in format.editors * ", " * booktitle emphasize * }
+	  if$
+	}  
+  if$
+}
+
+FUNCTION {empty.misc.check}
+{ author empty$ title empty$ howpublished empty$
+  month empty$ year empty$ note empty$
+  and and and and and
+  key empty$ not and
+    { "all relevant fields are empty in " cite$ * warning$ }
+    'skip$
+  if$
+}
+
+FUNCTION {format.thesis.type}
+{ type empty$
+    'skip$
+    { pop$
+      type "t" change.case$
+    }
+  if$
+}
+
+FUNCTION {format.tr.number}
+{ type empty$
+    { bbl.techrep }
+    'type
+  if$
+  number empty$
+    { "t" change.case$ }
+    { number tie.or.space.connect }
+  if$
+}
+
+FUNCTION {format.article.crossref}
+{ key empty$
+    { journal empty$
+	{ "need key or journal for " cite$ * " to crossref " * crossref *
+	  warning$
+	  ""
+	}
+	{ bbl.in "{\em "  * journal * "\/}" * }
+      if$
+    }
+    { bbl.in key * }
+  if$
+  " \cite{" * crossref * "}" *
+}
+
+FUNCTION {format.crossref.editor}
+{ editor #1 "{vv~}{ll}" format.name$
+  editor num.names$ duplicate$  #2 >
+    { pop$ bbl.etal * }
+    { #2 < 'skip$
+	    { editor #2 "{ff }{vv }{ll}{ jj}" format.name$ "others" =%"{ff }{vv }{ll}{ jj}"
+	      { bbl.etal * }
+	      { bbl.and * editor #2 "{vv~}{ll}" format.name$ * }
+	    if$
+	    }			
+    if$
+    }
+  if$
+}
+
+FUNCTION {format.book.crossref}
+{ volume empty$
+    { "empty volume in " cite$ * "'s crossref of " * crossref * warning$
+      bbl.in
+    }
+    { bbl.volume volume tie.or.space.connect
+      bbl.of *
+    }
+  if$
+  editor empty$
+  editor field.or.null author field.or.null =
+  or
+    { key empty$
+	{ series empty$
+	    { "need editor, key, or series for " cite$ * " to crossref " *
+	      crossref * warning$
+	      "" *
+	    }
+	    { "{\em " * series * "\/}" * }
+	  if$
+	}
+	{ key * }
+      if$
+    }
+    { format.crossref.editor * }
+  if$
+  " \cite{" * crossref * "}" *
+}
+
+FUNCTION {format.incoll.inproc.crossref}
+{ editor empty$
+  editor field.or.null author field.or.null =
+  or
+    { key empty$
+	{ booktitle empty$
+	    { "need editor, key, or booktitle for " cite$ * " to crossref " *
+	      crossref * warning$
+	      ""
+	    }
+	    { bbl.in " {\em " * booktitle * "\/}" * }
+	  if$
+	}
+	{ bbl.in key * }
+      if$
+    }
+    { bbl.in format.crossref.editor * }
+  if$
+  " \cite{" * crossref * "}" *
+}
+
+FUNCTION {article}
+{ output.bibitem
+  format.authors "author" output.check
+  new.block
+  format.title "title" output.check
+  new.block
+  crossref missing$
+    { journal emphasize "journal" output.check
+      format.vol.num.pages output
+      format.date "year" output.check
+    }
+    { format.article.crossref output.nonnull
+      format.pages output
+    }
+  if$
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {book}
+{ output.bibitem
+  fa.isPersianLanguage
+  {
+	format.authors  output
+    new.block
+    format.btitle "title" output.check
+	new.block
+    format.translators output
+	format.editors  output
+  }
+  { author empty$
+      { format.editors "author and editor" output.check }
+      { format.authors output.nonnull
+        crossref missing$
+	      { "author and editor" editor either.or.check }
+	      'skip$
+        if$
+      }
+    if$
+    new.block
+    format.btitle "title" output.check
+  }  
+  if$
+  crossref missing$
+    { format.bvolume output
+      new.block
+      format.number.series output
+      new.sentence
+      publisher "publisher" output.check
+      address output
+    }
+    { new.block
+      format.book.crossref output.nonnull
+    }
+  if$
+  format.edition output
+  format.date "year" output.check
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {booklet}
+{ output.bibitem
+  format.authors output
+  new.block
+  format.title "title" output.check
+  howpublished address new.block.checkb
+  howpublished output
+  address output
+  format.date output
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {inbook}
+{ output.bibitem
+  author empty$
+    { format.editors "author and editor" output.check }
+    { format.authors output.nonnull
+      crossref missing$
+	{ "author and editor" editor either.or.check }
+	'skip$
+      if$
+    }
+  if$
+  new.block
+  format.btitle "title" output.check
+  crossref missing$
+    { format.bvolume output
+      format.chapter.pages "chapter and pages" output.check
+      new.block
+      format.number.series output
+      new.sentence
+      publisher "publisher" output.check
+      address output
+    }
+    { format.chapter.pages "chapter and pages" output.check
+      new.block
+      format.book.crossref output.nonnull
+    }
+  if$
+  format.edition output
+  format.date "year" output.check
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {incollection}
+{ output.bibitem
+  format.authors "author" output.check
+  new.block
+  format.title "title" output.check
+  new.block
+  crossref missing$
+    { format.in.ed.booktitle "booktitle" output.check
+      format.bvolume output
+      format.number.series output
+      format.chapter.pages output
+      new.sentence
+      publisher "publisher" output.check
+      address output
+      format.edition output
+      format.date "year" output.check
+    }
+    { format.incoll.inproc.crossref output.nonnull
+      format.chapter.pages output
+    }
+  if$
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {inproceedings}
+{ output.bibitem
+  format.authors "author" output.check
+  new.block
+  format.title "title" output.check
+  new.block
+  crossref missing$
+    { format.in.ed.booktitle "booktitle" output.check
+      format.bvolume output
+      format.number.series output
+      format.pages output
+      address empty$
+	{ organization publisher new.sentence.checkb
+	  organization output
+	  publisher output
+	  format.date "year" output.check
+	}
+	{ address output.nonnull
+	  format.date "year" output.check
+	  new.sentence
+	  organization output
+	  publisher output
+	}
+      if$
+    }
+    { format.incoll.inproc.crossref output.nonnull
+      format.pages output
+    }
+  if$
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {conference} { inproceedings }
+
+FUNCTION {manual}
+{ output.bibitem
+  author empty$
+    { organization empty$
+	'skip$
+	{ organization output.nonnull
+	  address output
+	}
+      if$
+    }
+    { format.authors output.nonnull }
+  if$
+  new.block
+  format.btitle "title" output.check
+  author empty$
+    { organization empty$
+	{ address new.block.checka
+	  address output
+	}
+	'skip$
+      if$
+    }
+    { organization address new.block.checkb
+      organization output
+      address output
+    }
+  if$
+  format.edition output
+  format.date output
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {mastersthesis}
+{ output.bibitem
+  format.authors "author" output.check
+  new.block
+  format.title "title" output.check
+  new.block
+  bbl.mthesis
+  format.thesis.type output.nonnull
+  school "school" output.check
+  address output
+  format.date "year" output.check
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {misc}
+{ output.bibitem
+  format.authors output
+  title howpublished new.block.checkb
+  format.title output
+  howpublished new.block.checka
+  howpublished output
+  format.date output
+  new.block
+  note output
+  fin.entry
+  empty.misc.check
+}
+
+FUNCTION {phdthesis}
+{ output.bibitem
+  format.authors "author" output.check
+  new.block
+  format.btitle "title" output.check
+  new.block
+  bbl.phdthesis
+  format.thesis.type output.nonnull
+  school "school" output.check
+  address output
+  format.date "year" output.check
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {proceedings}
+{ output.bibitem
+  editor empty$
+    { organization output }
+    { format.editors output.nonnull }
+  if$
+  new.block
+  format.btitle "title" output.check
+  format.bvolume output
+  format.number.series output
+  address empty$
+    { editor empty$
+	{ publisher new.sentence.checka }
+	{ organization publisher new.sentence.checkb
+	  organization output
+	}
+      if$
+      publisher output
+      format.date "year" output.check
+    }
+    { address output.nonnull
+      format.date "year" output.check
+      new.sentence
+      editor empty$
+	'skip$
+	{ organization output }
+      if$
+      publisher output
+    }
+  if$
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {techreport}
+{ output.bibitem
+  format.authors "author" output.check
+  new.block
+  format.title "title" output.check
+  new.block
+  format.tr.number output.nonnull
+  institution "institution" output.check
+  address output
+  format.date "year" output.check
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {unpublished}
+{ output.bibitem
+  format.authors "author" output.check
+  new.block
+  format.title "title" output.check
+  new.block
+  note "note" output.check
+  format.date output
+  fin.entry
+}
+
+FUNCTION {default.type} { misc }
+
+MACRO {jan} {"January"}
+
+MACRO {feb} {"February"}
+
+MACRO {mar} {"March"}
+
+MACRO {apr} {"April"}
+
+MACRO {may} {"May"}
+
+MACRO {jun} {"June"}
+
+MACRO {jul} {"July"}
+
+MACRO {aug} {"August"}
+
+MACRO {sep} {"September"}
+
+MACRO {oct} {"October"}
+
+MACRO {nov} {"November"}
+
+MACRO {dec} {"December"}
+
+MACRO {acmcs} {"ACM Computing Surveys"}
+
+MACRO {acta} {"Acta Informatica"}
+
+MACRO {cacm} {"Communications of the ACM"}
+
+MACRO {ibmjrd} {"IBM Journal of Research and Development"}
+
+MACRO {ibmsj} {"IBM Systems Journal"}
+
+MACRO {ieeese} {"IEEE Transactions on Software Engineering"}
+
+MACRO {ieeetc} {"IEEE Transactions on Computers"}
+
+MACRO {ieeetcad}
+ {"IEEE Transactions on Computer-Aided Design of Integrated Circuits"}
+
+MACRO {ipl} {"Information Processing Letters"}
+
+MACRO {jacm} {"Journal of the ACM"}
+
+MACRO {jcss} {"Journal of Computer and System Sciences"}
+
+MACRO {scp} {"Science of Computer Programming"}
+
+MACRO {sicomp} {"SIAM Journal on Computing"}
+
+MACRO {tocs} {"ACM Transactions on Computer Systems"}
+
+MACRO {tods} {"ACM Transactions on Database Systems"}
+
+MACRO {tog} {"ACM Transactions on Graphics"}
+
+MACRO {toms} {"ACM Transactions on Mathematical Software"}
+
+MACRO {toois} {"ACM Transactions on Office Information Systems"}
+
+MACRO {toplas} {"ACM Transactions on Programming Languages and Systems"}
+
+MACRO {tcs} {"Theoretical Computer Science"}
+
+READ
+
+FUNCTION {sortify}
+{ 
+  fa.isPersianLanguage
+    { "l" change.case$}
+    {purify$ "l" change.case$}
+  if$  
+  %duplicate$ write$
+}
+
+INTEGERS { len }
+
+FUNCTION {chop.word}
+{ 's :=
+  'len :=
+  s #1 len substring$ =
+    { s len #1 + global.max$ substring$ }
+    's
+  if$
+}
+
+FUNCTION {sort.format.names}
+{ 's :=
+  #1 'nameptr :=
+  ""
+  s num.names$ 'numnames :=
+  numnames 'namesleft :=
+    { namesleft #0 > }
+      { nameptr #1 >
+	    { "   " * }
+	    'skip$
+      if$
+      s nameptr "{vv{ } }{ll{ }}{  ff{ }}{  jj{ }}" format.name$ 't :=
+      nameptr numnames = t "others" = and
+	   { bbl.etal * }
+	   %{ t write$ t sortify * t write$	   }
+	   { t sortify * }
+      if$
+	  nameptr #1 + 'nameptr :=
+      namesleft #1 - 'namesleft :=
+    }
+  while$  
+}
+
+FUNCTION {sort.format.title}
+{ 't :=
+  "A " #2
+    "An " #3
+      "The " #4 t chop.word
+    chop.word
+  chop.word
+  sortify
+  #1 global.max$ substring$
+}
+
+FUNCTION {author.sort}
+{ author empty$
+    { key empty$
+	    { "to sort, need author or key in " cite$ * warning$
+	     ""
+	    }
+	    { key sortify }
+      if$
+    }
+    { author sort.format.names }
+  if$  
+}
+
+FUNCTION {author.editor.sort}
+{ author empty$
+    { editor empty$
+	{ key empty$
+	    { "to sort, need author, editor, or key in " cite$ * warning$
+	      ""
+	    }
+	    { key sortify }
+	  if$
+	}
+	{ editor sort.format.names }
+      if$
+    }
+    { author sort.format.names }
+  if$
+}
+
+FUNCTION {author.organization.sort}
+{ author empty$
+    { organization empty$
+	{ key empty$
+	    { "to sort, need author, organization, or key in " cite$ * warning$
+	      ""
+	    }
+	    { key sortify }
+	  if$
+	}
+	{ "The " #4 organization chop.word sortify }
+      if$
+    }
+    { author sort.format.names }
+  if$
+}
+
+FUNCTION {editor.organization.sort}
+{ editor empty$
+    { organization empty$
+	{ key empty$
+	    { "to sort, need editor, organization, or key in " cite$ * warning$
+	      ""
+	    }
+	    { key sortify }
+	  if$
+	}
+	{ "The " #4 organization chop.word sortify }
+      if$
+    }
+    { editor sort.format.names }
+  if$
+}
+
+FUNCTION {presort}
+{ type$ "book" =
+  type$ "inbook" =
+  or
+    'author.editor.sort
+    { type$ "proceedings" =
+	'editor.organization.sort
+	{ type$ "manual" =
+	    'author.organization.sort
+	    'author.sort
+	  if$
+	}
+      if$
+    }
+  if$
+  "    "
+  *
+  year field.or.null sortify
+  *
+  "    "
+  *
+  title field.or.null
+  sort.format.title
+  *
+  #1 entry.max$ substring$
+  'sort.key$ :=  
+}
+
+ITERATE {presort}
+
+SORT
+
+STRINGS { longest.label }
+
+INTEGERS { number.label longest.label.width }
+
+FUNCTION {initialize.longest.label}
+{ "" 'longest.label :=
+  #1 'number.label :=
+  #0 'longest.label.width :=
+}
+
+FUNCTION {longest.label.pass}
+{ number.label int.to.str$ 'label :=
+  number.label #1 + 'number.label :=
+  label width$ longest.label.width >
+    { label 'longest.label :=
+      label width$ 'longest.label.width :=
+    }
+    'skip$
+  if$
+}
+
+EXECUTE {banner.message}
+EXECUTE {initialize.longest.label}
+
+ITERATE {longest.label.pass}
+
+FUNCTION {begin.bib}
+{ 
+  "% Generated by plain-fa.bst,  version: " bst.file.version * " (" * bst.file.date * "), for XePersian Package" *
+  write$ newline$
+  "% Authors: " bst.file.authors *
+  write$ newline$
+  "\providecommand{\noopsort}[1]{}"
+  write$ newline$
+  preamble$ empty$
+    'skip$
+    { preamble$ write$ newline$ }
+  if$
+  "\begin{thebibliography}{"  longest.label  * "}" * write$ newline$
+}
+
+EXECUTE {begin.bib}
+
+EXECUTE {init.state.consts}
+
+ITERATE {call.type$}
+
+FUNCTION {end.bib}
+{ newline$
+  "\end{thebibliography}" write$ newline$
+  "\Persian" write$ newline$
+}
+
+EXECUTE {end.bib}
+EXECUTE{completed.message}
+%    \end{macrocode}
+% \iffalse
+%</plain-fa.bst>
+%<*unsrt-fa.bst>
+% \fi
+% \part{unsrt-fa.bst}
+%    \begin{macrocode}
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+%% Bib. style "usrt-fa", Persian (farsi)  version of unsrt.bst
+%%
+%% by: Mahmood Amintoosi and Mostafa Vahedi
+%% For XePersian, a Persian Typsetting Package in XeTeX, Developed by:
+%% Vafa Khalighi, Mehdi Omidali and Mostafa Vahedi 
+%% 2009/02/09
+%% It may be distributed and/or modified under the
+%% conditions of the LaTeX Project Public License, either this version
+%% of this license or (at your option) any later version.
+%%
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+%% Original Copyright
+% BibTeX standard bibliography style `unsrt'
+	% version 0.99a for BibTeX versions 0.99a or later, LaTeX version 2.09.
+	% Copyright (C) 1985, all rights reserved.
+	% Copying of this file is authorized only if either
+	% (1) you make absolutely no changes to your copy, including name, or
+	% (2) if you do make changes, you name it something other than
+	% btxbst.doc, plain.bst, unsrt.bst, alpha.bst, and abbrv.bst.
+	% This restriction helps ensure that all standard styles are identical.
+	% The file btxbst.doc has the documentation for this style.
+
+%%%%%%%%%%% History:
+% 2009/02/07: v.1, First Release
+% 2009/02/08: v.2, Some bugs fixed
+% 2009/02/09: v.21, I have to check the persian language in format.edition, because in Persian, "edition" lies before the edition number. 
+% 2009/02/09: v.22, I added a field Translator for translated books
+
+
+ENTRY
+  { address
+    author
+    booktitle
+    chapter
+    edition
+    editor
+    howpublished
+    institution
+    journal
+    key
+	language
+    month
+    note
+    number
+    organization
+    pages
+    publisher
+    school
+    series
+    title
+	translator
+    type
+    volume
+    year
+  }
+  {}
+  { label }
+
+INTEGERS { output.state before.all mid.sentence after.sentence after.block }
+STRINGS {bbl.and bbl.etal bbl.editors bbl.editor bbl.edition bbl.volume bbl.of bbl.number
+		 bbl.in bbl.pages bbl.page bbl.chapter bbl.series bbl.techrep bbl.mthesis bbl.phdthesis 
+		 bbl.translator }
+FUNCTION {is.print.banners.to.terminal} { #1 }
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+%% FILE VERSION AND BANNER %%
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+
+FUNCTION{bst.file.version} { "0.22" }
+FUNCTION{bst.file.date} { "2009/02/09" }
+FUNCTION{bst.file.website} { "http://parsilatex.org/" }
+FUNCTION{bst.file.authors} {"M.Amintoosi and M.Vahedi" }
+
+FUNCTION {banner.message}
+{ is.print.banners.to.terminal
+     { "-- unsrt-fa.bst version" " " * bst.file.version *
+       " (" * bst.file.date * ") " * %"by " * bst.file.authors *
+       top$
+       "-- This is a BibTeX style for XePersian: " bst.file.website *
+       %top$
+       %"-- See the " quote$ * "xepersian_bibtex_userguide.pdf" * quote$ * " manual for usage information." *
+       top$
+     }
+     { skip$ }
+   if$
+}
+
+FUNCTION {completed.message}
+{ is.print.banners.to.terminal
+     { ""
+       top$
+       "Done."
+       top$
+     }
+     { skip$ }
+   if$
+}
+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+%% Persian Functions	   %%
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+
+FUNCTION {fa.isPersianLanguage}
+{
+  language missing$
+    {#0}
+    {language "l" change.case$ "persian" =}
+  if$
+}
+
+FUNCTION {keywords.fa}
+{
+  " ?? " 			'bbl.and 		:=
+  " ?? ????????????" 		'bbl.etal 		:=
+  " ???????????????????? " 	'bbl.editors 	:=
+  " ??????????????????? " 		'bbl.editor 	:=
+  " ???????????? " 		'bbl.edition    :=
+  " ?????? " 			'bbl.volume		:=
+  " ???? " 			'bbl.of			:=
+  " ?????????? " 			'bbl.number		:=
+  " ???? " 			'bbl.in 		:=
+  " ?????????? " 		'bbl.pages 		:=
+  " ??." 			'bbl.page 		:=
+  " ?????? " 			'bbl.chapter	:=
+  " ?????? "				'bbl.series		:=
+  " ?????????? ?????? ????????????"	'bbl.techrep	:=
+  " ????????????????????? ???????????????????????????" 'bbl.mthesis 	:=
+  " ????????????????????? ??????????" 		'bbl.phdthesis	:=   
+  " ??????????????? "					'bbl.translator :=
+}
+
+FUNCTION {keywords.en}
+{
+  " and " 			'bbl.and 		:=
+  " et~al." 		'bbl.etal 		:=
+  " eds." 			'bbl.editors 	:=
+  " ed." 			'bbl.editor 	:=
+  " ed." 			'bbl.edition    :=
+  " Vol." 			'bbl.volume		:=
+  " of " 			'bbl.of			:=
+  " No." 			'bbl.number		:=
+  " In " 			'bbl.in 		:=
+  " pp." 			'bbl.pages 		:=
+  " p." 			'bbl.page 		:=
+  " Ch." 			'bbl.chapter	:=
+  " Ser."			'bbl.series		:=
+  " Tech. Rep."		'bbl.techrep	:=
+  " Master's thesis" 'bbl.mthesis 	:=
+  " Ph.D. disseration"  'bbl.phdthesis	:=   
+  " Translator "	'bbl.translator :=
+}
+
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+%% End of Persian Functions %%
+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+
+
+FUNCTION {init.state.consts}
+{ #0 'before.all :=
+  #1 'mid.sentence :=
+  #2 'after.sentence :=
+  #3 'after.block :=
+}
+
+STRINGS { s t }
+
+FUNCTION {output.nonnull}
+{ 's :=
+  output.state mid.sentence =
+    { ", " * write$ }
+    { output.state after.block =
+	{ add.period$ write$
+	  newline$
+	  "\newblock " write$
+	}
+	{ output.state before.all =
+	    'write$
+	    { add.period$ " " * write$ }
+	  if$
+	}
+      if$
+      mid.sentence 'output.state :=
+    }
+  if$
+  s
+}
+
+FUNCTION {output}
+{ duplicate$ empty$
+    'pop$
+    'output.nonnull
+  if$
+}
+
+FUNCTION {output.check}
+{ 't :=
+  duplicate$ empty$
+    { pop$ "empty " t * " in " * cite$ * warning$ }
+    'output.nonnull
+  if$
+}
+
+FUNCTION {output.bibitem}
+{ newline$
+  fa.isPersianLanguage
+    { keywords.fa
+	  "\Persian" write$
+      newline$ }
+    { keywords.en
+	  "\Latin" write$
+      newline$ }
+  if$
+  "\bibitem{" write$
+  cite$ write$
+  "}" write$
+  newline$
+  ""
+  before.all 'output.state :=
+}
+
+FUNCTION {fin.entry}
+{ add.period$
+  write$
+  newline$
+}
+
+FUNCTION {new.block}
+{ output.state before.all =
+    'skip$
+    { after.block 'output.state := }
+  if$
+}
+
+FUNCTION {new.sentence}
+{ output.state after.block =
+    'skip$
+    { output.state before.all =
+	'skip$
+	{ after.sentence 'output.state := }
+      if$
+    }
+  if$
+}
+
+FUNCTION {not}
+{   { #0 }
+    { #1 }
+  if$
+}
+
+FUNCTION {and}
+{   'skip$
+    { pop$ #0 }
+  if$
+}
+
+FUNCTION {or}
+{   { pop$ #1 }
+    'skip$
+  if$
+}
+
+FUNCTION {new.block.checka}
+{ empty$
+    'skip$
+    'new.block
+  if$
+}
+
+FUNCTION {new.block.checkb}
+{ empty$
+  swap$ empty$
+  and
+    'skip$
+    'new.block
+  if$
+}
+
+FUNCTION {new.sentence.checka}
+{ empty$
+    'skip$
+    'new.sentence
+  if$
+}
+
+FUNCTION {new.sentence.checkb}
+{ empty$
+  swap$ empty$
+  and
+    'skip$
+    'new.sentence
+  if$
+}
+
+FUNCTION {field.or.null}
+{ duplicate$ empty$
+    { pop$ "" }
+    'skip$
+  if$
+}
+
+FUNCTION {emphasize}
+{ duplicate$ empty$
+    { pop$ "" }
+    { "{\em " swap$ * "}" * }
+  if$
+}
+
+INTEGERS { nameptr namesleft numnames }
+
+FUNCTION {format.names}
+{ 's :=
+  #1 'nameptr :=
+  s num.names$ 'numnames :=
+  numnames 'namesleft :=
+    { namesleft #0 > }
+    { s nameptr "{vv~}{ll}{, jj}{, ff}" format.name$ 't := %{ff}{vv~}{ll}{, jj}
+      nameptr #1 >
+	{ namesleft #1 >
+	    { ", " * t * }
+	    { numnames #2 >
+		{ "," * }
+		'skip$
+	      if$
+		  t "others" =
+		     { bbl.etal * }
+		     { bbl.and * t * }
+	      if$
+		}
+	  if$
+	}
+	't
+      if$
+      nameptr #1 + 'nameptr :=
+      namesleft #1 - 'namesleft :=
+    }
+  while$
+}
+
+FUNCTION {format.authors}
+{ author empty$
+    { "" }
+    { author format.names }
+  if$
+}
+
+FUNCTION {format.editors}
+{ editor empty$
+    { "" }
+    { fa.isPersianLanguage
+	    {
+		editor num.names$ #1 >
+			{bbl.editors editor format.names * }
+			{bbl.editor editor format.names * }
+		if$
+		}
+		{
+ 		editor format.names
+		editor num.names$ #1 >
+			{ ", " bbl.editors * *}
+			{ ", " bbl.editor * *}
+		if$
+		}
+	  if$	
+    }
+  if$
+}
+
+FUNCTION {format.translators}
+{ translator empty$
+    { "" }
+    { fa.isPersianLanguage
+	    {
+		bbl.translator translator format.names *
+		}
+		{
+ 		translator format.names
+		", " bbl.translator * *
+		}
+	  if$	
+    }
+  if$
+}
+
+FUNCTION {format.title}
+{ title empty$
+    { "" }
+    { title "t" change.case$ }
+  if$
+}
+
+FUNCTION {n.dashify}
+{ 't :=
+  ""
+    { t empty$ not }
+    { t #1 #1 substring$ "-" =
+	{ t #1 #2 substring$ "--" = not
+	    { "--" *
+	      t #2 global.max$ substring$ 't :=
+	    }
+	    {   { t #1 #1 substring$ "-" = }
+		{ "-" *
+		  t #2 global.max$ substring$ 't :=
+		}
+	      while$
+	    }
+	  if$
+	}
+	{ t #1 #1 substring$ *
+	  t #2 global.max$ substring$ 't :=
+	}
+      if$
+    }
+  while$
+}
+
+FUNCTION {format.date}
+{ year empty$
+    { month empty$
+	{ "" }
+	{ "there's a month but no year in " cite$ * warning$
+	  month
+	}
+      if$
+    }
+    { month empty$
+	'year
+	{ month " " * year * }
+      if$
+    }
+  if$
+}
+
+FUNCTION {format.btitle}
+{ title emphasize
+}
+
+FUNCTION {tie.or.space.connect}
+{ duplicate$ text.length$ #3 <
+    { "~" }
+    { " " }
+  if$
+  swap$ * *
+}
+
+FUNCTION {either.or.check}
+{ empty$
+    'pop$
+    { "can't use both " swap$ * " fields in " * cite$ * warning$ }
+  if$
+}
+
+FUNCTION {format.bvolume}
+{ volume empty$
+    { "" }
+    { bbl.volume volume tie.or.space.connect
+      series empty$
+	'skip$
+	{ bbl.of * series emphasize * }
+      if$
+      "volume and number" number either.or.check
+    }
+  if$
+}
+
+FUNCTION {format.number.series}
+{ volume empty$
+    { number empty$
+	{ series field.or.null }
+	{ output.state mid.sentence =
+	    { bbl.number }
+	    { bbl.number "t" change.case$ }
+	  if$
+	  number tie.or.space.connect
+	  series empty$
+	    { "there's a number but no series in " cite$ * warning$ }
+	    { bbl.in * series * }
+	  if$
+	}
+      if$
+    }
+    { "" }
+  if$
+}
+
+FUNCTION {format.edition}
+{ edition empty$
+    { "" }
+    { fa.isPersianLanguage
+	    {
+		   bbl.edition edition * 
+		}
+		{
+	      output.state mid.sentence =
+	       { edition "l" change.case$ bbl.edition * }
+	       { edition "t" change.case$ bbl.edition * }
+          if$
+		}
+	  if$	
+    }
+  if$
+}
+
+INTEGERS { multiresult }
+
+FUNCTION {multi.page.check}
+{ 't :=
+  #0 'multiresult :=
+    { multiresult not
+      t empty$ not
+      and
+    }
+    { t #1 #1 substring$
+      duplicate$ "-" =
+      swap$ duplicate$ "," =
+      swap$ "+" =
+      or or
+	{ #1 'multiresult := }
+	{ t #2 global.max$ substring$ 't := }
+      if$
+    }
+  while$
+  multiresult
+}
+
+FUNCTION {format.pages}
+{ pages empty$
+    { "" }
+	{  pages multi.page.check
+	    { bbl.pages pages n.dashify tie.or.space.connect }
+	    { bbl.page pages tie.or.space.connect }
+       if$
+    }
+  if$
+}
+
+FUNCTION {format.vol.num.pages}
+{ volume field.or.null
+  number empty$
+    'skip$
+    { "(" number * ")" * *
+      volume empty$
+	{ "there's a number but no volume in " cite$ * warning$ }
+	'skip$
+      if$
+    }
+  if$
+  pages empty$
+    'skip$
+    { duplicate$ empty$
+	{ pop$ format.pages }
+	{ ":" * pages n.dashify * }
+      if$
+    }
+  if$
+}
+
+FUNCTION {format.chapter.pages}
+{ chapter empty$
+    'format.pages
+    { type empty$
+	{ bbl.chapter }
+	{ type "l" change.case$ }
+      if$
+      chapter tie.or.space.connect
+      pages empty$
+	'skip$
+	{ ", " * format.pages * }
+      if$
+    }
+  if$
+}
+
+FUNCTION {format.in.ed.booktitle}
+{ 
+  booktitle empty$
+    { "" }
+    { editor empty$
+	    { bbl.in booktitle emphasize * }
+	    { bbl.in format.editors * ", " * booktitle emphasize * }
+	  if$
+	}  
+  if$
+}
+
+FUNCTION {empty.misc.check}
+{ author empty$ title empty$ howpublished empty$
+  month empty$ year empty$ note empty$
+  and and and and and
+    { "all relevant fields are empty in " cite$ * warning$ }
+    'skip$
+  if$
+}
+
+FUNCTION {format.thesis.type}
+{ type empty$
+    'skip$
+    { pop$
+      type "t" change.case$
+    }
+  if$
+}
+
+FUNCTION {format.tr.number}
+{ type empty$
+    { bbl.techrep }
+    'type
+  if$
+  number empty$
+    { "t" change.case$ }
+    { number tie.or.space.connect }
+  if$
+}
+
+FUNCTION {format.article.crossref}
+{ key empty$
+    { journal empty$
+	{ "need key or journal for " cite$ * " to crossref " * crossref *
+	  warning$
+	  ""
+	}
+	{ bbl.in "{\em " * journal * "\/}" * }
+      if$
+    }
+    { bbl.in key * }
+  if$
+  " \cite{" * crossref * "}" *
+}
+
+FUNCTION {format.crossref.editor}
+{ editor #1 "{vv~}{ll}" format.name$
+  editor num.names$ duplicate$  #2 >
+    { pop$ bbl.etal * }
+    { #2 < 'skip$
+	    { editor #2 "{ff }{vv }{ll}{ jj}" format.name$ "others" =
+	      { bbl.etal * }
+	      { bbl.and * editor #2 "{vv~}{ll}" format.name$ * }
+	    if$
+	    }			
+    if$
+    }
+  if$
+}
+
+FUNCTION {format.book.crossref}
+{ volume empty$
+    { "empty volume in " cite$ * "'s crossref of " * crossref * warning$
+      bbl.in
+    }
+    { bbl.volume volume tie.or.space.connect
+      bbl.of *
+    }
+  if$
+  editor empty$
+  editor field.or.null author field.or.null =
+  or
+    { key empty$
+	{ series empty$
+	    { "need editor, key, or series for " cite$ * " to crossref " *
+	      crossref * warning$
+	      "" *
+	    }
+	    { "{\em " * series * "\/}" * }
+	  if$
+	}
+	{ key * }
+      if$
+    }
+    { format.crossref.editor * }
+  if$
+  " \cite{" * crossref * "}" *
+}
+
+FUNCTION {format.incoll.inproc.crossref}
+{ editor empty$
+  editor field.or.null author field.or.null =
+  or
+    { key empty$
+	{ booktitle empty$
+	    { "need editor, key, or booktitle for " cite$ * " to crossref " *
+	      crossref * warning$
+	      ""
+	    }
+	    { bbl.in " {\em " * booktitle * "\/}" * }
+	  if$
+	}
+	{ bbl.in key * }
+      if$
+    }
+    { bbl.in format.crossref.editor * }
+  if$
+  " \cite{" * crossref * "}" *
+}
+
+FUNCTION {article}
+{ output.bibitem
+  format.authors "author" output.check
+  new.block
+  format.title "title" output.check
+  new.block
+  crossref missing$
+    { journal emphasize "journal" output.check
+      format.vol.num.pages output
+      format.date "year" output.check
+    }
+    { format.article.crossref output.nonnull
+      format.pages output
+    }
+  if$
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {book}
+{ output.bibitem
+  fa.isPersianLanguage
+  {
+	format.authors  output
+    new.block
+    format.btitle "title" output.check
+	new.block
+    format.translators output
+	format.editors  output
+  }
+  { author empty$
+      { format.editors "author and editor" output.check }
+      { format.authors output.nonnull
+        crossref missing$
+	      { "author and editor" editor either.or.check }
+	      'skip$
+        if$
+      }
+    if$
+    new.block
+    format.btitle "title" output.check
+  }  
+  if$
+  crossref missing$
+    { format.bvolume output
+      new.block
+      format.number.series output
+      new.sentence
+      publisher "publisher" output.check
+      address output
+    }
+    { new.block
+      format.book.crossref output.nonnull
+    }
+  if$
+  format.edition output
+  format.date "year" output.check
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {booklet}
+{ output.bibitem
+  format.authors output
+  new.block
+  format.title "title" output.check
+  howpublished address new.block.checkb
+  howpublished output
+  address output
+  format.date output
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {inbook}
+{ output.bibitem
+  author empty$
+    { format.editors "author and editor" output.check }
+    { format.authors output.nonnull
+      crossref missing$
+	{ "author and editor" editor either.or.check }
+	'skip$
+      if$
+    }
+  if$
+  new.block
+  format.btitle "title" output.check
+  crossref missing$
+    { format.bvolume output
+      format.chapter.pages "chapter and pages" output.check
+      new.block
+      format.number.series output
+      new.sentence
+      publisher "publisher" output.check
+      address output
+    }
+    { format.chapter.pages "chapter and pages" output.check
+      new.block
+      format.book.crossref output.nonnull
+    }
+  if$
+  format.edition output
+  format.date "year" output.check
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {incollection}
+{ output.bibitem
+  format.authors "author" output.check
+  new.block
+  format.title "title" output.check
+  new.block
+  crossref missing$
+    { format.in.ed.booktitle "booktitle" output.check
+      format.bvolume output
+      format.number.series output
+      format.chapter.pages output
+      new.sentence
+      publisher "publisher" output.check
+      address output
+      format.edition output
+      format.date "year" output.check
+    }
+    { format.incoll.inproc.crossref output.nonnull
+      format.chapter.pages output
+    }
+  if$
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {inproceedings}
+{ output.bibitem
+  format.authors "author" output.check
+  new.block
+  format.title "title" output.check
+  new.block
+  crossref missing$
+    { format.in.ed.booktitle "booktitle" output.check
+      format.bvolume output
+      format.number.series output
+      format.pages output
+      address empty$
+	{ organization publisher new.sentence.checkb
+	  organization output
+	  publisher output
+	  format.date "year" output.check
+	}
+	{ address output.nonnull
+	  format.date "year" output.check
+	  new.sentence
+	  organization output
+	  publisher output
+	}
+      if$
+    }
+    { format.incoll.inproc.crossref output.nonnull
+      format.pages output
+    }
+  if$
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {conference} { inproceedings }
+
+FUNCTION {manual}
+{ output.bibitem
+  author empty$
+    { organization empty$
+	'skip$
+	{ organization output.nonnull
+	  address output
+	}
+      if$
+    }
+    { format.authors output.nonnull }
+  if$
+  new.block
+  format.btitle "title" output.check
+  author empty$
+    { organization empty$
+	{ address new.block.checka
+	  address output
+	}
+	'skip$
+      if$
+    }
+    { organization address new.block.checkb
+      organization output
+      address output
+    }
+  if$
+  format.edition output
+  format.date output
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {mastersthesis}
+{ output.bibitem
+  format.authors "author" output.check
+  new.block
+  format.title "title" output.check
+  new.block
+  bbl.mthesis  
+  format.thesis.type output.nonnull
+  school "school" output.check
+  address output
+  format.date "year" output.check
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {misc}
+{ output.bibitem
+  format.authors output
+  title howpublished new.block.checkb
+  format.title output
+  howpublished new.block.checka
+  howpublished output
+  format.date output
+  new.block
+  note output
+  fin.entry
+  empty.misc.check
+}
+
+FUNCTION {phdthesis}
+{ output.bibitem
+  format.authors "author" output.check
+  new.block
+  format.btitle "title" output.check
+  new.block
+  bbl.phdthesis
+  format.thesis.type output.nonnull
+  school "school" output.check
+  address output
+  format.date "year" output.check
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {proceedings}
+{ output.bibitem
+  editor empty$
+    { organization output }
+    { format.editors output.nonnull }
+  if$
+  new.block
+  format.btitle "title" output.check
+  format.bvolume output
+  format.number.series output
+  address empty$
+    { editor empty$
+	{ publisher new.sentence.checka }
+	{ organization publisher new.sentence.checkb
+	  organization output
+	}
+      if$
+      publisher output
+      format.date "year" output.check
+    }
+    { address output.nonnull
+      format.date "year" output.check
+      new.sentence
+      editor empty$
+	'skip$
+	{ organization output }
+      if$
+      publisher output
+    }
+  if$
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {techreport}
+{ output.bibitem
+  format.authors "author" output.check
+  new.block
+  format.title "title" output.check
+  new.block
+  format.tr.number output.nonnull
+  institution "institution" output.check
+  address output
+  format.date "year" output.check
+  new.block
+  note output
+  fin.entry
+}
+
+FUNCTION {unpublished}
+{ output.bibitem
+  format.authors "author" output.check
+  new.block
+  format.title "title" output.check
+  new.block
+  note "note" output.check
+  format.date output
+  fin.entry
+}
+
+FUNCTION {default.type} { misc }
+
+MACRO {jan} {"January"}
+
+MACRO {feb} {"February"}
+
+MACRO {mar} {"March"}
+
+MACRO {apr} {"April"}
+
+MACRO {may} {"May"}
+
+MACRO {jun} {"June"}
+
+MACRO {jul} {"July"}
+
+MACRO {aug} {"August"}
+
+MACRO {sep} {"September"}
+
+MACRO {oct} {"October"}
+
+MACRO {nov} {"November"}
+
+MACRO {dec} {"December"}
+
+MACRO {acmcs} {"ACM Computing Surveys"}
+
+MACRO {acta} {"Acta Informatica"}
+
+MACRO {cacm} {"Communications of the ACM"}
+
+MACRO {ibmjrd} {"IBM Journal of Research and Development"}
+
+MACRO {ibmsj} {"IBM Systems Journal"}
+
+MACRO {ieeese} {"IEEE Transactions on Software Engineering"}
+
+MACRO {ieeetc} {"IEEE Transactions on Computers"}
+
+MACRO {ieeetcad}
+ {"IEEE Transactions on Computer-Aided Design of Integrated Circuits"}
+
+MACRO {ipl} {"Information Processing Letters"}
+
+MACRO {jacm} {"Journal of the ACM"}
+
+MACRO {jcss} {"Journal of Computer and System Sciences"}
+
+MACRO {scp} {"Science of Computer Programming"}
+
+MACRO {sicomp} {"SIAM Journal on Computing"}
+
+MACRO {tocs} {"ACM Transactions on Computer Systems"}
+
+MACRO {tods} {"ACM Transactions on Database Systems"}
+
+MACRO {tog} {"ACM Transactions on Graphics"}
+
+MACRO {toms} {"ACM Transactions on Mathematical Software"}
+
+MACRO {toois} {"ACM Transactions on Office Information Systems"}
+
+MACRO {toplas} {"ACM Transactions on Programming Languages and Systems"}
+
+MACRO {tcs} {"Theoretical Computer Science"}
+
+READ
+
+STRINGS { longest.label }
+
+INTEGERS { number.label longest.label.width }
+
+FUNCTION {initialize.longest.label}
+{ "" 'longest.label :=
+  #1 'number.label :=
+  #0 'longest.label.width :=
+}
+
+FUNCTION {longest.label.pass}
+{ number.label int.to.str$ 'label :=
+  number.label #1 + 'number.label :=
+  label width$ longest.label.width >
+    { label 'longest.label :=
+      label width$ 'longest.label.width :=
+    }
+    'skip$
+  if$
+}
+
+EXECUTE {banner.message}
+EXECUTE {initialize.longest.label}
+
+ITERATE {longest.label.pass}
+
+FUNCTION {begin.bib}
+{ 
+  "% Generated by unsrt-fa.bst,  version: " bst.file.version * " (" * bst.file.date * "), for XePersian Package" *
+  write$ newline$
+  "% Authors: " bst.file.authors *
+  write$ newline$
+  "\providecommand{\noopsort}[1]{}"
+  write$ newline$
+  preamble$ empty$
+    'skip$
+    { preamble$ write$ newline$ }
+  if$
+  "\begin{thebibliography}{"  longest.label  * "}" * write$ newline$
+}
+
+EXECUTE {begin.bib}
+
+EXECUTE {init.state.consts}
+
+ITERATE {call.type$}
+
+FUNCTION {end.bib}
+{ newline$
+  "\end{thebibliography}" write$ newline$
+  "\Persian" write$ newline$
+}
+
+EXECUTE {end.bib}
+EXECUTE{completed.message}
+%    \end{macrocode}
+% \iffalse
+%</unsrt-fa.bst>
+% \fi
+% \clearpage
+% \PrintChanges
+% \Finale
+% 
+% \iffalse
+%<*parsidigits.map>
+; Vafa Khalighi ... 
+LHSName	"Digits"
+RHSName	"ParsiDigits"
+
+pass(Unicode)
+U+0030 <> U+06F0 ;
+U+0031 <> U+06F1 ;
+U+0032 <> U+06F2 ;
+U+0033 <> U+06F3 ;
+U+0034 <> U+06F4 ;
+U+0035 <> U+06F5 ;
+U+0036 <> U+06F6 ;
+U+0037 <> U+06F7 ;
+U+0038 <> U+06F8 ;
+U+0039 <> U+06F9 ;
+
+U+0644 U+0651 U+064E U+0627 <> U+0644 U+0627 U+0651 U+064E ; lam shadda fatha alif -> lam alif shadda fatha 
+U+0644 U+0651 U+0627 <> U+0644 U+0627 U+0651  ; lam shadda alif -> lam alif shadda
+U+0644 U+0652 U+0622 <> U+0644 U+0622 U+0652  ; lam sukun alifmadda -> lam alifmadda sukun 
+U+0644 U+0652 U+0623 <> U+0644 U+0623 U+0652  ; lam sukun alifhamzaabove -> lam alifhamzaabove sukun 
+U+0644 U+0652 U+0625 <> U+0644 U+0625 U+0652  ; lam sukun alifhamzabelow -> lam alifhamzabelow sukun
+U+0644 U+0651 U+064B U+0627 <> U+0644 U+0627 U+0651 U+064b ; lam shadda fathatan alif -> lam alif shadda fathatan
+U+0644 U+064B U+0627 <> U+0644 U+0627 U+064B ; lam fathatan alif -> lam alif fathatan
+
+U+002C <> U+060C ; comma ??> arabic comma
+U+003F <> U+061F ; question mark -> arabic qm
+U+003B <> U+061B ; semicolon -> arabic semicolon
+
+; ligatures from Knuth's original CMR fonts
+U+002D U+002D			<>	U+2013	; -- -> en dash
+U+002D U+002D U+002D	<>	U+2014	; --- -> em dash
+
+U+0027			<>	U+2019	; ' -> right single quote
+U+0027 U+0027	<>	U+201D	; '' -> right double quote
+U+0022			 >	U+201D	; " -> right double quote
+
+U+0060			<>	U+2018	; ` -> left single quote
+U+0060 U+0060	<>	U+201C	; `` -> left double quote
+
+U+0021 U+0060	<>	U+00A1	; !` -> inverted exclam
+U+003F U+0060	<>	U+00BF	; ?` -> inverted question
+
+; additions supported in T1 encoding
+U+002C U+002C	<>	U+201E	; ,, -> DOUBLE LOW-9 QUOTATION MARK
+U+003C U+003C	<>	U+00AB	; << -> LEFT POINTING GUILLEMET
+U+003E U+003E	<>	U+00BB	; >> -> RIGHT POINTING GUILLEMET
+%</parsidigits.map>
+%<*txt2maths.map>
+EncodingName "XePersian-2009"
+DescriptiveName "VAFA KHALIGHI"
+Version "0.1"
+Contact "mailto:vafa.khalighi at students.mq.edu.au"
+RegistrationAuthority "VAFA KHALIGHI"
+RegistrationName "CONVERSION OF TEXT CHARACTERS TO THEIR CORRESPONDING MATHS CHARACTERS"
+Copyright "(c)2009 VAFA KHALIGHI"
+LHSFlags ()
+RHSFlags (ExpectsNFD GeneratesNFD)
+Pass(Unicode)
+U+002E <> U+066B ; convert dot to Persian decimal separator
+U+002D <> U+2212 ; convert hyphen to minus sign
+U+0030 <> U+06F0 ;
+U+0031 <> U+06F1 ;
+U+0032 <> U+06F2 ;
+U+0033 <> U+06F3 ;
+U+0034 <> U+06F4 ;
+U+0035 <> U+06F5 ;
+U+0036 <> U+06F6 ;
+U+0037 <> U+06F7 ;
+U+0038 <> U+06F8 ;
+U+0039 <> U+06F9 ;
+
+U+0644 U+0651 U+064E U+0627 <> U+0644 U+0627 U+0651 U+064E ; lam shadda fatha alif -> lam alif shadda fatha 
+U+0644 U+0651 U+0627 <> U+0644 U+0627 U+0651  ; lam shadda alif -> lam alif shadda
+U+0644 U+0652 U+0622 <> U+0644 U+0622 U+0652  ; lam sukun alifmadda -> lam alifmadda sukun 
+U+0644 U+0652 U+0623 <> U+0644 U+0623 U+0652  ; lam sukun alifhamzaabove -> lam alifhamzaabove sukun 
+U+0644 U+0652 U+0625 <> U+0644 U+0625 U+0652  ; lam sukun alifhamzabelow -> lam alifhamzabelow sukun
+U+0644 U+0651 U+064B U+0627 <> U+0644 U+0627 U+0651 U+064b ; lam shadda fathatan alif -> lam alif shadda fathatan
+U+0644 U+064B U+0627 <> U+0644 U+0627 U+064B ; lam fathatan alif -> lam alif fathatan
+
+U+002C <> U+060C ; comma ??> arabic comma
+U+003F <> U+061F ; question mark -> arabic qm
+U+003B <> U+061B ; semicolon -> arabic semicolon
+
+; ligatures from Knuth's original CMR fonts
+U+002D U+002D			<>	U+2013	; -- -> en dash
+U+002D U+002D U+002D	<>	U+2014	; --- -> em dash
+
+U+0027			<>	U+2019	; ' -> right single quote
+U+0027 U+0027	<>	U+201D	; '' -> right double quote
+U+0022			 >	U+201D	; " -> right double quote
+
+U+0060			<>	U+2018	; ` -> left single quote
+U+0060 U+0060	<>	U+201C	; `` -> left double quote
+
+U+0021 U+0060	<>	U+00A1	; !` -> inverted exclam
+U+003F U+0060	<>	U+00BF	; ?` -> inverted question
+
+; additions supported in T1 encoding
+U+002C U+002C	<>	U+201E	; ,, -> DOUBLE LOW-9 QUOTATION MARK
+U+003C U+003C	<>	U+00AB	; << -> LEFT POINTING GUILLEMET
+U+003E U+003E	<>	U+00BB	; >> -> RIGHT POINTING GUILLEMET
+%</txt2maths.map>
+%<*ftxe-0.1.py>
+#########################################
+#       General Public License          #
+#       Author:  Mostafa Vahedi         #
+#       Date:    21 May 2009            #
+#       Version  0.1                    #
+#########################################
+
+import codecs
+
+import sys
+
+
+ft_numerical = [
+chr(0xB9),	# 	Arabic Thoushads Seperator
+chr(0xBC)	#	ARABIC DECIMAL SEPARATOR
+]
+
+
+ft_vowels = [
+chr(0xB0),	#	ARABIC FATHA
+chr(0xB1),	#	ARABIC KASRA
+chr(0xB2),	#	ARABIC DAMMA
+chr(0xB3),	#	ARABIC FATHATAN
+chr(0xB4),	#	ARABIC SHADDA
+chr(0xBA),	#	ARABIC LETTER SUPERSCRIPT ALEF
+chr(0xBB),	#	ARABIC HAMZA ABOVE
+chr(0xC4) 	#	ARABIC SUKUN
+]
+
+ft_non_joiners = [
+chr(0x8F)	#	ARABIC LETTER HAMZA
+]
+
+ft_bidi_joiners_initial = [
+chr(0xE4),	#	ARABIC LETTER AIN, initial form
+chr(0xE8),	#	ARABIC LETTER GHAIN, initial form
+chr(0xFB) 	#	ARABIC LETTER HEH, initial form
+]
+
+ft_bidi_joiners_medial = [
+chr(0xE3),	#	ARABIC LETTER AIN, medial form
+chr(0xE7),	#	ARABIC LETTER GHAIN, medial form
+chr(0xFA) 	#	ARABIC LETTER HEH, medial form
+]
+
+ft_bidi_joiners_final = [
+chr(0xE2),	#	ARABIC LETTER AIN, final form
+chr(0xE6),	#	ARABIC LETTER GHAIN, final form
+chr(0xFC) 	#	ARABIC LETTER FARSI YEH, final form
+]
+
+ft_bidi_joiners_isolated = [
+chr(0xE1),	#	ARABIC LETTER AIN, isolated form
+chr(0xE5),	#	ARABIC LETTER GHAIN, isolated form
+chr(0xFD) 	#	ARABIC LETTER FARSI YEH, isolated form
+]
+
+ft_bidi_joiners_initial_medial = [
+chr(0x8B),	#	ARABIC TATWEEL
+chr(0x8E),	#	ARABIC LETTER YEH WITH HAMZA ABOVE, initial-medial form
+chr(0x93),	#	ARABIC LETTER BEH, initial-medial form
+chr(0x95),	#	ARABIC LETTER PEH, initial-medial form
+chr(0x97),	#	ARABIC LETTER TEH, initial-medial form
+chr(0x99),	#	ARABIC LETTER THEH, initial-medial form
+chr(0x9B),	#	ARABIC LETTER JEEM, initial-medial form
+chr(0x9D),	#	ARABIC LETTER TCHEH, initial-medial form
+chr(0x9F),	#	ARABIC LETTER HAH, initial-medial form
+chr(0xA1),	#	ARABIC LETTER KHAH, initial-medial form
+chr(0xA8),	#	ARABIC LETTER SEEN, initial-medial form
+chr(0xAA),	#	ARABIC LETTER SHEEN, initial-medial form
+chr(0xAC),	#	ARABIC LETTER SAD, initial-medial form
+chr(0xAE),	#	ARABIC LETTER DAD, initial-medial form
+chr(0xAF),	#	ARABIC LETTER TAH, initial-medial form
+chr(0xE0),	#	ARABIC LETTER ZAH, initial-medial form
+chr(0xEA),	#	ARABIC LETTER FEH, initial-medial form
+chr(0xEC),	#	ARABIC LETTER QAF, initial-medial form
+chr(0xEE),	#	ARABIC LETTER KEHEH, initial-medial form
+chr(0xF0),	#	ARABIC LETTER GAF, initial-medial form
+chr(0xF3),	#	ARABIC LETTER LAM, initial-medial form
+chr(0xF5),	#	ARABIC LETTER MEEM, initial-medial form
+chr(0xF7),	#	ARABIC LETTER NOON, initial-medial form
+chr(0xFE)	#	ARABIC LETTER FARSI YEH, initial-medial form
+]
+
+ft_bidi_joiners_final_isolated = [
+chr(0x92),	#	ARABIC LETTER BEH, final-isolated form
+chr(0x94),	#	ARABIC LETTER PEH, final-isolated form
+chr(0x96),	#	ARABIC LETTER TEH, final-isolated form
+chr(0x98),	#	ARABIC LETTER THEH, final-isolated form
+chr(0x9A),	#	ARABIC LETTER JEEM, final-isolated form
+chr(0x9C),	#	ARABIC LETTER TCHEH, final-isolated form
+chr(0x9E),	#	ARABIC LETTER HAH, final-isolated form
+chr(0xA0),	#	ARABIC LETTER KHAH, final-isolated form
+chr(0xA7),	#	ARABIC LETTER SEEN, final-isolated form
+chr(0xA9),	#	ARABIC LETTER SHEEN, final-isolated form
+chr(0xAB),	#	ARABIC LETTER SAD, final-isolated form
+chr(0xAD),	#	ARABIC LETTER DAD, final-isolated form
+chr(0xC1),	#	ARABIC LETTER TAH, final-isolated form
+chr(0xC2),	#	ARABIC LETTER ZAH, final-isolated form
+chr(0xE9),	#	ARABIC LETTER FEH, final-isolated form
+chr(0xEB),	#	ARABIC LETTER QAF, final-isolated form
+chr(0xED),	#	ARABIC LETTER KEHEH, final-isolated form
+chr(0xEF),	#	ARABIC LETTER GAF, final-isolated form
+chr(0xF1),	#	ARABIC LETTER LAM, final-isolated form
+chr(0xF4),	#	ARABIC LETTER MEEM, final-isolated form
+chr(0xF6),	#	ARABIC LETTER NOON, final-isolated form
+chr(0xF9) 	#	ARABIC LETTER HEH, final-isolated form
+]
+
+ft_right_joiners_final = [
+chr(0x91)	#	ARABIC LETTER ALEF, final form
+]
+
+ft_right_joiners_isolated = [
+chr(0x8D),	#	ARABIC LETTER ALEF WITH MADDA ABOVE, isolated form
+chr(0x90)	#	ARABIC LETTER ALEF, isolated form
+]
+
+ft_right_joiners_final_isolated = [
+chr(0xA2),	#	ARABIC LETTER DAL
+chr(0xA3),	#	ARABIC LETTER THAL
+chr(0xA4),	#	ARABIC LETTER REH
+chr(0xA5),	#	ARABIC LETTER ZAIN
+chr(0xA6),	#	ARABIC LETTER JEH
+chr(0xBF),	#	ARABIC LETTER TEH MARBUTAH
+chr(0xF2),	#	ARABIC LIGATURE LAM WITH ALEF
+chr(0xF8)	#	ARABIC LETTER WAW
+]
+
+
+table_FT_UN = {
+chr(0x80) : [u'\u06F0'],	#	EXTENDED ARABIC-INDIC DIGIT ZERO
+chr(0x81) : [u'\u06F1'],	#	EXTENDED ARABIC-INDIC DIGIT ONE
+chr(0x82) : [u'\u06F2'],	#	EXTENDED ARABIC-INDIC DIGIT TWO
+chr(0x83) : [u'\u06F3'],	#	EXTENDED ARABIC-INDIC DIGIT THREE
+chr(0x84) : [u'\u06F4'],	#	EXTENDED ARABIC-INDIC DIGIT FOUR
+chr(0x85) : [u'\u06F5'],	#	EXTENDED ARABIC-INDIC DIGIT FIVE
+chr(0x86) : [u'\u06F6'],	#	EXTENDED ARABIC-INDIC DIGIT SIX
+chr(0x87) : [u'\u06F7'],	#	EXTENDED ARABIC-INDIC DIGIT SEVEN
+chr(0x88) : [u'\u06F8'],	#	EXTENDED ARABIC-INDIC DIGIT EIGHT
+chr(0x89) : [u'\u06F9'],	#	EXTENDED ARABIC-INDIC DIGIT NINE
+chr(0x8A) : [u'\u060C'],	#	ARABIC COMMA
+chr(0x8B) : [u'\u0640'],	#	ARABIC TATWEEL
+chr(0x8C) : [u'\u061F'],	#	ARABIC QUESTION MARK
+chr(0x8D) : [u'\u0622'],	#	ARABIC LETTER ALEF WITH MADDA ABOVE, isolated form
+chr(0x8E) : [u'\u0626'],	#	ARABIC LETTER YEH WITH HAMZA ABOVE, initial-medial form
+chr(0x8F) : [u'\u0621'],	#	ARABIC LETTER HAMZA
+chr(0x90) : [u'\u0627'],	#	ARABIC LETTER ALEF, isolated form
+chr(0x91) : [u'\u0627'],	#	ARABIC LETTER ALEF, final form
+chr(0x92) : [u'\u0628'],	#	ARABIC LETTER BEH, final-isolated form
+chr(0x93) : [u'\u0628'],	#	ARABIC LETTER BEH, initial-medial form
+chr(0x94) : [u'\u067E'],	#	ARABIC LETTER PEH, final-isolated form
+chr(0x95) : [u'\u067E'],	#	ARABIC LETTER PEH, initial-medial form
+chr(0x96) : [u'\u062A'],	#	ARABIC LETTER TEH, final-isolated form
+chr(0x97) : [u'\u062A'],	#	ARABIC LETTER TEH, initial-medial form
+chr(0x98) : [u'\u062B'],	#	ARABIC LETTER THEH, final-isolated form
+chr(0x99) : [u'\u062B'],	#	ARABIC LETTER THEH, initial-medial form
+chr(0x9A) : [u'\u062C'],	#	ARABIC LETTER JEEM, final-isolated form
+chr(0x9B) : [u'\u062C'],	#	ARABIC LETTER JEEM, initial-medial form
+chr(0x9C) : [u'\u0686'],	#	ARABIC LETTER TCHEH, final-isolated form
+chr(0x9D) : [u'\u0686'],	#	ARABIC LETTER TCHEH, initial-medial form
+chr(0x9E) : [u'\u062D'],	#	ARABIC LETTER HAH, final-isolated form
+chr(0x9F) : [u'\u062D'],	#	ARABIC LETTER HAH, initial-medial form
+chr(0xA0) : [u'\u062E'],	#	ARABIC LETTER KHAH, final-isolated form
+chr(0xA1) : [u'\u062E'],	#	ARABIC LETTER KHAH, initial-medial form
+chr(0xA2) : [u'\u062F'],	#	ARABIC LETTER DAL
+chr(0xA3) : [u'\u0630'],	#	ARABIC LETTER THAL
+chr(0xA4) : [u'\u0631'],	#	ARABIC LETTER REH
+chr(0xA5) : [u'\u0632'],	#	ARABIC LETTER ZAIN
+chr(0xA6) : [u'\u0698'],	#	ARABIC LETTER JEH
+chr(0xA7) : [u'\u0633'],	#	ARABIC LETTER SEEN, final-isolated form
+chr(0xA8) : [u'\u0633'],	#	ARABIC LETTER SEEN, initial-medial form
+chr(0xA9) : [u'\u0634'],	#	ARABIC LETTER SHEEN, final-isolated form
+chr(0xAA) : [u'\u0634'],	#	ARABIC LETTER SHEEN, initial-medial form
+chr(0xAB) : [u'\u0635'],	#	ARABIC LETTER SAD, final-isolated form
+chr(0xAC) : [u'\u0635'],	#	ARABIC LETTER SAD, initial-medial form
+chr(0xAD) : [u'\u0636'],	#	ARABIC LETTER DAD, final-isolated form
+chr(0xAE) : [u'\u0636'],	#	ARABIC LETTER DAD, initial-medial form
+chr(0xAF) : [u'\u0637'],	#	ARABIC LETTER TAH, initial-medial form
+chr(0xB0) : [u'\u064E'],	#	ARABIC FATHA
+chr(0xB1) : [u'\u0650'],	#	ARABIC KASRA
+chr(0xB2) : [u'\u064F'],	#	ARABIC DAMMA
+chr(0xB3) : [u'\u064B'],	#	ARABIC FATHATAN
+chr(0xB4) : [u'\u0651'],	#	ARABIC SHADDA
+chr(0xB5) : [u'\u0023'],	# * #
+chr(0xB6) : [u'\u0024'],	# * $
+chr(0xB7) : [u'\u0025'],	# * %
+chr(0xB8) : [u'\u0026'],	# * &
+chr(0xB9) : [u'\u066C'],	# 	Arabic Thoushads Seperator
+chr(0xBA) : [u'\u0670'],	#	ARABIC LETTER SUPERSCRIPT ALEF
+chr(0xBB) : [u'\u0654'],	#	ARABIC HAMZA ABOVE
+chr(0xBC) : [u'\u066B'],	#	ARABIC DECIMAL SEPARATOR
+chr(0xBD) : [u'\u0029'],	# * RIGHT PARENTHESIS
+chr(0xBE) : [u'\u0028'],	# * LEFT PARENTHESIS
+chr(0xBF) : [u'\u0629'],	#	ARABIC LETTER TEH MARBUTAH
+chr(0xC0) : [u'\u00BB'],	#	RIGHT-POINTING DOUBLE ANGLE QUOTATION MARK
+chr(0xC1) : [u'\u0637'],	#	ARABIC LETTER TAH, final-isolated form
+chr(0xC2) : [u'\u0638'],	#	ARABIC LETTER ZAH, final-isolated form
+chr(0xC3) : [u'\u00AB'],	#	LEFT-POINTING DOUBLE ANGLE QUOTATION MARK
+chr(0xC4) : [u'\u0652'],	#	ARABIC SUKUN
+chr(0xC5) : [u'\u002D'],	# * -
+chr(0xC6) : [u'\u002E'],	# * FULL STOP
+chr(0xC7) : [u'\u002F'],	# * /
+chr(0xC8) : [u'\u002A'],	# * *
+chr(0xC9) : [u'\u007E'],	# * ~
+chr(0xCA) : [u'\u003A'],	# * COLON
+chr(0xCB) : [u'\u061B'],	# 	ARABIC SEMICOLON
+chr(0xCC) : [u'\u003E'],	# * GREATER-THAN SIGN
+chr(0xCD) : [u'\u002B'],	# * +
+chr(0xCE) : [u'\u003D'],	# * =
+chr(0xCF) : [u'\u003C'],	# * LESS-THAN SIGN
+# chr(0xD0) : [u'\u0040'],	# * @
+chr(0xD0) : [u''],	        # * @
+chr(0xD1) : [u'\u005D'],	# * [
+chr(0xD2) : [u'\u005C'],	# * \
+chr(0xD3) : [u'\u005B'],	# * ]
+chr(0xD4) : [u'\u005E'],	# * ^
+chr(0xD5) : [u'\u005F'],	# * _
+chr(0xD6) : [u'\u0060'],	# * `
+chr(0xD7) : [u'\u007D'],	# * {
+chr(0xD8) : [u'\u007C'],	# * |
+chr(0xDA) : [u'\u0020'],	# * SPACE
+chr(0xDD) : [u'\u0021'],	# * EXCLAMATION MARK
+chr(0xDE) : [u'\u007B'],	# * }
+chr(0xE0) : [u'\u0638'],	#	ARABIC LETTER ZAH, initial-medial form
+chr(0xE1) : [u'\u0639'],	#	ARABIC LETTER AIN, isolated form
+chr(0xE2) : [u'\u0639'],	#	ARABIC LETTER AIN, final form
+chr(0xE3) : [u'\u0639'],	#	ARABIC LETTER AIN, medial form
+chr(0xE4) : [u'\u0639'],	#	ARABIC LETTER AIN, initial form
+chr(0xE5) : [u'\u063A'],	#	ARABIC LETTER GHAIN, isolated form
+chr(0xE6) : [u'\u063A'],	#	ARABIC LETTER GHAIN, final form
+chr(0xE7) : [u'\u063A'],	#	ARABIC LETTER GHAIN, medial form
+chr(0xE8) : [u'\u063A'],	#	ARABIC LETTER GHAIN, initial form
+chr(0xE9) : [u'\u0641'],	#	ARABIC LETTER FEH, final-isolated form
+chr(0xEA) : [u'\u0641'],	#	ARABIC LETTER FEH, initial-medial form
+chr(0xEB) : [u'\u0642'],	#	ARABIC LETTER QAF, final-isolated form
+chr(0xEC) : [u'\u0642'],	#	ARABIC LETTER QAF, initial-medial form
+chr(0xED) : [u'\u06A9'],	#	ARABIC LETTER KEHEH, final-isolated form
+chr(0xEE) : [u'\u06A9'],	#	ARABIC LETTER KEHEH, initial-medial form
+chr(0xEF) : [u'\u06AF'],	#	ARABIC LETTER GAF, final-isolated form
+chr(0xF0) : [u'\u06AF'],	#	ARABIC LETTER GAF, initial-medial form
+chr(0xF1) : [u'\u0644'],	#	ARABIC LETTER LAM, final-isolated form
+chr(0xF2) : [u'\u0644\u0627'],	#	ARABIC LIGATURE LAM WITH ALEF
+chr(0xF3) : [u'\u0644'],	#	ARABIC LETTER LAM, initial-medial form
+chr(0xF4) : [u'\u0645'],	#	ARABIC LETTER MEEM, final-isolated form
+chr(0xF5) : [u'\u0645'],	#	ARABIC LETTER MEEM, initial-medial form
+chr(0xF6) : [u'\u0646'],	#	ARABIC LETTER NOON, final-isolated form
+chr(0xF7) : [u'\u0646'],	#	ARABIC LETTER NOON, initial-medial form
+chr(0xF8) : [u'\u0648'],	#	ARABIC LETTER WAW
+chr(0xF9) : [u'\u0647'],	#	ARABIC LETTER HEH, final-isolated form
+chr(0xFA) : [u'\u0647'],	#	ARABIC LETTER HEH, medial form
+chr(0xFB) : [u'\u0647'],	#	ARABIC LETTER HEH, initial form
+chr(0xFC) : [u'\u06CC'],	#	ARABIC LETTER FARSI YEH, final form
+chr(0xFD) : [u'\u06CC'],	#	ARABIC LETTER FARSI YEH, isolated form
+chr(0xFE) : [u'\u06CC']		#	ARABIC LETTER FARSI YEH, initial-medial form
+}
+
+F_SLASH = chr(0xD2)
+F_PRNT_OPEN = chr(0xDE)
+F_AT_SIGN = chr(0xD0)
+
+# latex and farsitex commands whose first parameter does not need \lr{...}
+commands = [ "begin", 
+"end",
+"input", "include", "includeonly",
+"hspace", "vspace", "hspace*", "vspace*",
+"label", "ref", "cite",
+"bibliographystyle",
+"parbox",
+"newenvironment", "newtheorem",
+"persianmathdigitsfamily",
+"fontfamily", "fontseries", "fontshape",
+"rmdefault", "sfdefault", "ttdefault",
+"bfdefault", "itdefault", "sldefault", "scdefault",
+"pagenumbering", "pagestyle", "thispagestyle",
+"setcounter", "stepcounter", "setlength", "addtolength"
+]
+
+
+def ft_is_numeric(ch):
+	if ((ch in ft_numerical) or 
+	    ((ch >= chr(0x80)) and (ch <= chr(0x89))) ):
+		return 1
+	return 0
+
+def ft_can_join_left(ch):
+	if ((ch in ft_bidi_joiners_initial) or
+	    (ch in ft_bidi_joiners_medial) or
+	    (ch in ft_bidi_joiners_final) or
+	    (ch in ft_bidi_joiners_isolated) or
+	    (ch in ft_bidi_joiners_initial_medial) or
+	    (ch in ft_bidi_joiners_final_isolated)):
+    		return 1
+	return 0
+
+def ft_can_join_right(ch):
+	if (ft_can_join_left(ch) or 
+	    (ch in ft_right_joiners_final) or
+	    (ch in ft_right_joiners_isolated) or
+	    (ch in ft_right_joiners_final_isolated)):
+		return 1
+	return 0
+
+def ft_joining_left(ch):
+	if ((ch in ft_bidi_joiners_initial) or 
+	    (ch in ft_bidi_joiners_medial) or
+	    (ch in ft_bidi_joiners_initial_medial)):
+		return 1
+	return 0
+
+
+def ft_joining_right(ch):
+	if ((ch in ft_right_joiners_final) or
+	    (ch in ft_bidi_joiners_medial) or 
+	    (ch in ft_bidi_joiners_final)):
+		return 1
+	return 0
+
+def ft_not_right_joined(ch):
+	if ((ch in ft_bidi_joiners_initial) or
+	    (ch in ft_right_joiners_isolated) or
+	    (ch in ft_bidi_joiners_isolated)):
+		return 1
+	return 0
+
+def ft_adjust_shaping(text, i):
+	current = text[i]
+	u = u''
+	try:
+		u = table_FT_UN[current][0]
+	except KeyError:
+		return u''
+
+	#if you don't want shaping remove the following comment
+	#return u
+
+	if ((current in ft_vowels) or (ft_is_numeric(current))):
+		return u
+
+	#find next non-vowel character on the left
+	text_len = len(text)
+	next_index = i+1
+	while ((next_index < text_len) and (text[next_index] in ft_vowels)):
+		next_index += 1
+
+	if (next_index == text_len):
+		next = ''
+	else:
+		next = text[next_index]
+
+	# if current letter is joining from left but next letter is or can not joining
+	if (ft_joining_left(current)):
+		if (not ft_can_join_right(next)):
+			u += u'\u200D' #ZWJ
+		elif (ft_not_right_joined(next)):
+			u += u'\u200D\u200C' #ZWJ+ZWNJ
+	# if current letter can join but next letter is joining from right
+	elif (ft_can_join_left(current)):
+		if (ft_joining_right(next)):
+			u += u'\u200C\u200D' #ZWNJ+ZWJ
+		elif (ft_can_join_right(next)):
+			u += u'\u200C' #ZWNJ
+	return u
+
+def ft_adjust_number(text):
+	result = u''
+	i = len(text)-1
+	while (i >= 0):
+		result += ft_adjust_shaping(text, i)
+		i -= 1
+	return result
+
+
+def map_ft_unicode(text):
+	mapped_text = u''
+
+	i = 0
+	while (i < len(text)):
+		if (ft_is_numeric(text[i])):
+			next_index = i
+			while ((next_index+1 < len(text)) and
+			       (ft_is_numeric(text[next_index+1]))):
+				next_index += 1
+			mapped_text += ft_adjust_number(text[i:next_index+1])
+			i = next_index+1
+			continue
+
+		mapped_text += ft_adjust_shaping(text, i)
+		i += 1
+	return mapped_text
+
+# Finds next token all of the same language
+def ft_next_part(line, i):
+	j = i
+	language_flag = (line[j]<chr(0x80))
+	while ((j<line_len) and ((line[j]<chr(0x80)) == language_flag) ):
+		j += 1
+	return j
+
+# Main body of the program 
+if len(sys.argv) <= 2:
+	print 'usage: python undk in_filename out_filename'
+	exit(0)
+
+###################################
+# Begin of main body of the program
+###################################
+filename = sys.argv[1]
+outfile = sys.argv[2]
+
+try:
+	f = open(filename, 'r')
+except IOError:
+	print "Can not open the input file: " + filename
+	exit(0)
+
+try:
+	of = codecs.open(outfile, encoding='utf-8', mode='w')
+except IOError:
+	print "Can not open the output file: " + outfile
+	exit(0)
+
+line_number = 0
+for line in f:
+	line_number += 1
+	output_line = u''
+	line_len = len(line)
+	
+	# remove new-line characters from end of line
+	if (line_len>1 and line[line_len-1] == '\n'):
+		line_len-=1
+	if (line_len>1 and line[line_len-1] == '\r'):
+		line_len-=1
+
+	# check line-direction character
+	line_direction_rtl = (line[0] == '<')
+	if (line[0] != '>') and (line[0] != '<'):
+		print "FORMAT ERROR AT LINE: " + str(line_number)
+		exit(0)
+
+	i = 1
+
+	while (i<line_len):
+		next_part_index = ft_next_part(line, i)
+		next_part = line[i:next_part_index]
+		next_part_latin = (line[i]<chr(0x80))
+		
+		# see if we should put \lr{...} for the current english expression
+		if line_direction_rtl and next_part_latin:
+			is_command_rtl = (next_part_latin and (i>1) and (line[i-1]==F_SLASH) )
+			is_parameter_rtl = (next_part_latin and (i>1) and (next_part_index<line_len) and (line[i-1]==F_AT_SIGN) and (line[next_part_index]==F_AT_SIGN) )
+			is_math_rtl = (next_part_latin and (line[i]=="$") and (line[next_part_index-1]=="$") )
+		
+			cmd_index = 0
+			while cmd_index < len(commands):
+				len_cmd = len(commands[cmd_index])+2
+				if ( (i > len_cmd) and (line[i-len_cmd:i] == F_SLASH+commands[cmd_index]+F_PRNT_OPEN) ):
+					break
+				cmd_index += 1
+			is_commands_group = cmd_index < len(commands)
+			is_documentstyle_cmd = (line_len > 15) and (line[1:15] == F_SLASH+"documentstyle")
+
+		if next_part_latin:
+			if ( line_direction_rtl and not (is_command_rtl or is_parameter_rtl or is_math_rtl or is_commands_group or is_documentstyle_cmd) ):
+				output_line += u'\\lr{'
+			
+			output_line += next_part.encode( 'utf-8' )
+			
+			if ( line_direction_rtl and not (is_command_rtl or is_parameter_rtl or is_math_rtl or is_commands_group or is_documentstyle_cmd) ):
+				output_line += u'}'
+		else:
+			if ( not line_direction_rtl):
+				output_line += u'\\rl{'
+				
+			output_line += map_ft_unicode(next_part)
+			
+			if (not line_direction_rtl):
+				output_line += u'}'
+				
+		i = next_part_index
+	# end of while			
+	
+	# write the processed line
+	output_line += u'\n'
+	of.write(output_line)
+	# end of line processing
+# end of file processing
+
+of.close()
+f.close()	%</ftxe-0.1.py>
+%<*thesis-sample.tex>
+\documentclass[a4paper,11pt]{xepersian-thesis}
+\usepackage{xepersian}
+\settextfont[Scale=1]{XB Zar}
+\setlatintextfont[Scale=1]{Linux Libertine}
+\setdigitfont[Scale=1]{XB Zar}
+
+
+
+
+\begin{document}
+\title{?????????? ????????}
+\author{?????? ??????????}
+\degree{???????????????? ?????????????? ??????}
+\supervisor{???????? ????????}
+\department{??????????}
+\university{??????????}
+\city{??????????}
+\thesisdate{\today}
+\maketitle
+\begin{acknowledgementpage}
+???? ?????????? ???????? ???????? ???? ?????? ???????? ??????
+\end{acknowledgementpage}
+\begin{abstractpage}
+?????????? ???? ???????? ?????????? ????????...
+\keywords{?????????? ???????? ?????????? ?? ????????????????}
+\end{abstractpage}
+\tableofcontents
+\listoftables
+\chapter{???????????? ??????????}
+???? ?????????? ???????? ??????????????? ???? ?????????? ?????? ?????????????? ?????????? ?????????????? ???? ?????????? ????????????????? ???? ????????
+\begin{equation}
+(a+b)^2=a^2+2ab+b^3
+\end{equation}
+\newpage
+?????? ?????????? ???????? ?????? ???? ???? ???? ?????? ???????? ???? ?????????? ???????????? ?????????? ?????????? ??????????.
+\section{??????????}
+
+\newpage
+?????? ???? ???? ?????????? ???????? ????????
+\chapter{??????}
+\chapter{??????}
+\appendix
+\chapter{??????}
+\chapter{??????}
+\chapter{??????}
+\bibliographystyle{unsrt}
+\begin{thebibliography}{99}
+\end{thebibliography}
+%\printindex
+\begin{latin}
+\latintitle{Pure Mathematics}
+\latinauthor{Vafa Khalighi}
+\latindegree{Bachelor of Pure Mathematics}
+\latinthesisdate{\latintoday}
+\latinsupervisor{Mohammad Ghodsi}
+\latindepartment{Computer Science}
+\latinuniversity{Iran University of Science \& Technology}
+\latincity{Tehran}
+\begin{latinabstract}
+\noindent This is our abstract written in English and This thesis is written very very very carefully so that we can keep  an eye on the beauty of typesetting.
+\latinkeywords{Mathematics, topology, geometry and category theory.}
+\end{latinabstract}
+\makelatintitle
+\end{latin}
+\end{document}
+%</thesis-sample.tex>
+%<*magazine-sample.tex>
+\documentclass[12pt,twoside]{xepersian-magazine}
+\usepackage{xepersian}
+\settextfont[Scale=1]{XB Zar}
+\setlatintextfont[Scale=1]{Junicode}
+\setdigitfont{XB Zar}
+\pagestyle{fancy}
+\title{?????????? ?????????????????}
+\author{?????? ??????????}
+\edition{?????? ??????}
+\customlogo{?????????? ?????????????????}
+\customminilogo{?????????? ?????????????????}
+\custommagazinename{?????????? ?????????????????}
+\customwwwTxt{http://parsilatex.org}
+\begin{document}
+\begin{frontpage}
+\firstimage{img/ireland.jpg}{?????? ?????????????? ?????????? ???????? ???? ?????????? ?????? ??????.}
+\firstarticle{?????? ???????? ???????????? ?????? ??????.}
+						{?????? ?????? ???????? ?????????? ???? ???????????? ?????? ?????? ???? ???? ???? ?????? ?????????? ???? ????????. ???????? ???? ?????????? ?????????????? ???? ???????????? ?????? ???????? ???? ?????? ???? ?????????????? ?????? ?????????? ?????????? ??????????. ?????? ???????? ???? ?????????? ?????????????? ?????? ??????????????????? ???????? ???? ???? ?????? ???????? ???? ???? ?????? ???????? ???????? ???????????????.}%
+						{????:????}
+\secondarticle{?????? ???? ???? ???????? ???????????? ?????? ??????.}%
+						{?????? ???? ?????? ???????? ???????????? ?????? ?????? ???? ???? ???? ???? ?????????? ???????????????????.}%
+						{?????? ?????? ???????? ?????????? ???? ???????????? ?????? ?????? ???? ???? ???? ?????? ?????????? ???? ????????. ???????? ???? ?????????? ?????????????? ???? ???????????? ?????? ???????? ???? ?????? ???? ?????????????? ?????? ?????????? ?????????? ??????????. ?????? ???????? ???? ?????????? ?????????????? ?????? ??????????????????? ???????? ???? ???? ?????? ???????? ???? ???? ?????? ???????? ???????? ???????????????.}%
+						{???????? ??????}%
+						{????:????}
+
+\thirdarticle{?????? ???????????? ???????????? ?????? ??????.}%
+					{?????? ???? ?????????????? ???????????? ?????? ?????? ???? ???? ???? ???? ???? ?????????? ???????? ???????????????.}%
+					{?????? ?????? ???????? ?????????? ???? ???????????? ?????? ?????? ???? ???? ???? ?????? ?????????? ???? ????????. ???????? ???? ?????????? ?????????????? ???? ???????????? ?????? ???????? ???? ?????? ???? ?????????????? ?????? ?????????? ?????????? ??????????. ?????? ???????? ???? ?????????? ?????????????? ?????? ??????????????????? ???????? ???? ???? ?????? ???????? ???? ???? ?????? ???????? ???????? ???????????????. ?? ?????????????? ???? ????????????????? ???? ?????????? ???????? ???????? ?????????? ?????? ?????? ???????? ????????????????? ???? ?????? ???????? ???? ???? ???????? ????????. ?????? ???? ?????????????? ???????? ???????????? ???? ?????????? ?????????? ?????????? ????????.}%
+					
+					{???????? ??}%
+					{????:????}
+
+\begin{indexblock}{?????????? (?????????? ??????????) ????????}
+\indexitem{??- ?????????? ??????}{1}
+
+\indexitem{??- ?????????? ??????}{3}
+
+\indexitem{??- ?????????? ??????}{3}
+
+\indexitem{??- ?????????? ??????????}{5}
+\end{indexblock}
+
+\begin{weatherblock}{?????? ???? ?? ??????}
+\weatheritem{img/weather/rain.jpg}{??????????}{13}{9}{}
+\weatheritem{img/weather/sun.jpg}{????????}{15}{1}{}
+\weatheritem{img/weather/clouds.jpg}{????????}{12}{6}{}
+\end{weatherblock}
+
+
+\begin{authorblock}
+\textbf{????????????????????}
+
+?????? ???????????? ???????? ?????????????? ?? ?????????? ??????????
+
+\texttt{vafa at aol.com.au\\[5pt]
+http://parsilatex.org}\\
+\end{authorblock}
+\end{frontpage}
+\newsection{???????? ??????}
+\begin{article}{2}
+	{?????? ???????? ?????? ?????????? ??????.}
+	{?????? ???? ?????????????? ?????? ?????????? ??????.}
+	{???????? ??????}
+	{1}
+\authorandplace{?????? ??????????????}{????????}
+
+
+
+		
+\noindent\timestamp{??:????}
+?????????? ???????? ???? ?????? ???????????? ???? ???????????? ???????? ?? ???? ?????????? ?????????????? ??????????? ???? ?????????? ???????????? ???????? ??????????????? ???????? ???????? ???????? ?????????? ?????????? ???????????? ????????????  ?????? ?????????????????????? ?????????? ???????? ???????? ???? ?????????? ?????????????? ?????????????? ???? ?????? ?????? ??????.  ????????? ?????? ?????? ???????????? ???? ???? ???????? ???? ?????????? ?????? ???? ????????  ???????????? ???????????? ?????? ????????????? ??????.  ???? ???????? ???? ?????? ?????? ??????????????? ???????? ???? ???????????? ???????? ?? ?????????? ??????????????? ???????????? ?????????? ???? ?????????? ???????? ???????????? ???? ???? ???????? ???? ????????????? ???????????? ???????? ?????? ?????????? ????????. ???????????????? ???? ?????? ?????? ???????????? ??????????????? ???????????? ???? ?????? ????????????? ???? ?????????? ???????? ????????????????? ????????????? ???????? ?????? ???????????????!
 ???? ???? ???? ???????? ???????? . ???? ?????? ?????? ??????????????? ??????????????? ???????????? ???? ?????? ????????????? ?? ????????????????????? ?????????? ???????? ?????????? ??????????  ???????? ???????? ???? ?????????? ???????????? ???????????? ?????????? ???????? ?? ?????????????? ???????? ?????????????? ????????????????? ?? ??????????????? ???????????? ???? ?????????? ?????????????? ?????????????? ???? ???? ???????? ??????????.
+\footnote{?????? ???? ?????????????? ?????????? ??????.}\LTRfootnote{This is an English footnote.}
+\begin{equation}
+(a+b)^3=a^3+3a^2b+3ab^2+b^3\label{eq-1}
+\end{equation}
+?????? ?????????????? \eqref{eq-1} ??????.
+\columntitle{lines}{?????? ???? ???????? ?????? ???? ???????? ???????? ???????? ?????? ???? ?????? ???????? ?????????? ???????????????.}
+
+?????????? ???????? ???? ?????? ???????????? ???? ???????????? ???????? ?? ???? ?????????? ?????????????? ??????????? ???? ?????????? ???????????? ???????? ??????????????? ???????? ???????? ???????? ?????????? ?????????? ???????????? ????????????  ?????? ?????????????????????? ?????????? ???????? ???????? ???? ?????????? ?????????????? ?????????????? ???? ?????? ?????? ??????.  ????????? ?????? ?????? ???????????? ???? ???? ???????? ???? ?????????? ?????? ???? ????????  ???????????? ???????????? ?????? ????????????? ??????.  ???? ???????? ???? ?????? ?????? ??????????????? ???????? ???? ???????????? ???????? ?? ?????????? ??????????????? ???????????? ?????????? ???? ?????????? ???????? ???????????? ???? ???? ???????? ???? ????????????? ???????????? ???????? ?????? ?????????? ????????. ???????????????? ???? ?????? ?????? ???????????? ??????????????? ???????????? ???? ?????? ????????????? ???? ?????????? ???????? ????????????????? ????????????? ???????? ?????? ???????????????!
 ???? ???? ???? ???????? ???????? . ???? ?????? ?????? ??????????????? ??????????????? ???????????? ???? ?????? ????????????? ?? ????????????????????? ?????????? ???????? ?????????? ??????????  ???????? ???????? ???? ?????????? ???????????? ???????????? ?????????? ???????? ?? ?????????????? ???????? ?????????????? ????????????????? ?? ??????????????? ???????????? ???? ?????????? ?????????????? ?????????????? ???? ???? ???????? ??????????.
+
+?????? ???????????? ??????????????????????? ??????????????????? ?????????? ?????? ???????? ???? ???? ???? ???? ???????? ??????????????????????????? ???????????????? ?? ???? ???????? ??????????????????????????????? ??????????????? ?????????????.  ???? ??????????? ???? ????????????????? ??????????????????????? ???? ???????? ??????????????????????? ?????????????? ?????????????? ??????????????? ???????????? ???? ????????????????????? ???????????? ?????????????? ???????? ?????? ??????????????? ?????????? ????????????????? ???? ?????????? ?????? ????????????????? ???????? ???????? ????????????????????? ????????????????? ??????????/??????????????????? ??????.  ??????????????? ???? ???????? ?????? ?????????? ?????????????? ?????? ?????????? ?????????? ??????????????? ?????????? ??????????????? ?????????? ???? ???????? ??????????????? ???? ???????? ???????????? ???????? ?????? ???????? ??????????????? ???????? ???????????? ?????????? ???????????? ?????? ?????????????. ?????????? ???!
 ? ?????? ???????????? ???????????? ?????? ??????????????? ???? ???????? ?????????????? ?????? ???????? ?????????????? ?????? ?????? ?? ?????? ?????? ???? ?????????? ??????????????????? ??????????????????? ???????????? ?????? ???? ???? ?????? ?????? ??????????????? ?????????? ??????.
+
+???????????? ???????? ??????? ?????? ???? ?????? ???????????????. ???????? ???????? ?????????? ?????? ????  ??????????????????? ?????????? ???? ????????????????? ??????????????????????? ??????????????? ?????? ???? ?????? ???????? ??????????? ???? ???? ??????????????????????? ?????? ??????????????? ?????????????.  ?????? ???????? ???? ???????????? ?????????? ?????????? ???? ?????????? ?????????? ???????????? ???? ???????? ?? ?????????? ?????????? ????  ???????? ???????? ?????????????.  ???? ???? ???????? ?????????? ?? ????????????????? ???????? ?????????????? ???? ??????????????????? ???????? ?????? ??????????????? ?????? ?? ???? ?????? ???????? ???? ?????? ????????????????? ???????? ?????? ??????????????? ????????????  ?????????? ????  ????????????????? ?????????? ?????????? ??????????. ???? ???????? ???????? ?????? ???? ???????????? ???????? ???????????? ?????? ????????????????? ???????????? ????  ?????????????? ??????????????? ?? ?????????? ?????????? ???????? ???? ??????!
 ????  ?????????? ???? ?????????? ???? ????????????????? ??????.
+\end{article}
+
+\articlesep
+
+\begin{article}{2}
+	{?????? ???????? ?????? ?????????? ??????.}
+	{?????? ???? ?????????????? ?????? ?????????? ??????.}
+	{???????? ??????}
+	{1}
+\authorandplace{?????? ??????????????}{????????}
+
+\noindent\timestamp{08:25}
+?????????? ???????? ???? ?????? ???????????? ???? ???????????? ???????? ?? ???? ?????????? ?????????????? ??????????? ???? ?????????? ???????????? ???????? ??????????????? ???????? ???????? ???????? ?????????? ?????????? ???????????? ????????????  ?????? ?????????????????????? ?????????? ???????? ???????? ???? ?????????? ?????????????? ?????????????? ???? ?????? ?????? ??????.  ????????? ?????? ?????? ???????????? ???? ???? ???????? ???? ?????????? ?????? ???? ????????  ???????????? ???????????? ?????? ????????????? ??????.  ???? ???????? ???? ?????? ?????? ??????????????? ???????? ???? ???????????? ???????? ?? ?????????? ??????????????? ???????????? ?????????? ???? ?????????? ???????? ???????????? ???? ???? ???????? ???? ????????????? ???????????? ???????? ?????? ?????????? ????????. ???????????????? ???? ?????? ?????? ???????????? ??????????????? ???????????? ???? ?????? ????????????? ???? ?????????? ???????? ????????????????? ????????????? ???????? ?????? ???????????????!
 ???? ???? ???? ???????? ???????? . ???? ?????? ?????? ??????????????? ??????????????? ???????????? ???? ?????? ????????????? ?? ????????????????????? ?????????? ???????? ?????????? ??????????  ???????? ???????? ???? ?????????? ???????????? ???????????? ?????????? ???????? ?? ?????????????? ???????? ?????????????? ????????????????? ?? ??????????????? ???????????? ???? ?????????? ?????????????? ?????????????? ???? ???? ???????? ??????????.
+\LTRfootnote{This is an English footnote.}\footnote{?????? ???? ?????????????? ?????????? ??????.}
+?????? ???????????? ??????????????????????? ??????????????????? ?????????? ?????? ???????? ???? ???? ???? ???? ???????? ??????????????????????????? ???????????????? ?? ???? ???????? ??????????????????????????????? ??????????????? ?????????????.  ???? ??????????? ???? ????????????????? ??????????????????????? ???? ???????? ??????????????????????? ?????????????? ?????????????? ??????????????? ???????????? ???? ????????????????????? ???????????? ?????????????? ???????? ?????? ??????????????? ?????????? ????????????????? ???? ?????????? ?????? ????????????????? ???????? ???????? ????????????????????? ????????????????? ??????????/??????????????????? ??????.  ??????????????? ???? ???????? ?????? ?????????? ?????????????? ?????? ?????????? ?????????? ??????????????? ?????????? ??????????????? ?????????? ???? ???????? ??????????????? ???? ???????? ???????????? ???????? ?????? ???????? ??????????????? ???????? ???????????? ?????????? ???????????? ?????? ?????????????. ?????????? ???!
 ? ?????? ???????????? ???????????? ?????? ??????????????? ???? ???????? ?????????????? ?????? ???????? ?????????????? ?????? ?????? ?? ?????? ?????? ???? ?????????? ??????????????????? ??????????????????? ???????????? ?????? ???? ???? ?????? ?????? ??????????????? ?????????? ??????.
+
+???????????? ???????? ??????? ?????? ???? ?????? ???????????????. ???????? ???????? ?????????? ?????? ????  ??????????????????? ?????????? ???? ????????????????? ??????????????????????? ??????????????? ?????? ???? ?????? ???????? ??????????? ???? ???? ??????????????????????? ?????? ??????????????? ?????????????.  ?????? ???????? ???? ???????????? ?????????? ?????????? ???? ?????????? ?????????? ???????????? ???? ???????? ?? ?????????? ?????????? ????  ???????? ???????? ?????????????.  ???? ???? ???????? ?????????? ?? ????????????????? ???????? ?????????????? ???? ??????????????????? ???????? ?????? ??????????????? ?????? ?? ???? ?????? ???????? ???? ?????? ????????????????? ???????? ?????? ??????????????? ????????????  ?????????? ????  ????????????????? ?????????? ?????????? ??????????. ???? ???????? ???????? ?????? ???? ???????????? ???????? ???????????? ?????? ????????????????? ???????????? ????  ?????????????? ??????????????? ?? ?????????? ?????????? ???????? ???? ??????!
 ????  ?????????? ???? ?????????? ???? ????????????????? ??????.  
+
+?????????? ???????? ???? ?????? ???????????? ???? ???????????? ???????? ?? ???? ?????????? ?????????????? ??????????? ???? ?????????? ???????????? ???????? ??????????????? ???????? ???????? ???????? ?????????? ?????????? ???????????? ????????????  ?????? ?????????????????????? ?????????? ???????? ???????? ???? ?????????? ?????????????? ?????????????? ???? ?????? ?????? ??????.  ????????? ?????? ?????? ???????????? ???? ???? ???????? ???? ?????????? ?????? ???? ????????  ???????????? ???????????? ?????? ????????????? ??????.  ???? ???????? ???? ?????? ?????? ??????????????? ???????? ???? ???????????? ???????? ?? ?????????? ??????????????? ???????????? ?????????? ???? ?????????? ???????? ???????????? ???? ???? ???????? ???? ????????????? ???????????? ???????? ?????? ?????????? ????????. ???????????????? ???? ?????? ?????? ???????????? ??????????????? ???????????? ???? ?????? ????????????? ???? ?????????? ???????? ????????????????? ????????????? ???????? ?????? ???????????????!
 ???? ???? ???? ???????? ???????? . ???? ?????? ?????? ??????????????? ??????????????? ???????????? ???? ?????? ????????????? ?? ????????????????????? ?????????? ???????? ?????????? ??????????  ???????? ???????? ???? ?????????? ???????????? ???????????? ?????????? ???????? ?? ?????????????? ???????? ?????????????? ????????????????? ?? ??????????????? ???????????? ???? ?????????? ?????????????? ?????????????? ???? ???? ???????? ??????????.
+
+?????? ???????????? ??????????????????????? ??????????????????? ?????????? ?????? ???????? ???? ???? ???? ???? ???????? ??????????????????????????? ???????????????? ?? ???? ???????? ??????????????????????????????? ??????????????? ?????????????.  ???? ??????????? ???? ????????????????? ??????????????????????? ???? ???????? ??????????????????????? ?????????????? ?????????????? ??????????????? ???????????? ???? ????????????????????? ???????????? ?????????????? ???????? ?????? ??????????????? ?????????? ????????????????? ???? ?????????? ?????? ????????????????? ???????? ???????? ????????????????????? ????????????????? ??????????/??????????????????? ??????.  ??????????????? ???? ???????? ?????? ?????????? ?????????????? ?????? ?????????? ?????????? ??????????????? ?????????? ??????????????? ?????????? ???? ???????? ??????????????? ???? ???????? ???????????? ???????? ?????? ???????? ??????????????? ???????? ???????????? ?????????? ???????????? ?????? ?????????????. ?????????? ???!
 ? ?????? ???????????? ???????????? ?????? ??????????????? ???? ???????? ?????????????? ?????? ???????? ?????????????? ?????? ?????? ?? ?????? ?????? ???? ?????????? ??????????????????? ??????????????????? ???????????? ?????? ???? ???? ?????? ?????? ??????????????? ?????????? ??????.
+
+???????????? ???????? ??????? ?????? ???? ?????? ???????????????. ???????? ???????? ?????????? ?????? ????  ??????????????????? ?????????? ???? ????????????????? ??????????????????????? ??????????????? ?????? ???? ?????? ???????? ??????????? ???? ???? ??????????????????????? ?????? ??????????????? ?????????????.  ?????? ???????? ???? ???????????? ?????????? ?????????? ???? ?????????? ?????????? ???????????? ???? ???????? ?? ?????????? ?????????? ????  ???????? ???????? ?????????????.  ???? ???? ???????? ?????????? ?? ????????????????? ???????? ?????????????? ???? ??????????????????? ???????? ?????? ??????????????? ?????? ?? ???? ?????? ???????? ???? ?????? ????????????????? ???????? ?????? ??????????????? ????????????  ?????????? ????  ????????????????? ?????????? ?????????? ??????????. ???? ???????? ???????? ?????? ???? ???????????? ???????? ???????????? ?????? ????????????????? ???????????? ????  ?????????????? ??????????????? ?? ?????????? ?????????? ???????? ???? ??????!
 ????  ?????????? ???? ?????????? ???? ????????????????? ??????.  
+
+\expandedtitle{doublebox}{?????? ???? ???????? ?????? ?????? ???? ???????? ???? ???? ???????????? ?????? ?????????? ???? ?????????? ??????????????? ?? ?????? ???????? ???? ?? ?????????????????? ???????? ?????? ??????.}
+
+?????????? ???????? ???? ?????? ???????????? ???? ???????????? ???????? ?? ???? ?????????? ?????????????? ??????????? ???? ?????????? ???????????? ???????? ??????????????? ???????? ???????? ???????? ?????????? ?????????? ???????????? ????????????  ?????? ?????????????????????? ?????????? ???????? ???????? ???? ?????????? ?????????????? ?????????????? ???? ?????? ?????? ??????.  ????????? ?????? ?????? ???????????? ???? ???? ???????? ???? ?????????? ?????? ???? ????????  ???????????? ???????????? ?????? ????????????? ??????.  ???? ???????? ???? ?????? ?????? ??????????????? ???????? ???? ???????????? ???????? ?? ?????????? ??????????????? ???????????? ?????????? ???? ?????????? ???????? ???????????? ???? ???? ???????? ???? ????????????? ???????????? ???????? ?????? ?????????? ????????. ???????????????? ???? ?????? ?????? ???????????? ??????????????? ???????????? ???? ?????? ????????????? ???? ?????????? ???????? ????????????????? ????????????? ???????? ?????? ???????????????!
 ???? ???? ???? ???????? ???????? . ???? ?????? ?????? ??????????????? ??????????????? ???????????? ???? ?????? ????????????? ?? ????????????????????? ?????????? ???????? ?????????? ??????????  ???????? ???????? ???? ?????????? ???????????? ???????????? ?????????? ???????? ?? ?????????????? ???????? ?????????????? ????????????????? ?? ??????????????? ???????????? ???? ?????????? ?????????????? ?????????????? ???? ???? ???????? ??????????.
+
+?????? ???????????? ??????????????????????? ??????????????????? ?????????? ?????? ???????? ???? ???? ???? ???? ???????? ??????????????????????????? ???????????????? ?? ???? ???????? ??????????????????????????????? ??????????????? ?????????????.  ???? ??????????? ???? ????????????????? ??????????????????????? ???? ???????? ??????????????????????? ?????????????? ?????????????? ??????????????? ???????????? ???? ????????????????????? ???????????? ?????????????? ???????? ?????? ??????????????? ?????????? ????????????????? ???? ?????????? ?????? ????????????????? ???????? ???????? ????????????????????? ????????????????? ??????????/??????????????????? ??????.  ??????????????? ???? ???????? ?????? ?????????? ?????????????? ?????? ?????????? ?????????? ??????????????? ?????????? ??????????????? ?????????? ???? ???????? ??????????????? ???? ???????? ???????????? ???????? ?????? ???????? ??????????????? ???????? ???????????? ?????????? ???????????? ?????? ?????????????. ?????????? ???!
 ? ?????? ???????????? ???????????? ?????? ??????????????? ???? ???????? ?????????????? ?????? ???????? ?????????????? ?????? ?????? ?? ?????? ?????? ???? ?????????? ??????????????????? ??????????????????? ???????????? ?????? ???? ???? ?????? ?????? ??????????????? ?????????? ??????.
+
+???????????? ???????? ??????? ?????? ???? ?????? ???????????????. ???????? ???????? ?????????? ?????? ????  ??????????????????? ?????????? ???? ????????????????? ??????????????????????? ??????????????? ?????? ???? ?????? ???????? ??????????? ???? ???? ??????????????????????? ?????? ??????????????? ?????????????.  ?????? ???????? ???? ???????????? ?????????? ?????????? ???? ?????????? ?????????? ???????????? ???? ???????? ?? ?????????? ?????????? ????  ???????? ???????? ?????????????.  ???? ???? ???????? ?????????? ?? ????????????????? ???????? ?????????????? ???? ??????????????????? ???????? ?????? ??????????????? ?????? ?? ???? ?????? ???????? ???? ?????? ????????????????? ???????? ?????? ??????????????? ????????????  ?????????? ????  ????????????????? ?????????? ?????????? ??????????. ???? ???????? ???????? ?????? ???? ???????????? ???????? ???????????? ?????? ????????????????? ???????????? ????  ?????????????? ??????????????? ?? ?????????? ?????????? ???????? ???? ??????!
 ????  ?????????? ???? ?????????? ???? ????????????????? ??????.  
+\end{article}
+
+\articlesep
+
+\newsection{???????? ??}
+
+
+\begin{article}{2}
+	{?????? ???? ???????? ?????????? ??????.?????? ??????????}
+	{?????? ???? ?????? ?????????? ?????????????? ?????? ???? ???? ???? ???? ???? ?????????? ???????? ???????????????.}
+	{???????? ??}
+	{3}
+
+\authorandplace{?????? ??????????????}{????????}
+
+
+
+\noindent\timestamp{08:25}  et ?????????? ???????? ???? ?????? ???????????? ???? ???????????? ???????? ?? ???? ?????????? ?????????????? ??????????? ???? ?????????? ???????????? ???????? ??????????????? ???????? ???????? ???????? ?????????? ?????????? ???????????? ????????????  ?????? ?????????????????????? ?????????? ???????? ???????? ???? ?????????? ?????????????? ?????????????? ???? ?????? ?????? ??????.  ????????? ?????? ?????? ???????????? ???? ???? ???????? ???? ?????????? ?????? ???? ????????  ???????????? ???????????? ?????? ????????????? ??????.  ???? ???????? ???? ?????? ?????? ??????????????? ???????? ???? ???????????? ???????? ?? ?????????? ??????????????? ???????????? ?????????? ???? ?????????? ???????? ???????????? ???? ???? ???????? ???? ????????????? ???????????? ???????? ?????? ?????????? ????????. ???????????????? ???? ?????? ?????? ???????????? ??????????????? ???????????? ???? ?????? ????????????? ???? ?????????? ???????? ????????????????? ????????????? !
 ???????? ?????? ??????????????????? ???? ???? ???????? ???????? . ???? ?????? ?????? ??????????????? ??????????????? ???????????? ???? ?????? ????????????? ?? ????????????????????? ?????????? ???????? ?????????? ??????????  ???????? ???????? ???? ?????????? ???????????? ???????????? ?????????? ???????? ?? ?????????????? ???????? ?????????????? ????????????????? ?? ??????????????? ???????????? ???? ?????????? ?????????????? ?????????????? ???? ???? ???????? ??????????.
+
+?????? ???????????? ??????????????????????? ??????????????????? ?????????? ?????? ???????? ???? ???? ???? ???? ???????? ??????????????????????????? ???????????????? ?? ???? ???????? ??????????????????????????????? ??????????????? ?????????????.  ???? ??????????? ???? ????????????????? ??????????????????????? ???? ???????? ??????????????????????? ?????????????? ?????????????? ??????????????? ???????????? ???? ????????????????????? ???????????? ?????????????? ???????? ?????? ??????????????? ?????????? ????????????????? ???? ?????????? ?????? ????????????????? ???????? ???????? ????????????????????? ????????????????? ??????????/??????????????????? ??????.  ??????????????? ???? ???????? ?????? ?????????? ?????????????? ?????? ?????????? ?????????? ??????????????? ?????????? ??????????????? ?????????? ???? ???????? ??????????????? ???? ???????? ???????????? ???????? ?????? ???????? ??????????????? ???????? ???????????? ?????????? ???????????? ?????? ?????????????. ?????????? ???!
 ? ?????? ???????????? ???????????? ?????? ??????????????? ???? ???????? ?????????????? ?????? ???????? ?????????????? ?????? ?????? ?? ?????? ?????? ???? ?????????? ??????????????????? ??????????????????? ???????????? ?????? ???? ???? ?????? ?????? ??????????????? ?????????? ??????.
+
+???????????? ???????? ??????? ?????? ???? ?????? ???????????????. ???????? ???????? ?????????? ?????? ????  ??????????????????? ?????????? ???? ????????????????? ??????????????????????? ??????????????? ?????? ???? ?????? ???????? ??????????? ???? ???? ??????????????????????? ?????? ??????????????? ?????????????.  ?????? ???????? ???? ???????????? ?????????? ?????????? ???? ?????????? ?????????? ???????????? ???? ???????? ?? ?????????? ?????????? ????  ???????? ???????? ?????????????.  ???? ???? ???????? ?????????? ?? ????????????????? ???????? ?????????????? ???? ??????????????????? ???????? ?????? ??????????????? ?????? ?? ???? ?????? ???????? ???? ?????? ????????????????? ???????? ?????? ??????????????? ????????????  ?????????? ????  ????????????????? ?????????? ?????????? ??????????. ???? ???????? ???????? ?????? ???? ???????????? ???????? ???????????? ?????? ????????????????? ???????????? ????  ?????????????? ??????????????? ?? ?????????? ?????????? ???????? ???? ??????!
 ????  ?????????? ???? ?????????? ???? ????????????????? ??????.  
+
+?????????? ???????? ???? ?????? ???????????? ???? ???????????? ???????? ?? ???? ?????????? ?????????????? ??????????? ???? ?????????? ???????????? ???????? ??????????????? ???????? ???????? ???????? ?????????? ?????????? ???????????? ????????????  ?????? ?????????????????????? ?????????? ???????? ???????? ???? ?????????? ?????????????? ?????????????? ???? ?????? ?????? ??????.  ????????? ?????? ?????? ???????????? ???? ???? ???????? ???? ?????????? ?????? ???? ????????  ???????????? ???????????? ?????? ????????????? ??????.  ???? ???????? ???? ?????? ?????? ??????????????? ???????? ???? ???????????? ???????? ?? ?????????? ??????????????? ???????????? ?????????? ???? ?????????? ???????? ???????????? ???? ???? ???????? ???? ????????????? ???????????? ???????? ?????? ?????????? ????????. ???????????????? ???? ?????? ?????? ???????????? ??????????????? ???????????? ???? ?????? ????????????? ???? ?????????? ???????? ????????????????? ????????????? ???????? ?????? ???????????????!
 ???? ???? ???? ???????? ???????? . ???? ?????? ?????? ??????????????? ??????????????? ???????????? ???? ?????? ????????????? ?? ????????????????????? ?????????? ???????? ?????????? ??????????  ???????? ???????? ???? ?????????? ???????????? ???????????? ?????????? ???????? ?? ?????????????? ???????? ?????????????? ????????????????? ?? ??????????????? ???????????? ???? ?????????? ?????????????? ?????????????? ???? ???? ???????? ??????????.
+
+?????? ???????????? ??????????????????????? ??????????????????? ?????????? ?????? ???????? ???? ???? ???? ???? ???????? ??????????????????????????? ???????????????? ?? ???? ???????? ??????????????????????????????? ??????????????? ?????????????.  ???? ??????????? ???? ????????????????? ??????????????????????? ???? ???????? ??????????????????????? ?????????????? ?????????????? ??????????????? ???????????? ???? ????????????????????? ???????????? ?????????????? ???????? ?????? ??????????????? ?????????? ????????????????? ???? ?????????? ?????? ????????????????? ???????? ???????? ????????????????????? ????????????????? ??????????/??????????????????? ??????.  ??????????????? ???? ???????? ?????? ?????????? ?????????????? ?????? ?????????? ?????????? ??????????????? ?????????? ??????????????? ?????????? ???? ???????? ??????????????? ???? ???????? ???????????? ???????? ?????? ???????? ??????????????? ???????? ???????????? ?????????? ???????????? ?????? ?????????????. ?????????? ???!
 ? ?????? ???????????? ???????????? ?????? ??????????????? ???? ???????? ?????????????? ?????? ???????? ?????????????? ?????? ?????? ?? ?????? ?????? ???? ?????????? ??????????????????? ??????????????????? ???????????? ?????? ???? ???? ?????? ?????? ??????????????? ?????????? ??????.
+
+???????????? ???????? ??????? ?????? ???? ?????? ???????????????. ???????? ???????? ?????????? ?????? ????  ??????????????????? ?????????? ???? ????????????????? ??????????????????????? ??????????????? ?????? ???? ?????? ???????? ??????????? ???? ???? ??????????????????????? ?????? ??????????????? ?????????????.  ?????? ???????? ???? ???????????? ?????????? ?????????? ???? ?????????? ?????????? ???????????? ???? ???????? ?? ?????????? ?????????? ????  ???????? ???????? ?????????????.  ???? ???? ???????? ?????????? ?? ????????????????? ???????? ?????????????? ???? ??????????????????? ???????? ?????? ??????????????? ?????? ?? ???? ?????? ???????? ???? ?????? ????????????????? ???????? ?????? ??????????????? ????????????  ?????????? ????  ????????????????? ?????????? ?????????? ??????????. ???? ???????? ???????? ?????? ???? ???????????? ???????? ???????????? ?????? ????????????????? ???????????? ????  ?????????????? ??????????????? ?? ?????????? ?????????? ???????? ???? ??????!
 ????  ?????????? ???? ?????????? ???? ????????????????? ??????.  
+
+\expandedtitle{lines}{?????? ???? ???????????? ???????? ???????? ?????? ???? ???? ???? ???? ???? ???????????? ?????? ?????????? ???????? ?????????????? ???????? ?????????????????.}
+
+?????????? ???????? ???? ?????? ???????????? ???? ???????????? ???????? ?? ???? ?????????? ?????????????? ??????????? ???? ?????????? ???????????? ???????? ??????????????? ???????? ???????? ???????? ?????????? ?????????? ???????????? ????????????  ?????? ?????????????????????? ?????????? ???????? ???????? ???? ?????????? ?????????????? ?????????????? ???? ?????? ?????? ??????.  ????????? ?????? ?????? ???????????? ???? ???? ???????? ???? ?????????? ?????? ???? ????????  ???????????? ???????????? ?????? ????????????? ??????.  ???? ???????? ???? ?????? ?????? ??????????????? ???????? ???? ???????????? ???????? ?? ?????????? ??????????????? ???????????? ?????????? ???? ?????????? ???????? ???????????? ???? ???? ???????? ???? ????????????? ???????????? ???????? ?????? ?????????? ????????. ???????????????? ???? ?????? ?????? ???????????? ??????????????? ???????????? ???? ?????? ????????????? ???? ?????????? ???????? ????????????????? ????????????? ???????? ?????? ???????????????!
 ???? ???? ???? ???????? ???????? . ???? ?????? ?????? ??????????????? ??????????????? ???????????? ???? ?????? ????????????? ?? ????????????????????? ?????????? ???????? ?????????? ??????????  ???????? ???????? ???? ?????????? ???????????? ???????????? ?????????? ???????? ?? ?????????????? ???????? ?????????????? ????????????????? ?? ??????????????? ???????????? ???? ?????????? ?????????????? ?????????????? ???? ???? ???????? ??????????.
+
+?????? ???????????? ??????????????????????? ??????????????????? ?????????? ?????? ???????? ???? ???? ???? ???? ???????? ??????????????????????????? ???????????????? ?? ???? ???????? ??????????????????????????????? ??????????????? ?????????????.  ???? ??????????? ???? ????????????????? ??????????????????????? ???? ???????? ??????????????????????? ?????????????? ?????????????? ??????????????? ???????????? ???? ????????????????????? ???????????? ?????????????? ???????? ?????? ??????????????? ?????????? ????????????????? ???? ?????????? ?????? ????????????????? ???????? ???????? ????????????????????? ????????????????? ??????????/??????????????????? ??????.  ??????????????? ???? ???????? ?????? ?????????? ?????????????? ?????? ?????????? ?????????? ??????????????? ?????????? ??????????????? ?????????? ???? ???????? ??????????????? ???? ???????? ???????????? ???????? ?????? ???????? ??????????????? ???????? ???????????? ?????????? ???????????? ?????? ?????????????. ?????????? ???!
 ? ?????? ???????????? ???????????? ?????? ??????????????? ???? ???????? ?????????????? ?????? ???????? ?????????????? ?????? ?????? ?? ?????? ?????? ???? ?????????? ??????????????????? ??????????????????? ???????????? ?????? ???? ???? ?????? ?????? ??????????????? ?????????? ??????.
+
+???????????? ???????? ??????? ?????? ???? ?????? ???????????????. ???????? ???????? ?????????? ?????? ????  ??????????????????? ?????????? ???? ????????????????? ??????????????????????? ??????????????? ?????? ???? ?????? ???????? ??????????? ???? ???? ??????????????????????? ?????? ??????????????? ?????????????.  ?????? ???????? ???? ???????????? ?????????? ?????????? ???? ?????????? ?????????? ???????????? ???? ???????? ?? ?????????? ?????????? ????  ???????? ???????? ?????????????.  ???? ???? ???????? ?????????? ?? ????????????????? ???????? ?????????????? ???? ??????????????????? ???????? ?????? ??????????????? ?????? ?? ???? ?????? ???????? ???? ?????? ????????????????? ???????? ?????? ??????????????? ????????????  ?????????? ????  ????????????????? ?????????? ?????????? ??????????. ???? ???????? ???????? ?????? ???? ???????????? ???????? ???????????? ?????? ????????????????? ???????????? ????  ?????????????? ??????????????? ?? ?????????? ?????????? ???????? ???? ??????!
 ????  ?????????? ???? ?????????? ???? ????????????????? ??????.  
+\end{article}
+
+\articlesep
+
+
+\begin{editorial}{1}{?????? ???? ???????? ???? ????????????????? ???? ?????? ???????????????? ??????.}{?????? ?? ?????? ????????????????}{4}
+???????? ???????? ???? ?????? ???????????? ???? ???????????? ???????? ?? ???? ?????????? ?????????????? ??????????? ???? ?????????? ???????????? ???????? ??????????????? ???????? ???????? ???????? ?????????? ?????????? ???????????? ????????????  ?????? ?????????????????????? ?????????? ???????? ???????? ???? ?????????? ?????????????? ?????????????? ???? ?????? ?????? ??????.  ????????? ?????? ?????? ???????????? ???? ???? ???????? ???? ?????????? ?????? ???? ????????  ???????????? ???????????? ?????? ????????????? ??????.  ???? ???????? ???? ?????? ?????? ??????????????? ???????? ???? ???????????? ???????? ?? ?????????? ??????????????? ???????????? ?????????? ???? ?????????? ???????? ???????????? ???? ???? ???????? ???? ????????????? ???????????? ???????? ?????? ?????????? ????????. ???????????????? ???? ?????? ?????? ???????????? ??????????????? ???????????? ???? ?????? ????????????? ???? ?????????? ???????? ????????????????? ????????????? ???????? ?????? ?????????????????!
 ?? ???? ???? ???????? ???????? . ???? ?????? ?????? ??????????????? ??????????????? ???????????? ???? ?????? ????????????? ?? ????????????????????? ?????????? ???????? ?????????? ??????????  ???????? ???????? ???? ?????????? ???????????? ???????????? ?????????? ???????? ?? ?????????????? ???????? ?????????????? ????????????????? ?? ??????????????? ???????????? ???? ?????????? ?????????????? ?????????????? ???? ???? ???????? ??????????.
+
+?????? ???????????? ??????????????????????? ??????????????????? ?????????? ?????? ???????? ???? ???? ???? ???? ???????? ??????????????????????????? ???????????????? ?? ???? ???????? ??????????????????????????????? ??????????????? ?????????????.  ???? ??????????? ???? ????????????????? ??????????????????????? ???? ???????? ??????????????????????? ?????????????? ?????????????? ??????????????? ???????????? ???? ????????????????????? ???????????? ?????????????? ???????? ?????? ??????????????? ?????????? ????????????????? ???? ?????????? ?????? ????????????????? ???????? ???????? ????????????????????? ????????????????? ??????????/??????????????????? ??????.  ??????????????? ???? ???????? ?????? ?????????? ?????????????? ?????? ?????????? ?????????? ??????????????? ?????????? ??????????????? ?????????? ???? ???????? ??????????????? ???? ???????? ???????????? ???????? ?????? ???????? ??????????????? ???????? ???????????? ?????????? ???????????? ?????? ?????????????. ?????????? ???!
 ? ?????? ???????????? ???????????? ?????? ??????????????? ???? ???????? ?????????????? ?????? ???????? ?????????????? ?????? ?????? ?? ?????? ?????? ???? ?????????? ??????????????????? ??????????????????? ???????????? ?????? ???? ???? ?????? ?????? ??????????????? ?????????? ??????.
+
+???????????? ???????? ??????? ?????? ???? ?????? ???????????????. ???????? ???????? ?????????? ?????? ????  ??????????????????? ?????????? ???? ????????????????? ??????????????????????? ??????????????? ?????? ???? ?????? ???????? ??????????? ???? ???? ??????????????????????? ?????? ??????????????? ?????????????.  ?????? ???????? ???? ???????????? ?????????? ?????????? ???? ?????????? ?????????? ???????????? ???? ???????? ?? ?????????? ?????????? ????  ???????? ???????? ?????????????.  ???? ???? ???????? ?????????? ?? ????????????????? ???????? ?????????????? ???? ??????????????????? ???????? ?????? ??????????????? ?????? ?? ???? ?????? ???????? ???? ?????? ????????????????? ???????? ?????? ??????????????? ????????????  ?????????? ????  ????????????????? ?????????? ?????????? ??????????. ???? ???????? ???????? ?????? ???? ???????????? ???????? ???????????? ?????? ????????????????? ???????????? ????  ?????????????? ??????????????? ?? ?????????? ?????????? ???????? ???? ??????!
 ????  ?????????? ???? ?????????? ???? ????????????????? ??????.
+\end{editorial}
+
+\articlesep
+
+
+\begin{shortarticle}{4}{???????? ???????????? ??????????}{???????? ???????????? ?????????? ???????? ?????????? ?????????????????}{5}
+\shortarticleitem{?????? ???? ???????? ?????????? ??????}{?????????? ???????? ???? ?????? ???????????? ???? ???????????? ???????? ?? ???? ?????????? ?????????????? ??????????? ???? ?????????? ???????????? ???????? ??????????????? ???????? ???????? ???????? ?????????? ?????????? ???????????? ????????????  ?????? ?????????????????????? ?????????? ???????? ???????? ???? ?????????? ?????????????? ?????????????? ???? ?????? ?????? ??????.  ????????? ?????? ?????? ???????????? ???? ???? ???????? ???? ?????????? ?????? ???? ????????  ???????????? ???????????? ?????? ????????????? ??????.  ???? ???????? ???? ?????? ?????? ??????????????? ???????? ???? ???????????? ???????? ?? ?????????? ??????????????? ???????????? ?????????? ???? ?????????? ???????? ???????????? ???? ???? ???????? ???? ????????????? ???????????? ???????? ?????? ?????????? ????????. ???????????????? ???? ?????? ?????? ???????????? ??????????????? ???????????? ???? ?????? ????????????? ???? ?????????? ???????? ?????!
 ???????????? ????????????? ???????? ?????? ??????????????????? ???? ???? ???????? ???????? . ???? ?????? ?????? ??????????????? ??????????????? ???????????? ???? ?????? ????????????? ?? ????????????????????? ?????????? ???????? ?????????? ??????????  ???????? ???????? ???? ?????????? ???????????? ???????????? ?????????? ???????? ?? ?????????????? ???????? ?????????????? ????????????????? ?? ??????????????? ???????????? ???? ?????????? ?????????????? ?????????????? ???? ???? ???????? ??????????.}
+\shortarticleitem{???? ???????? ?????????? ????????}{?????????? ???????? ???? ?????? ???????????? ???? ???????????? ???????? ?? ???? ?????????? ?????????????? ??????????? ???? ?????????? ???????????? ???????? ??????????????? ???????? ???????? ???????? ?????????? ?????????? ???????????? ????????????  ?????? ?????????????????????? ?????????? ???????? ???????? ???? ?????????? ?????????????? ?????????????? ???? ?????? ?????? ??????.  ????????? ?????? ?????? ???????????? ???? ???? ???????? ???? ?????????? ?????? ???? ????????  ???????????? ???????????? ?????? ????????????? ??????.  ???? ???????? ???? ?????? ?????? ??????????????? ???????? ???? ???????????? ???????? ?? ?????????? ??????????????? ???????????? ?????????? ???? ?????????? ???????? ???????????? ???? ???? ???????? ???? ????????????? ???????????? ???????? ?????? ?????????? ????????. ???????????????? ???? ?????? ?????? ???????????? ??????????????? ???????????? ???? ?????? ????????????? ???? ?????????? ???????? ??????????!
 ??????? ????????????? ???????? ?????? ??????????????????? ???? ???? ???????? ???????? . ???? ?????? ?????? ??????????????? ??????????????? ???????????? ???? ?????? ????????????? ?? ????????????????????? ?????????? ???????? ?????????? ??????????  ???????? ???????? ???? ?????????? ???????????? ???????????? ?????????? ???????? ?? ?????????????? ???????? ?????????????? ????????????????? ?? ??????????????? ???????????? ???? ?????????? ?????????????? ?????????????? ???? ???? ???????? ??????????.}
+\shortarticleitem{???? ???????? ?????????? ????????}{?????????? ???????? ???? ?????? ???????????? ???? ???????????? ???????? ?? ???? ?????????? ?????????????? ??????????? ???? ?????????? ???????????? ???????? ??????????????? ???????? ???????? ???????? ?????????? ?????????? ???????????? ????????????  ?????? ?????????????????????? ?????????? ???????? ???????? ???? ?????????? ?????????????? ?????????????? ???? ?????? ?????? ??????.  ????????? ?????? ?????? ???????????? ???? ???? ???????? ???? ?????????? ?????? ???? ????????  ???????????? ???????????? ?????? ????????????? ??????.  ???? ???????? ???? ?????? ?????? ??????????????? ???????? ???? ???????????? ???????? ?? ?????????? ??????????????? ???????????? ?????????? ???? ?????????? ???????? ???????????? ???? ???? ???????? ???? ????????????? ???????????? ???????? ?????? ?????????? ????????. ???????????????? ???? ?????? ?????? ???????????? ??????????????? ???????????? ???? ?????? ????????????? ???? ?????????? ???????? ??????????!
 ??????? ????????????? ???????? ?????? ??????????????????? ???? ???? ???????? ???????? . ???? ?????? ?????? ??????????????? ??????????????? ???????????? ???? ?????? ????????????? ?? ????????????????????? ?????????? ???????? ?????????? ??????????  ???????? ???????? ???? ?????????? ???????????? ???????????? ?????????? ???????? ?? ?????????????? ???????? ?????????????? ????????????????? ?? ??????????????? ???????????? ???? ?????????? ?????????????? ?????????????? ???? ???? ???????? ??????????.}
+\shortarticleitem{???? ???????? ?????????? ????????}{?????????? ???????? ???? ?????? ???????????? ???? ???????????? ???????? ?? ???? ?????????? ?????????????? ??????????? ???? ?????????? ???????????? ???????? ??????????????? ???????? ???????? ???????? ?????????? ?????????? ???????????? ????????????  ?????? ?????????????????????? ?????????? ???????? ???????? ???? ?????????? ?????????????? ?????????????? ???? ?????? ?????? ??????.  ????????? ?????? ?????? ???????????? ???? ???? ???????? ???? ?????????? ?????? ???? ????????  ???????????? ???????????? ?????? ????????????? ??????.  ???? ???????? ???? ?????? ?????? ??????????????? ???????? ???? ???????????? ???????? ?? ?????????? ??????????????? ???????????? ?????????? ???? ?????????? ???????? ???????????? ???? ???? ???????? ???? ????????????? ???????????? ???????? ?????? ?????????? ????????. ???????????????? ???? ?????? ?????? ???????????? ??????????????? ???????????? ???? ?????? ????????????? ???? ?????????? ???????? ??????????!
 ??????? ????????????? ???????? ?????? ??????????????????? ???? ???? ???????? ???????? . ???? ?????? ?????? ??????????????? ??????????????? ???????????? ???? ?????? ????????????? ?? ????????????????????? ?????????? ???????? ?????????? ??????????  ???????? ???????? ???? ?????????? ???????????? ???????????? ?????????? ???????? ?? ?????????????? ???????? ?????????????? ????????????????? ?? ??????????????? ???????????? ???? ?????????? ?????????????? ?????????????? ???? ???? ???????? ??????????.}
+\shortarticleitem{???? ???????? ?????????? ????????}{?????????? ???????? ???? ?????? ???????????? ???? ???????????? ???????? ?? ???? ?????????? ?????????????? ??????????? ???? ?????????? ???????????? ???????? ??????????????? ???????? ???????? ???????? ?????????? ?????????? ???????????? ????????????  ?????? ?????????????????????? ?????????? ???????? ???????? ???? ?????????? ?????????????? ?????????????? ???? ?????? ?????? ??????.  ????????? ?????? ?????? ???????????? ???? ???? ???????? ???? ?????????? ?????? ???? ????????  ???????????? ???????????? ?????? ????????????? ??????.  ???? ???????? ???? ?????? ?????? ??????????????? ???????? ???? ???????????? ???????? ?? ?????????? ??????????????? ???????????? ?????????? ???? ?????????? ???????? ???????????? ???? ???? ???????? ???? ????????????? ???????????? ???????? ?????? ?????????? ????????. ???????????????? ???? ?????? ?????? ???????????? ??????????????? ???????????? ???? ?????? ????????????? ???? ?????????? ???????? ??????????!
 ??????? ????????????? ???????? ?????? ??????????????????? ???? ???? ???????? ???????? . ???? ?????? ?????? ??????????????? ??????????????? ???????????? ???? ?????? ????????????? ?? ????????????????????? ?????????? ???????? ?????????? ??????????  ???????? ???????? ???? ?????????? ???????????? ???????????? ?????????? ???????? ?? ?????????????? ???????? ?????????????? ????????????????? ?? ??????????????? ???????????? ???? ?????????? ?????????????? ?????????????? ???? ???? ???????? ??????????.}
+\shortarticleitem{???? ???????? ?????????? ????????}{?????????? ???????? ???? ?????? ???????????? ???? ???????????? ???????? ?? ???? ?????????? ?????????????? ??????????? ???? ?????????? ???????????? ???????? ??????????????? ???????? ???????? ???????? ?????????? ?????????? ???????????? ????????????  ?????? ?????????????????????? ?????????? ???????? ???????? ???? ?????????? ?????????????? ?????????????? ???? ?????? ?????? ??????.  ????????? ?????? ?????? ???????????? ???? ???? ???????? ???? ?????????? ?????? ???? ????????  ???????????? ???????????? ?????? ????????????? ??????.  ???? ???????? ???? ?????? ?????? ??????????????? ???????? ???? ???????????? ???????? ?? ?????????? ??????????????? ???????????? ?????????? ???? ?????????? ???????? ???????????? ???? ???? ???????? ???? ????????????? ???????????? ???????? ?????? ?????????? ????????. ???????????????? ???? ?????? ?????? ???????????? ??????????????? ???????????? ???? ?????? ????????????? ???? ?????????? ???????? ??????????!
 ??????? ????????????? ???????? ?????? ??????????????????? ???? ???? ???????? ???????? . ???? ?????? ?????? ??????????????? ??????????????? ???????????? ???? ?????? ????????????? ?? ????????????????????? ?????????? ???????? ?????????? ??????????  ???????? ???????? ???? ?????????? ???????????? ???????????? ?????????? ???????? ?? ?????????????? ???????? ?????????????? ????????????????? ?? ??????????????? ???????????? ???? ?????????? ?????????????? ?????????????? ???? ???? ???????? ??????????.}
+\end{shortarticle}
+
+\articlesep
+
+\end{document}
+%</magazine-sample.tex>
+%<*test-correction.tex>
+\documentclass{article}
+\usepackage[correction]{xepersian-multiplechoice}
+\usepackage{xepersian}
+\settextfont[Scale=1]{XB Zar}
+\setlatintextfont[Scale=1]{Linux Libertine}
+\setdigitfont[Scale=1]{Parsi Digits}
+\begin{document}
+\begin{question}{?????? ???$A=\{ 1,2\} $??? ?? ???$B=\{ 2,3\} $??? ?????????? ???????? $B^2-A\times B$ ???????? ??????.}
+\false $\{(3,2),(3,3)\} $
+\true $\{(2,2),(2,3)\} $
+\false $\{(2,3),(3,3)\} $
+\false $\{(2,2),(3,2)\} $
+\end{question}
+
+\begin{question}{?????? ???$A=\{ 1,2\} $??? ?? ???$B=\{ 2,3\} $??? ?????????? ???????? $B^2-A\times B$ ???????? ??????.}
+\true $x$
+\false $y$
+\false $z$
+\false $t$
+\end{question}
+
+\begin{question}{??????????????? $(B-A^{'})^{'}$ ????????????? ?????? ????:}
+\false $B^{'}\bigcap A$
+\false $B'\bigcup A' $
+\true $A$
+\false ??????????????.
+\end{question}
+
+\begin{question}{???????? ?????????????? ?????? ?????????? ???$\frac{7+i}{1-i}$??? ???????? ??????.}
+\false $4+4i$
+\false $4-3i$
+\false $3+4i$
+\true $3-3i$
+\end{question}
+\begin{correction}
+???????? ???????? ?????? ???? ?????????? ??????.
+\end{correction}
+
+
+\end{document}
+%</test-correction.tex>
+%<*test-empty-form.tex>
+\documentclass{article}
+\usepackage{xepersian-multiplechoice}
+\usepackage{xepersian}
+\settextfont[Scale=1]{XB Zar}
+\setlatintextfont[Scale=1]{Linux Libertine}
+\setdigitfont[Scale=1]{Parsi Digits}
+\begin{document}
+\begin{question}{?????? ???$A=\{ 1,2\} $??? ?? ???$B=\{ 2,3\} $??? ?????????? ???????? $B^2-A\times B$ ???????? ??????.}
+\false $\{(3,2),(3,3)\} $
+\true $\{(2,2),(2,3)\} $
+\false $\{(2,3),(3,3)\} $
+\false $\{(2,2),(3,2)\} $
+\end{question}
+
+\begin{question}{?????? ???$A=\{ 1,2\} $??? ?? ???$B=\{ 2,3\} $??? ?????????? ???????? $B^2-A\times B$ ???????? ??????.}
+\true $x$
+\false $y$
+\false $z$
+\false $t$
+\end{question}
+
+\begin{question}{??????????????? $(B-A^{'})^{'}$ ????????????? ?????? ????:}
+\false $B^{'}\bigcap A$
+\false $B'\bigcup A' $
+\true $A$
+\false ??????????????.
+\end{question}
+
+\begin{question}{???????? ?????????????? ?????? ?????????? ???$\frac{7+i}{1-i}$??? ???????? ??????.}
+\false $4+4i$
+\false $4-3i$
+\false $3+4i$
+\true $3-3i$
+\end{question}
+\begin{correction}
+???????? ???????? ?????? ???? ?????????? ??????.
+\end{correction}
+\bigskip 
+
+\begin{center}
+\makeform
+\end{center}
+\end{document}
+%</test-empty-form.tex>
+%<*test-question-only.tex>
+\documentclass{article}
+\usepackage{xepersian-multiplechoice}
+\usepackage{xepersian}
+\settextfont[Scale=1]{XB Zar}
+\setlatintextfont[Scale=1]{Linux Libertine}
+\setdigitfont[Scale=1]{Parsi Digits}
+\begin{document}
+\begin{question}{?????? ???$A=\{ 1,2\} $??? ?? ???$B=\{ 2,3\} $??? ?????????? ???????? $B^2-A\times B$ ???????? ??????.}
+\false $\{(3,2),(3,3)\} $
+\true $\{(2,2),(2,3)\} $
+\false $\{(2,3),(3,3)\} $
+\false $\{(2,2),(3,2)\} $
+\end{question}
+
+\begin{question}{?????? ???$A=\{ 1,2\} $??? ?? ???$B=\{ 2,3\} $??? ?????????? ???????? $B^2-A\times B$ ???????? ??????.}
+\true $x$
+\false $y$
+\false $z$
+\false $t$
+\end{question}
+
+\begin{question}{??????????????? $(B-A^{'})^{'}$ ????????????? ?????? ????:}
+\false $B^{'}\bigcap A$
+\false $B'\bigcup A' $
+\true $A$
+\false ??????????????.
+\end{question}
+
+\begin{question}{???????? ?????????????? ?????? ?????????? ???$\frac{7+i}{1-i}$??? ???????? ??????.}
+\false $4+4i$
+\false $4-3i$
+\false $3+4i$
+\true $3-3i$
+\end{question}
+\begin{correction}
+???????? ???????? ?????? ???? ?????????? ??????.
+\end{correction}
+
+
+\end{document}
+%</test-question-only.tex>
+%<*test-solution-form.tex>
+\documentclass{article}
+\usepackage{xepersian-multiplechoice}
+\usepackage{xepersian}
+\settextfont[Scale=1]{XB Zar}
+\setlatintextfont[Scale=1]{Linux Libertine}
+\setdigitfont[Scale=1]{Parsi Digits}
+\begin{document}
+\begin{question}{?????? ???$A=\{ 1,2\} $??? ?? ???$B=\{ 2,3\} $??? ?????????? ???????? $B^2-A\times B$ ???????? ??????.}
+\false $\{(3,2),(3,3)\} $
+\true $\{(2,2),(2,3)\} $
+\false $\{(2,3),(3,3)\} $
+\false $\{(2,2),(3,2)\} $
+\end{question}
+
+\begin{question}{?????? ???$A=\{ 1,2\} $??? ?? ???$B=\{ 2,3\} $??? ?????????? ???????? $B^2-A\times B$ ???????? ??????.}
+\true $x$
+\false $y$
+\false $z$
+\false $t$
+\end{question}
+
+\begin{question}{??????????????? $(B-A^{'})^{'}$ ????????????? ?????? ????:}
+\false $B^{'}\bigcap A$
+\false $B'\bigcup A' $
+\true $A$
+\false ??????????????.
+\end{question}
+
+\begin{question}{???????? ?????????????? ?????? ?????????? ???$\frac{7+i}{1-i}$??? ???????? ??????.}
+\false $4+4i$
+\false $4-3i$
+\false $3+4i$
+\true $3-3i$
+\end{question}
+\begin{correction}
+???????? ???????? ?????? ???? ?????????? ??????.
+\end{correction}
+
+\bigskip
+\begin{center}
+\makemask
+\end{center}
+\end{document}
+%</test-solution-form.tex>
+%<*acm-fa-output.tex>
+\documentclass[11pt,a4paper]{article} 
+
+
+\usepackage{verbatim}
+\usepackage{xepersian}
+\settextfont[Scale=1]{XB Zar}%{XB Zar}
+\setlatintextfont[Scale=.95]{Linux Libertine}%{Arial}%
+\setdigitfont{Parsi Digits}
+
+\title{?????????? ?????????? ???? ?????? ?????????? \lr{acm-fa} ???? ?????????????????}
+\author{}\date{}
+\begin{document}
+\maketitle
+\nocite{*}
+\bibliographystyle{acm-fa}%{ieeetr-fa}%{persia}%
+\bibliography{MyReferences}
+
+
+\end{document}
+%</acm-fa-output.tex>
+%<*bibtex-example.tex>
+\documentclass[11pt,a4paper]{article} 
+% ?????????? ????????????????????? http://webpages.iust.ac.ir/mamintoosi
+% ???????? ???????? ?????????? ???????? ?????????????? ???? ??????????????? ?????????? ???? ????????????????? ???????????????.
+% ???????? ???????????? ???? ???????? ?????????????? ???? ?????? ???????? ???????? ???? ???????? ?????? ?????? ????????????:
+% xelatex filename  (???? ?????????????++ F6 ???? Ctrl+F6) - ???? ???????? ???? ?????????????? ?????????????????
+% bibtex  filename  (???????? ?????????? ???? ???? ?????????? ?????????????++)
+% xelatex filename  (???? ?????????????++ F6)
+% xelatex filename  (???? ?????????????++ F6 ???? Ctrl+F6)
+% ???? ?????? ???????? ???? ?????? filename ???????? bibtex_example ???????? ????????.
+% ???????? ???????????? ??????????????? ???????? MyReferences.bib ???? ?????? ????????. ???? ???????? ?????????? ?????? ???????? ???????????? ???? ??????????????? ?????????? ???? ???? ???? ??????????????? ???? ???????? ????????????.
+% ???? ???????? ?????????? ???? ?????????????? ???? ?????? ???????? ???????? ???? ???????? ?????????? ?????????? ????????.
+
+% ???? ?????? unsrt ??????????????????? ???????? ????????????? ???? ???????? ???????? ?? ?????????? ???? ???????????? ????????????. (plain-fa, acm-fa, ieeetr-fa, persia)
+
+\usepackage{verbatim}
+\usepackage{backref}
+\def\backrefpagesname{}
+\usepackage{xepersian}
+\settextfont[Scale=1]{XB Zar}
+\setlatintextfont[Scale=.95]{Linux Libertine}%{Times New latin}
+\setdigitfont{Parsi Digits}
+
+\title{?????????? ?????????? ???? ?????????? ?????????? \lr{unsrt-fa} ???????? \lr{BibTeX} ???? ?????????????????}
+\author{}\date{}
+\begin{document}
+\maketitle
+
+???????? \cite{??????????????82??????????} ???? ?????????? ?????????? ?????????? ?? ????????\cite{??????????87} ???? ?????????? ?????????? ???????? ?????????? ??????.
+???????? \cite{Baker02limits} ???? ?????????? ?????????? ?????????????? ?????? ???? ???? ?????? ?????????? ?????????? ???????? ?????????? ???????? ???????? \cite{Amintoosi87using}  ???? ??????????  ?????????? ?????????????? ?????????? ??
+???????? \cite{????????????????????????????} ???? ?????????? ???????? ?????????? ???? ?????? ?????????????? ?? ???????????????????? ?????????? ??????. ???????? \cite{Khalighi07MscThesis} ???? ?????????? ?????????? ???????????????? ???????? ?????????????? ??
+\cite{???????????????????????????????} ???? ???? ?????????? ????????????  ?????????????????.
+
+%\nocite{*}
+{\small
+\bibliographystyle{unsrt-fa}%{plain-fa}%{ieeetr-fa}%{persia}%
+\bibliography{MyReferences}
+}
+
+\end{document}
+%</bibtex-example.tex>
+%<*ieeetr-fa-output.tex>
+\documentclass[11pt,a4paper]{article} 
+% ?????????? ????????????????????? http://webpages.iust.ac.ir/mamintoosi
+
+\usepackage{verbatim}
+\usepackage{xepersian}
+\settextfont[Scale=1]{XB Zar}%{XB Zar}
+\setlatintextfont[Scale=.95]{Linux Libertine}%{Arial}%
+\setdigitfont{Parsi Digits}
+
+\title{?????????? ?????????? ???? ?????? ?????????? \lr{ieeetr-fa} ???? ?????????????????}
+\author{}\date{}
+\begin{document}
+\maketitle
+
+\nocite{*}
+
+\bibliographystyle{ieeetr-fa}%{persia}%
+\bibliography{MyReferences}
+
+
+\end{document}
+%</ieeetr-fa-output.tex>
+%<*MyReferences.bib>
+???@article{Baker02limits,
+ author = {Baker,, Simon and Kanade,, Takeo},
+ title = {Limits on Super-Resolution and How to Break Them},
+ journal = {IEEE Trans. Pattern Anal. Mach. Intell.},
+ volume = {24},
+ number = {9},
+ year = {2002},
+ issn = {0162-8828},
+ pages = {1167--1183},
+ publisher = {IEEE Computer Society},
+ address = {Washington, DC, USA}
+ }
+
+ at CONFERENCE{Amintoosi87using,
+  AUTHOR =       {\noopsort{???????????????????,??????????}{???????????????????,??????????} and others},
+  TITLE =        {?????????????? ???? ?????????? ???????????? ???? ???????? ????????},
+  BOOKTITLE =    {???????????? ?????????????? ???????????? ??????????},
+  YEAR =         {1387},
+  ORGANIZATION = {?????????????? ??????????},
+  ADDRESS =      {???????????? ??????????},
+  PAGES = 		 {172-178},
+  LANGUAGE =     {Persian}
+}
+
+ at MASTERSTHESIS{??????????????????????????,
+  AUTHOR =       {\noopsort{????????????????, ??????????????????}{??????????????, ??????????????????}},
+  TITLE =        {???? ?????????? ??????????},
+  SCHOOL =       {?????????????? ???????????? ?????????????? ?????????????????????},
+  YEAR =         {????????},
+  MONTH =        {??????????},
+  NOTE = 		 {(???? ?????? ??????????)},
+  LANGUAGE =     {Persian}
+}
+
+ at MASTERSTHESIS{Khalighi07MscThesis,
+  AUTHOR =       {Vafa Khalighi},
+  TITLE =        {Category Theory},
+  SCHOOL =       {Sydny Univ.},
+  YEAR =         {2007},
+  MONTH =        {April}
+}
+
+ at PHDTHESIS{??????????????82??????????,
+  AUTHOR =       {\noopsort{??????????????, ????????}{??????????????, ????????}},
+  TITLE =        {???????? ????????????},
+  SCHOOL =       {?????????????? ???????????? ?????????????? ????????????????},
+  YEAR =         {1382},
+  MONTH =        {??????},
+  LANGUAGE =     {Persian}
+}
+
+ at MISC{???????????????????????????????,
+  AUTHOR =       {\noopsort{??????????,??????}{??????????,??????}  and ??????????????, ???????? and  ??????????,??????????.},
+  TITLE =        {????????????????? (\lr{\XePersian}): ???????? ?????????? ???????? ??????????????????? ???? \lr{\LaTeX2e}},
+  HOWPUBLISHED =    {\lr{http://wiki.parsilatex.org}},
+  YEAR =         {????????},  
+  LANGUAGE =     {Persian}
+  }
+
+ at BOOK{????????????????????????????,
+  AUTHOR =       {\noopsort{????????????????, ????????????}{????????????????, ????????????}},
+  EDITOR =       {??????????????, ??????????},
+  translator =   { ????????????? ??????????????, ???????? and ??????????,???????? },
+  TITLE =        {???????? ?????????? ?? ???????????????? ?????????? ??????????????????? ????????},
+  PUBLISHER =    {?????? ?????? ??????????},
+  YEAR =         {????????},
+  ADDRESS =      {????????????},
+  edition =      {??????},
+  MONTH =        {????????},
+  LANGUAGE =     {Persian}
+}
+  
+ at ARTICLE{??????????87,
+  AUTHOR = 		{\noopsort{??????????, ??????????}{??????????, ??????????}},
+  TITLE = 		{???????????? ???????? ???? ?????????? ????????????????},
+  JOURNAL = 	{???????? ?????????? ??????????},
+  VOLUME = 		{1},
+  YEAR = 		{1387},
+  NUMBER = 		{2},
+  MONTH = 		{????????},
+  PAGES = 		{22-30},
+  LANGUAGE =  	{Persian}
+}
+
+ at CONFERENCE{Amintoosi09regional,
+  author =       {Mahmood Amintoosi and Mahmood Fathy and Nasser Mozayani},
+  title =        {Regional Varying Image Super-Resolution},
+  booktitle =    {(CSO 2009) The 2009 IEEE International Joint Conference on Computational Sciences and Optimization},
+  year =         {2009},
+  month =        {24-26 April},
+  organization = {City University},
+  address =      {Sanya, Hainan, China},
+  pages =        {101-105}
+}
+
+ at PHDTHESIS{Farsiu05thesis,
+  AUTHOR =       {Sina Farsiu},
+  TITLE =        {A Fast and Robust Framework for Image Fusion and Enhancement},
+  SCHOOL =       {Electrical Engineeting},
+  YEAR =         {2005},
+  ADDRESS =      {UC Santa Cruz},
+  MONTH =        {December}
+}
+
+
+ at BOOK{Gonzalez02book,
+  AUTHOR =      {Gonzalez,, Rafael C. and Woods,, Richard E.},
+  TITLE =       {Digital Image Processing},
+  PUBLISHER =   {Prentice-Hall, Inc.},
+  YEAR =        {2006},
+  ISBN = 		{013168728X},
+  EDITION = 	{3rd},
+  ADDRESS = {Upper Saddle River, NJ, USA},
+}
+%</MyReferences.bib>
+%<*plain-fa-output.tex>
+\documentclass[11pt,a4paper]{article} 
+% ?????????? ????????????????????? http://webpages.iust.ac.ir/mamintoosi
+
+\usepackage{verbatim}
+\usepackage{xepersian}
+\settextfont[Scale=1]{XB Zar}%{XB Zar}
+\setlatintextfont[Scale=.95]{Linux Libertine}%{Arial}%
+\setdigitfont{XB Zar}
+
+\title{?????????? ?????????? ???? ?????? ?????????? \lr{plain-fa} ???? ?????????????????}
+\author{}\date{}
+\begin{document}
+\maketitle
+
+\nocite{*}
+
+\bibliographystyle{plain-fa}%{ieeetr-fa}%{persia}%
+\bibliography{MyReferences1}
+
+
+\end{document}
+%</plain-fa-output.tex>
+% \fi
+% 
+% \typeout{*************************************************************}
+% \typeout{*}
+% \typeout{* To finish the installation you have to move the following}
+% \typeout{* file into a directory searched by TeX:}
+% \typeout{*}
+% \typeout{* \space\space\space all *.cls, *.sty and *.def  files}
+% \typeout{* You also need to compile the *.map files with teckit_compile}
+% \typeout{* and place the resulting *.tec files under}
+% \typeout{* .../fonts/misc/xetex/fontmapping/xepersian}
+% \typeout{*}
+% \typeout{*************************************************************}
+\endinput



From vafa at mail.berlios.de  Sat May 30 07:52:22 2009
From: vafa at mail.berlios.de (vafa at mail.berlios.de)
Date: Sat, 30 May 2009 07:52:22 +0200
Subject: [Xepersian-development] r35 - trunk
Message-ID: <200905300552.n4U5qM0C010071@sheep.berlios.de>

Author: vafa
Date: 2009-05-30 07:52:17 +0200 (Sat, 30 May 2009)
New Revision: 35

Modified:
   trunk/xepersian.dtx
Log:
added etoolbox package

Modified: trunk/xepersian.dtx
===================================================================
--- trunk/xepersian.dtx	2009-05-30 03:36:52 UTC (rev 34)
+++ trunk/xepersian.dtx	2009-05-30 05:52:17 UTC (rev 35)
@@ -195,6 +195,7 @@
 \RequirePackage{fontspec}
 \RequirePackage{xepersian-persiancal}
 \RequirePackage{xepersian-mathsdigitspec}
+\RequirePackage{etoolbox}
 \gdef\@latex at error#1#2{%
    \GenericError{%
       \space\space\space\@spaces\@spaces\@spaces



From vafa at mail.berlios.de  Sat May 30 08:03:13 2009
From: vafa at mail.berlios.de (vafa at mail.berlios.de)
Date: Sat, 30 May 2009 08:03:13 +0200
Subject: [Xepersian-development] r36 - trunk
Message-ID: <200905300603.n4U63DR9010903@sheep.berlios.de>

Author: vafa
Date: 2009-05-30 08:03:08 +0200 (Sat, 30 May 2009)
New Revision: 36

Modified:
   trunk/xepersian.dtx
Log:
deleted the extra v

Modified: trunk/xepersian.dtx
===================================================================
--- trunk/xepersian.dtx	2009-05-30 05:52:17 UTC (rev 35)
+++ trunk/xepersian.dtx	2009-05-30 06:03:08 UTC (rev 36)
@@ -189,7 +189,7 @@
 \ProvidesPackage{xepersian}[\xepersiandate\space \xepersianversion\space <\xepersianrevision>
 	Persian typesetting in XeLaTeX]
 \AtBeginDocument{\special{pdf: docinfo <<
-	/Creator (X?Persian v\xepersianversion\space <\xepersianrevision> Copyright ? 2008-2009 Vafa Khalighi)
+	/Creator (X?Persian \xepersianversion\space <\xepersianrevision> Copyright ? 2008-2009 Vafa Khalighi)
          >>}}
 \RequirePackage[RTLdocument]{bidi}
 \RequirePackage{fontspec}



From vafa at mail.berlios.de  Sat May 30 10:39:51 2009
From: vafa at mail.berlios.de (vafa at mail.berlios.de)
Date: Sat, 30 May 2009 10:39:51 +0200
Subject: [Xepersian-development] r37 - trunk
Message-ID: <200905300839.n4U8dpK9013497@sheep.berlios.de>

Author: vafa
Date: 2009-05-30 10:39:47 +0200 (Sat, 30 May 2009)
New Revision: 37

Modified:
   trunk/xepersian.dtx
Log:
the required change of \bf to \bfseries in latin environment in xepersian-thesis.cls. Also since we are only loading amsmath packlage only, we need to say \usepackage{graphicx} at the beginning of thesis-sample.tex

Modified: trunk/xepersian.dtx
===================================================================
--- trunk/xepersian.dtx	2009-05-30 06:03:08 UTC (rev 36)
+++ trunk/xepersian.dtx	2009-05-30 08:39:47 UTC (rev 37)
@@ -2910,8 +2910,8 @@
 \def\latinabstract{\newpage
 \thispagestyle{empty}
 \vskip 15mm
-\begin{center}{\Large\bf \@latintitle \\[5mm]}
-{\bf Abstract}
+\begin{center}{\Large\bfseries \@latintitle \\[5mm]}
+{\bfseries Abstract}
 \end{center}
 \vspace{5mm}}
 
@@ -2961,8 +2961,8 @@
 {\titlefont \@latintitle} \par
 \addtolength{\baselineskip}{-5mm}
 \vskip 1cm
-{\bf\latinby}\par
-{\Large\bf \@latinauthor}\par
+{\bfseries\latinby}\par
+{\Large\bfseries \@latinauthor}\par
 \vskip 5mm
 {\latinwrittenfor\par
 \large\@latindegree}
@@ -2975,7 +2975,7 @@
 {\@latinthesisdate}
 \par
 \vskip 1cm
-\large\bf
+\large\bfseries
 \@latindepartment\space Department
 \par
 \@latinuniversity \par\@latincity
@@ -8565,6 +8565,7 @@
 f.close()	
%</ftxe-0.1.py>
 %<*thesis-sample.tex>
 \documentclass[a4paper,11pt]{xepersian-thesis}
+\usepackage{graphicx}
 \usepackage{xepersian}
 \settextfont[Scale=1]{XB Zar}
 \setlatintextfont[Scale=1]{Linux Libertine}



From vafa at mail.berlios.de  Sat May 30 17:18:14 2009
From: vafa at mail.berlios.de (vafa at mail.berlios.de)
Date: Sat, 30 May 2009 17:18:14 +0200
Subject: [Xepersian-development] r38 - trunk
Message-ID: <200905301518.n4UFIEgk026594@sheep.berlios.de>

Author: vafa
Date: 2009-05-30 17:17:59 +0200 (Sat, 30 May 2009)
New Revision: 38

Modified:
   trunk/xepersian.dtx
Log:
graphicx and xunicode packages are needed for magazine-sample.tex because (1) we need to include images and (2) we need the textdegree symbol. Also note that xunicode unfortunately has got to be loaded after xepersian package since we already loaded amsmath packages in the bidi package and doing otherwise would make trouble.

Modified: trunk/xepersian.dtx
===================================================================
--- trunk/xepersian.dtx	2009-05-30 08:39:47 UTC (rev 37)
+++ trunk/xepersian.dtx	2009-05-30 15:17:59 UTC (rev 38)
@@ -8633,7 +8633,9 @@
 %</thesis-sample.tex>
 %<*magazine-sample.tex>
 \documentclass[12pt,twoside]{xepersian-magazine}
+\usepackage{graphicx}
 \usepackage{xepersian}
+\usepackage{xunicode}
 \settextfont[Scale=1]{XB Zar}
 \setlatintextfont[Scale=1]{Junicode}
 \setdigitfont{XB Zar}



From vafa at mail.berlios.de  Sun May 31 04:47:07 2009
From: vafa at mail.berlios.de (vafa at mail.berlios.de)
Date: Sun, 31 May 2009 04:47:07 +0200
Subject: [Xepersian-development] r39 - trunk
Message-ID: <200905310247.n4V2l75j016851@sheep.berlios.de>

Author: vafa
Date: 2009-05-31 04:47:02 +0200 (Sun, 31 May 2009)
New Revision: 39

Modified:
   trunk/xepersian.dtx
Log:
with the bidimoderncv class, we needed to define the Persian caption for \refname. And we had to do a bit of change to bidi footnote mechanism: we had to use \latinfont instead \rmfamily and \PersianFootNum instead \NativeFootNum

Modified: trunk/xepersian.dtx
===================================================================
--- trunk/xepersian.dtx	2009-05-30 15:17:59 UTC (rev 38)
+++ trunk/xepersian.dtx	2009-05-31 02:47:02 UTC (rev 39)
@@ -71,8 +71,10 @@
 \generate{\file{amsbook-xepersian.def}{\from{xepersian.dtx}{amsbook-xepersian.def}}}
 \generate{\file{article-xepersian.def}{\from{xepersian.dtx}{article-xepersian.def}}}
 \generate{\file{beamer-xepersian.def}{\from{xepersian.dtx}{beamer-xepersian.def}}}
+\generate{\file{bidimoderncv-xepersian.def}{\from{xepersian.dtx}{bidimoderncv-xepersian.def}}}
 \generate{\file{bookest-xepersian.def}{\from{xepersian.dtx}{bookest-xepersian.def}}}
 \generate{\file{book-xepersian.def}{\from{xepersian.dtx}{book-xepersian.def}}}
+\generate{\file{footnote-bidi-xepersian.def}{\from{xepersian.dtx}{footnote-bidi-xepersian.def}}}
 \generate{\file{localise-xepersian.def}{\from{xepersian.dtx}{localise-xepersian.def}}}
 \generate{\file{commands-ltx.def}{\from{xepersian.dtx}{commands-ltx.def}}}
 \generate{\file{commands-xepersian.def}{\from{xepersian.dtx}{commands-xepersian.def}}}
@@ -331,9 +333,11 @@
 \@ifpackageloaded{listings}{\input{listings-xepersian.def}}{}
 \@ifpackageloaded{algorithmic}{\input{algorithmic-xepersian.def}}{}
 \@ifpackageloaded{algorithm}{\input{algorithm-xepersian.def}}{}
+\@ifpackageloaded{bidi}{\input{footnote-bidi-xepersian.def}}{}
 \@ifpackageloaded{enumerate}{\input{enumerate-xepersian.def}}{}
 \@ifclassloaded{article}{\input{article-xepersian.def}}{}
 \@ifclassloaded{amsart}{\input{amsart-xepersian.def}}{}
+\@ifclassloaded{bidimoderncv}{\input{bidimoderncv-xepersian.def}}{}
 \@ifclassloaded{report}{\input{report-xepersian.def}}{}
 \@ifclassloaded{xepersian-thesis}{\input{xepersian-thesis-xepersian.def}}{}
 \@ifclassloaded{amsbook}{\input{amsbook-xepersian.def}}{}
@@ -433,6 +437,14 @@
 %    \end{macrocode}
 % \iffalse
 %</beamer-xepersian.def>
+%<*bidimoderncv-xepersian.def>
+% \fi
+% \part{bidimoderncv-xepersian.def}
+%    \begin{macrocode}
+\def\refname{???????}
+%    \end{macrocode}
+% \iffalse
+%</bidimoderncv-xepersian.def>
 %<*bookest-xepersian.def>
 % \fi
 % \part{bookest-xepersian.def}
@@ -471,6 +483,21 @@
 %    \end{macrocode}
 % \iffalse
 %</book-xepersian.def>
+%<*footnote-bidi-xepersian.def>
+% \fi
+% \part{footnote-bidi-xepersian.def}
+%    \begin{macrocode}
+\DeclareRobustCommand{\LTRfootnote}[1]{%
+\bgroup
+\footnotemark%
+\renewcommand{\thefootnote}{\if at RomanFootNum\latinfont{\@arabic\c at footnote}\else\@arabic\c at footnote\fi}%
+\@RTLfalse\footnotetext{\latinfont#1}%
+\egroup
+}
+\let\PersianFootNum=\NativeFootNum
+%    \end{macrocode}
+% \iffalse
+%</footnote-bidi-xepersian.def>
 %<*localise-xepersian.def>
 % \fi
 % \part{localise-xepersian.def}



From vafa at mail.berlios.de  Sun May 31 06:32:25 2009
From: vafa at mail.berlios.de (vafa at mail.berlios.de)
Date: Sun, 31 May 2009 06:32:25 +0200
Subject: [Xepersian-development] r40 - trunk
Message-ID: <200905310432.n4V4WPjY003722@sheep.berlios.de>

Author: vafa
Date: 2009-05-31 06:32:19 +0200 (Sun, 31 May 2009)
New Revision: 40

Modified:
   trunk/xepersian.dtx
Log:
Options of the bidi package are accessible in xepersian package, i.e. \usepackage[RomanFootnum] is the same as \usepackage[RomanFootNum]{bidi}\usepackage{xepersian}

Modified: trunk/xepersian.dtx
===================================================================
--- trunk/xepersian.dtx	2009-05-31 02:47:02 UTC (rev 39)
+++ trunk/xepersian.dtx	2009-05-31 04:32:19 UTC (rev 40)
@@ -186,13 +186,17 @@
 %    \begin{macrocode}
 \NeedsTeXFormat{LaTeX2e}
 \def\xepersianversion{v1.0.1}
-\def\xepersianrevision{revision 33}
+\def\xepersianrevision{revision 40}
 \def\xepersiandate{2009/06/01}
 \ProvidesPackage{xepersian}[\xepersiandate\space \xepersianversion\space <\xepersianrevision>
 	Persian typesetting in XeLaTeX]
 \AtBeginDocument{\special{pdf: docinfo <<
 	/Creator (X?Persian \xepersianversion\space <\xepersianrevision> Copyright ? 2008-2009 Vafa Khalighi)
          >>}}
+\DeclareOption{Kashida}{\input{kashida-xepersian.def}}
+\DeclareOption{localise}{\input{localise-xepersian.def}}
+\DeclareOption*{\PassOptionsToPackage{\CurrentOption}{bidi}}
+\ProcessOptions\relax
 \RequirePackage[RTLdocument]{bidi}
 \RequirePackage{fontspec}
 \RequirePackage{xepersian-persiancal}
@@ -209,7 +213,6 @@
 }
 \gdef\@latexbug{%
   \@latex at error{This may be a XePersian bug}{Please inform the Author of XePersian}}
-\DeclareOption{Kashida}{\input{kashida-xepersian.def}}
 \newfontscript{Persian}{arab}
 \newfontlanguage{Persian}{ARA}
 \newcommand*\settextfont[2][]{%
@@ -346,8 +349,6 @@
 \@ifclassloaded{book}{\input{book-xepersian.def}}{}
 \@ifclassloaded{refrep}{\input{refrep-xepersian.def}}{}
 \@ifclassloaded{beamer}{\input{beamer-xepersian.def}}{}
-\DeclareOption{localise}{\input{localise-xepersian.def}}
-\ProcessOptions
 %    \end{macrocode}
 % \iffalse
 %</xepersian.sty>



From vafa at mail.berlios.de  Sun May 31 07:51:06 2009
From: vafa at mail.berlios.de (vafa at mail.berlios.de)
Date: Sun, 31 May 2009 07:51:06 +0200
Subject: [Xepersian-development] r41 - trunk
Message-ID: <200905310551.n4V5p64h031010@sheep.berlios.de>

Author: vafa
Date: 2009-05-31 07:51:01 +0200 (Sun, 31 May 2009)
New Revision: 41

Modified:
   trunk/xepersian.dtx
Log:
only tfm fonts are loaded in the doc

Modified: trunk/xepersian.dtx
===================================================================
--- trunk/xepersian.dtx	2009-05-31 04:32:19 UTC (rev 40)
+++ trunk/xepersian.dtx	2009-05-31 05:51:01 UTC (rev 41)
@@ -122,38 +122,13 @@
 %
 %<*driver>
 \documentclass{ltxdoc}
-\usepackage[dvipdfm,
-    bookmarks=true,
-    colorlinks=true,
-    linkcolor=myblue,
-    urlcolor=myblue,
-    citecolor=myblue,
-    hyperindex=false,
-    hyperfootnotes=false,
-    pdftitle={The bidi package},
-    pdfauthor={Vafa Khalighi <vafa at users.berlios.de>},
-    pdfsubject={An interface for typesetting bidirectional texts with XeLaTeX},
-    pdfkeywords={XeTeX, XeLaTeX, Right-to-Left, Bidi, Persian, Hebrew, Arabic}
-    ]{hyperref}
-\usepackage{multicol}
-\usepackage{xltxtra}
-\usepackage{fancyvrb}
+\usepackage[sc,osf]{mathpazo}
+\usepackage{fvrb-ex}
 \usepackage{xcolor}
 \definecolor{myred}{rgb}{0.65,0.04,0.07}
 \fvset{formatcom=\color{myred}}
 \DefineShortVerb{\|}
 \def\theCodelineNo{\textcolor{myred}{\sffamily\tiny\arabic{CodelineNo}}}
-\usepackage{fontspec}
-\setmainfont[Mapping=tex-text]{Brioso Pro}
-\setmonofont[Scale=0.8]{Arial}
-\setsansfont[Scale=0.8]{DejaVu Sans}
-\makeatletter
-\setlength\columnseprule{0.8pt}
-\renewcommand\tableofcontents{\relax
-  \begin{multicols}{2}[\section*{\contentsname}]\small
-    \@starttoc{toc}\relax
-  \end{multicols}}
-\makeatother
 \EnableCrossrefs
 \CodelineIndex
 \RecordChanges



From vafa at mail.berlios.de  Sun May 31 08:07:00 2009
From: vafa at mail.berlios.de (vafa at mail.berlios.de)
Date: Sun, 31 May 2009 08:07:00 +0200
Subject: [Xepersian-development] r42 - trunk
Message-ID: <200905310607.n4V670bA032212@sheep.berlios.de>

Author: vafa
Date: 2009-05-31 08:06:56 +0200 (Sun, 31 May 2009)
New Revision: 42

Modified:
   trunk/xepersian.dtx
Log:
no codeline color is preferred

Modified: trunk/xepersian.dtx
===================================================================
--- trunk/xepersian.dtx	2009-05-31 05:51:01 UTC (rev 41)
+++ trunk/xepersian.dtx	2009-05-31 06:06:56 UTC (rev 42)
@@ -124,11 +124,6 @@
 \documentclass{ltxdoc}
 \usepackage[sc,osf]{mathpazo}
 \usepackage{fvrb-ex}
-\usepackage{xcolor}
-\definecolor{myred}{rgb}{0.65,0.04,0.07}
-\fvset{formatcom=\color{myred}}
-\DefineShortVerb{\|}
-\def\theCodelineNo{\textcolor{myred}{\sffamily\tiny\arabic{CodelineNo}}}
 \EnableCrossrefs
 \CodelineIndex
 \RecordChanges



From vafa at mail.berlios.de  Sun May 31 17:29:44 2009
From: vafa at mail.berlios.de (vafa at mail.berlios.de)
Date: Sun, 31 May 2009 17:29:44 +0200
Subject: [Xepersian-development] r43 - trunk
Message-ID: <200905311529.n4VFTiVU017018@sheep.berlios.de>

Author: vafa
Date: 2009-05-31 17:29:39 +0200 (Sun, 31 May 2009)
New Revision: 43

Modified:
   trunk/xepersian.dtx
Log:
improved footnote mechanism and fixed the issue of  footnote counter inside minipage environment

Modified: trunk/xepersian.dtx
===================================================================
--- trunk/xepersian.dtx	2009-05-31 06:06:56 UTC (rev 42)
+++ trunk/xepersian.dtx	2009-05-31 15:29:39 UTC (rev 43)
@@ -156,7 +156,7 @@
 %    \begin{macrocode}
 \NeedsTeXFormat{LaTeX2e}
 \def\xepersianversion{v1.0.1}
-\def\xepersianrevision{revision 40}
+\def\xepersianrevision{revision 43}
 \def\xepersiandate{2009/06/01}
 \ProvidesPackage{xepersian}[\xepersiandate\space \xepersianversion\space <\xepersianrevision>
 	Persian typesetting in XeLaTeX]
@@ -458,14 +458,68 @@
 % \fi
 % \part{footnote-bidi-xepersian.def}
 %    \begin{macrocode}
-\DeclareRobustCommand{\LTRfootnote}[1]{%
-\bgroup
-\footnotemark%
-\renewcommand{\thefootnote}{\if at RomanFootNum\latinfont{\@arabic\c at footnote}\else\@arabic\c at footnote\fi}%
-\@RTLfalse\footnotetext{\latinfont#1}%
-\egroup
-}
+\def\thefootnote{\if at RomanFootNum\latinfont{\@arabic\c at footnote}\else\@arabic\c at footnote\fi}
 \let\PersianFootNum=\NativeFootNum
+\long\def\@RTLfootnotetext#1{\insert\footins{%
+    \@RTLtrue
+    \reset at font\footnotesize
+    \interlinepenalty\interfootnotelinepenalty
+    \splittopskip\footnotesep
+    \splitmaxdepth \dp\strutbox \floatingpenalty \@MM
+    \hsize\columnwidth \@parboxrestore
+    \protected at edef\@currentlabel{%
+       \csname p at footnote\endcsname\@thefnmark
+    }%
+    \color at begingroup
+    \bidi at footnotetext@dir{#1}%
+      \@makefntext{%
+        \rule\z@\footnotesep\ignorespaces\persianfont#1\@finalstrut\strutbox}%
+    \bidi at footnotetext@after
+    \color at endgroup}}%
+\long\def\@LTRfootnotetext#1{\insert\footins{%
+    \@RTLfalse
+    \reset at font\footnotesize
+    \interlinepenalty\interfootnotelinepenalty
+    \splittopskip\footnotesep
+    \splitmaxdepth \dp\strutbox \floatingpenalty \@MM
+    \hsize\columnwidth \@parboxrestore
+    \protected at edef\@currentlabel{%
+       \csname p at footnote\endcsname\@thefnmark
+    }%
+    \color at begingroup
+    \bidi at footnotetext@dir{#1}%
+      \@makefntext{%
+        \rule\z@\footnotesep\ignorespaces\latinfont#1\@finalstrut\strutbox}%
+    \bidi at footnotetext@after
+    \color at endgroup}}%
+\long\def\@mpRTLfootnotetext#1{
+  \global\setbox\@mpfootins\vbox{\@RTLtrue
+    \unvbox\@mpfootins
+    \reset at font\footnotesize
+    \hsize\columnwidth
+    \@parboxrestore
+    \protected at edef\@currentlabel
+         {\csname p at mpfootnote\endcsname\@thefnmark}
+    \color at begingroup
+     \bidi at footnotetext@dir{#1}
+    \if at RTL\global\let\bidi at footnoterule\right at footnote\else\global\let\bidi at footnoterule\left at footnote\fi
+      \@makefntext{
+        \rule\z@\footnotesep\ignorespaces\persianfont#1\@finalstrut\strutbox}
+    \color at endgroup}}
+\long\def\@mpLTRfootnotetext#1{
+  \global\setbox\@mpfootins\vbox{\@RTLfalse
+    \unvbox\@mpfootins
+    \reset at font\footnotesize
+    \hsize\columnwidth
+    \@parboxrestore
+    \protected at edef\@currentlabel
+         {\csname p at mpfootnote\endcsname\@thefnmark}
+    \color at begingroup
+     \bidi at footnotetext@dir{#1}
+    \if at RTL\global\let\bidi at footnoterule\right at footnote\else\global\let\bidi at footnoterule\left at footnote\fi
+      \@makefntext{
+        \rule\z@\footnotesep\ignorespaces\latinfont#1\@finalstrut\strutbox}
+    \color at endgroup}}
 %    \end{macrocode}
 % \iffalse
 %</footnote-bidi-xepersian.def>



